{
    "componentChunkName": "component---src-components-page-js",
    "path": "/page/2",
    "result": {"data":{"allMdx":{"nodes":[{"id":"60dd195e-7b1a-5fb2-86fc-c60f5713725f","slug":"posts/code/mini-program-network","rawBody":"---\ntitle: \"小程序异步网络请求问题的解决方案\"\ndate: 2020-12-08T15:38:11+08:00\ncategories: [\"code\"]\ntags: [\"javascript\",\"小程序\"]\ndraft: false\n---\n\n### 业务逻辑\n\n最近开发一个便签小程序的时候，有这样一个需求：用户可以在写便签的时候添加一个或多个图片。\n\n对于这个需求，我们用户按下保存键时，内部具体的实现上是这样的逻辑：\n\n1. 首先检测用户是否传入了图片，如果存储本地图片地址的数组长度>=1,则将图片数组放入上传图片的函数。\n\n2. 由于小程序网络请求大小限制，我们只能采取循环上传单文件，然后收集每次请求的结果--图片在服务器的地址，最后将结果放在一个数组中供后续的操作使用。\n\n3. 当图片上传函数全部执行完毕后，将数组中的图片数组取出来，赋值到日记对象中，再将整个日记对象提交到服务器。\n\n4. 服务器返回保存成功或失败。\n\n思路其实非常清晰简单，但是在代码实现上却翻了大跟头。\n\n### 异步带来的问题\n\n小程序的网络请求是异步的：我们无法通过return来将网络请求结果返回出来使用。\n\n```js\n\n    wx.request({\n\n          //...省略其他属性\n\n          success: function (res) {\n\n          },\n\n          fail: function (res) {\n\n          }\n\n    })\n\n ```\n\n例如在微信中发送网络请求，我们只能使用微信提供的方法wx.xxx，其中请求的结果保存在res中，而res无法直接return得到。\n\n**解决：**res虽然无法直接获取，但是我们能通过将需要使用到这个请求结果的业务逻辑代码放入这个网络请求的回调函数中直接读取网络请求结果，也就是一切都需要通过回调来解决。\n\n```js\n\n    wx.request({\n\n          //...省略其他属性\n\n          success: function (res) {\n\n            console.log(res);\n\n            //接业务逻辑代码\n\n          },\n\n          fail: function (res) {\n\n            console.log(res);\n\n          }\n\n    })\n ```\n\n例如这个微信的网络请求，我们可以通过success和fail的回调函数来读取res的值从而完成依赖res结果的业务逻辑。\n\n#### 回调地狱\n\n虽然解决了结果获取的问题，但是又产生了另一个问题，当多个请求中有明确的先后顺序时，回调会嵌套的很厉害，造成回调地狱，代码可读性和可维护性都会很差。\n例如对于一个日记页面，需要先请求到页面的数据（里面包含了图片数据和其他数据的地址），再根据页面数据去请求图片数据后再请求音频数据。例如以下代码：\n\n ```js\n\n    //请求页面整体数据\n\n    wx.request({\n\n          //...省略其他属性\n\n          success: function (res) {//成功\n\n                //请求图片数据\n\n                wx.request({\n\n                  success: function (res) {//成功\n\n                      //请求音频数据\n\n                      wx.request({\n\n                          success: function (res) {//成功\n\n                          },\n\n                          fail: function (res) {//失败\n\n                              console.log(\"请求失败:\"+res);\n\n                          }\n\n                      })\n\n                  },\n\n                  fail: function (res) {//失败\n\n                      console.log(\"请求失败:\"+res);\n\n                  }\n\n                })\n\n          },\n\n          fail: function (res) {//失败\n\n              console.log(\"请求失败:\"+res);\n\n          }\n\n    })\n```\n\n**如何优化？**幸运的是，在es6里面我们可以用promise去优化我们的回调，用then代替回调，首先将网络请求封装成一个Promise：\n\n```js\n\n    // 后台post请求\n\n    function postRequest(posturl, postdata) {\n\n      return new Promise((resolve, reject) => {\n\n        wx.request({\n\n          //省略其他属性\n\n          success: function (res) {\n\n            console.log(\"at post request: 请求成功\")\n\n            resolve(res.data)//设置promise成功标志\n\n          },\n\n          fail: function (res) {\n\n            console.log(\"at post request: 请求失败\")\n\n            reject(res.data)//设置promise失败标志\n\n          }\n\n        })\n\n      });\n\n    }\n\n```\n\n这样封装以后，我们的网络请求会在success和fail后回调resolve,这样可以告诉promise，“hey，我完成我的工作了，你可以进行你的then操作了”，这样就可以用then来简化嵌套逻辑。使用promise来完成上面那个问题的请求将会是这样的：\n\n```js\n\n    postRequest(posturl,postdata)\n\n    .then(function(res){\n\n      //业务逻辑\n\n      //调用下一个请求\n\n      return postRequest(next_posturl,next_postdata);\n\n    })\n\n    .then(function(res){\n\n      //业务逻辑\n\n      //调用下一个请求\n\n      return postRequest(next_next_posturl,next_next_postdata);\n\n    })\n\n    .then(function(res){\n\n      //业务逻辑\n\n    });\n\n```\n\n是不是简洁的多~\n\n### 一个看似简单的需求\n\n我们的有一个很简单的需求是需要对一组数量不定的图片做分别上传（因为微信限制所以无法做多上传），并且在上传完成以后需要获取到所有的返回结果。\n\n那么用我们前面的回调函数+then的话，很自然的想到这样的写法\n\n```js\n\npostRequest(posturl,postdata)\n\n.then(function(res){\n\n    //获取返回res\n\n    //上传下一个图片\n\n    return postRequest(next_posturl,next_postdata);\n\n})\n\n.then(function(res){\n\n    //获取返回res\n\n    //上传下一个图片\n\n    return postRequest(next_next_posturl,next_next_postdata);\n\n})\n\n.then(function(res){\n\n    //获取返回res\n\n});\n\n```\n\n这样看起来很简单明了，但是我的图片数量是不定的，怎么动态的构建.then.then.then这样的链式调用呢？经过我的研究后发现可以通过一个辅助的promise链去完成主链的链式构建。\n\n```js\n\n//多文件上传\n\nfunction jabingp_upLoad(uploadurl, files) {\n\n  return new Promise((resolve, reject) => {\n\n    //初始化promise链\n\n    var mergedAjax = Promise.resolve();\n\n    var response = [];\n\n    // 循环上传\n\n   \n    // 这里一定要使用let来为没一次循环构建一个块级作用域\n    // 使用var则需要配合立即执行函数\n    for (let i = 0; i < files.length; i++) {\n\n      mergedAjax = mergedAjax.then(() => {\n\n        return jabingp_upLoadSingle(uploadurl, files[i]).then((res) => {\n\n          response.push(res);\n\n        });\n\n      });\n\n    }\n\n    //当前面循环中所有的then执行完毕时会执行这个then\n\n    mergedAjax.then(() => {\n\n      resolve(response);            //设置这个函数的promise对象为完成状态并放入数据\n\n    });\n\n  });\n\n}\n\n```\n\n通过这个函数，就完成了多个请求依次执行并收集结果的效果。这个函数的重点在于利用另外一个已经处于完成状态的promise，不断的迭代自身，在每次迭代的then内部通过return来完成辅助链到业务链的切换。\n\n> 2019-04-27 更新\n\n### 使用await/async更加优雅地处理异步吧\n\n在es7标准中，引入了await和async这对兄弟，它们可以让我们的异步代码看起来和同步代码一样。让我们来看看await和async都能做什么吧。\n\nawait可以等待一个promise运行到完成状态并且获取结果，或者等待一个async修饰的函数运行完成并获取结果，但是使用await的时候，必须在async函数体内部。比如我有这样一个网络请求:\n\n```js\n function postRequest(posturl, postdata) {\n\n     return new Promise((resolve, reject) => {\n\n       wx.request({\n\n         //省略其他属性\n\n         success: function (res) {\n\n           console.log(\"at post request: 请求成功\")\n\n           resolve(res.data)//设置promise成功标志\n\n         },\n\n         fail: function (res) {\n\n           console.log(\"at post request: 请求失败\")\n\n           reject(res.data)//设置promise失败标志\n\n         }\n\n       })\n\n     });\n\n   }\n```\n\n那么如果不使用await，我就需要这样取得请求结果\n\n```js\nfunction test(){\n  postRequest(xxx,xxx).then(function(res){\n      // 这里面可以读取请求结果res了\n      console.log(res);\n  });\n}\ntest();\n```\n\n可以看到，这样的代码不太符合常规逻辑，我们希望函数作用是返回数据，这样更清晰明了，有了await，我们的愿望就可以实现了。\n\n```js\nasync function test(){\n let res = await  postRequest(xxx,xxx);\n // 下面就可以正常写对res的读取了\n console.log(res);\n}\ntest();\n```\n\n注意我给函数加上了async，有了async和await，我们就可以像同步代码一样使用异步请求了~\n那么上面那个通过复杂的构建链完成的需求，通过await实现将会变得非常简单易懂。\n\n```js\nasync function jabingp_upLoad(uploadurl, files) {\n    let response = [];\n  \n    // 循环依次等待上传结果\n    for (let i = 0; i < files.length; i++) {\n        let  res = await jabingp_upLoadSingle(uploadurl, files[i]);\n        // 结果放入数组\n        response.push(res);\n    }\n    // 返回结果\n    return  response ;\n}\n\n```\n\n代码一下子变得简洁易懂了，注意调用的时候也同样需要在一个async函数内部执行await。\n\n```js\nasync function test(){\n let response = await  jabingp_upLoad(xxx,xxx);\n console.log(response );\n}\ntest();\n```\n\n是不是非常简单呢，赶紧在你的异步请求中使用async和await吧！\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"小程序异步网络请求问题的解决方案\",\n  \"date\": \"2020-12-08T07:38:11.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"javascript\", \"小程序\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"\\u4E1A\\u52A1\\u903B\\u8F91\"), mdx(\"p\", null, \"\\u6700\\u8FD1\\u5F00\\u53D1\\u4E00\\u4E2A\\u4FBF\\u7B7E\\u5C0F\\u7A0B\\u5E8F\\u7684\\u65F6\\u5019\\uFF0C\\u6709\\u8FD9\\u6837\\u4E00\\u4E2A\\u9700\\u6C42\\uFF1A\\u7528\\u6237\\u53EF\\u4EE5\\u5728\\u5199\\u4FBF\\u7B7E\\u7684\\u65F6\\u5019\\u6DFB\\u52A0\\u4E00\\u4E2A\\u6216\\u591A\\u4E2A\\u56FE\\u7247\\u3002\"), mdx(\"p\", null, \"\\u5BF9\\u4E8E\\u8FD9\\u4E2A\\u9700\\u6C42\\uFF0C\\u6211\\u4EEC\\u7528\\u6237\\u6309\\u4E0B\\u4FDD\\u5B58\\u952E\\u65F6\\uFF0C\\u5185\\u90E8\\u5177\\u4F53\\u7684\\u5B9E\\u73B0\\u4E0A\\u662F\\u8FD9\\u6837\\u7684\\u903B\\u8F91\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u9996\\u5148\\u68C0\\u6D4B\\u7528\\u6237\\u662F\\u5426\\u4F20\\u5165\\u4E86\\u56FE\\u7247\\uFF0C\\u5982\\u679C\\u5B58\\u50A8\\u672C\\u5730\\u56FE\\u7247\\u5730\\u5740\\u7684\\u6570\\u7EC4\\u957F\\u5EA6>=1,\\u5219\\u5C06\\u56FE\\u7247\\u6570\\u7EC4\\u653E\\u5165\\u4E0A\\u4F20\\u56FE\\u7247\\u7684\\u51FD\\u6570\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u7531\\u4E8E\\u5C0F\\u7A0B\\u5E8F\\u7F51\\u7EDC\\u8BF7\\u6C42\\u5927\\u5C0F\\u9650\\u5236\\uFF0C\\u6211\\u4EEC\\u53EA\\u80FD\\u91C7\\u53D6\\u5FAA\\u73AF\\u4E0A\\u4F20\\u5355\\u6587\\u4EF6\\uFF0C\\u7136\\u540E\\u6536\\u96C6\\u6BCF\\u6B21\\u8BF7\\u6C42\\u7684\\u7ED3\\u679C--\\u56FE\\u7247\\u5728\\u670D\\u52A1\\u5668\\u7684\\u5730\\u5740\\uFF0C\\u6700\\u540E\\u5C06\\u7ED3\\u679C\\u653E\\u5728\\u4E00\\u4E2A\\u6570\\u7EC4\\u4E2D\\u4F9B\\u540E\\u7EED\\u7684\\u64CD\\u4F5C\\u4F7F\\u7528\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5F53\\u56FE\\u7247\\u4E0A\\u4F20\\u51FD\\u6570\\u5168\\u90E8\\u6267\\u884C\\u5B8C\\u6BD5\\u540E\\uFF0C\\u5C06\\u6570\\u7EC4\\u4E2D\\u7684\\u56FE\\u7247\\u6570\\u7EC4\\u53D6\\u51FA\\u6765\\uFF0C\\u8D4B\\u503C\\u5230\\u65E5\\u8BB0\\u5BF9\\u8C61\\u4E2D\\uFF0C\\u518D\\u5C06\\u6574\\u4E2A\\u65E5\\u8BB0\\u5BF9\\u8C61\\u63D0\\u4EA4\\u5230\\u670D\\u52A1\\u5668\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u670D\\u52A1\\u5668\\u8FD4\\u56DE\\u4FDD\\u5B58\\u6210\\u529F\\u6216\\u5931\\u8D25\\u3002\"))), mdx(\"p\", null, \"\\u601D\\u8DEF\\u5176\\u5B9E\\u975E\\u5E38\\u6E05\\u6670\\u7B80\\u5355\\uFF0C\\u4F46\\u662F\\u5728\\u4EE3\\u7801\\u5B9E\\u73B0\\u4E0A\\u5374\\u7FFB\\u4E86\\u5927\\u8DDF\\u5934\\u3002\"), mdx(\"h3\", null, \"\\u5F02\\u6B65\\u5E26\\u6765\\u7684\\u95EE\\u9898\"), mdx(\"p\", null, \"\\u5C0F\\u7A0B\\u5E8F\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\\u662F\\u5F02\\u6B65\\u7684\\uFF1A\\u6211\\u4EEC\\u65E0\\u6CD5\\u901A\\u8FC7return\\u6765\\u5C06\\u7F51\\u7EDC\\u8BF7\\u6C42\\u7ED3\\u679C\\u8FD4\\u56DE\\u51FA\\u6765\\u4F7F\\u7528\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n    wx.request({\\n\\n          //...\\u7701\\u7565\\u5176\\u4ED6\\u5C5E\\u6027\\n\\n          success: function (res) {\\n\\n          },\\n\\n          fail: function (res) {\\n\\n          }\\n\\n    })\\n\\n\")), mdx(\"p\", null, \"\\u4F8B\\u5982\\u5728\\u5FAE\\u4FE1\\u4E2D\\u53D1\\u9001\\u7F51\\u7EDC\\u8BF7\\u6C42\\uFF0C\\u6211\\u4EEC\\u53EA\\u80FD\\u4F7F\\u7528\\u5FAE\\u4FE1\\u63D0\\u4F9B\\u7684\\u65B9\\u6CD5wx.xxx\\uFF0C\\u5176\\u4E2D\\u8BF7\\u6C42\\u7684\\u7ED3\\u679C\\u4FDD\\u5B58\\u5728res\\u4E2D\\uFF0C\\u800Cres\\u65E0\\u6CD5\\u76F4\\u63A5return\\u5F97\\u5230\\u3002\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u89E3\\u51B3\\uFF1A\"), \"res\\u867D\\u7136\\u65E0\\u6CD5\\u76F4\\u63A5\\u83B7\\u53D6\\uFF0C\\u4F46\\u662F\\u6211\\u4EEC\\u80FD\\u901A\\u8FC7\\u5C06\\u9700\\u8981\\u4F7F\\u7528\\u5230\\u8FD9\\u4E2A\\u8BF7\\u6C42\\u7ED3\\u679C\\u7684\\u4E1A\\u52A1\\u903B\\u8F91\\u4EE3\\u7801\\u653E\\u5165\\u8FD9\\u4E2A\\u7F51\\u7EDC\\u8BF7\\u6C42\\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u4E2D\\u76F4\\u63A5\\u8BFB\\u53D6\\u7F51\\u7EDC\\u8BF7\\u6C42\\u7ED3\\u679C\\uFF0C\\u4E5F\\u5C31\\u662F\\u4E00\\u5207\\u90FD\\u9700\\u8981\\u901A\\u8FC7\\u56DE\\u8C03\\u6765\\u89E3\\u51B3\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n    wx.request({\\n\\n          //...\\u7701\\u7565\\u5176\\u4ED6\\u5C5E\\u6027\\n\\n          success: function (res) {\\n\\n            console.log(res);\\n\\n            //\\u63A5\\u4E1A\\u52A1\\u903B\\u8F91\\u4EE3\\u7801\\n\\n          },\\n\\n          fail: function (res) {\\n\\n            console.log(res);\\n\\n          }\\n\\n    })\\n\")), mdx(\"p\", null, \"\\u4F8B\\u5982\\u8FD9\\u4E2A\\u5FAE\\u4FE1\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u901A\\u8FC7success\\u548Cfail\\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u6765\\u8BFB\\u53D6res\\u7684\\u503C\\u4ECE\\u800C\\u5B8C\\u6210\\u4F9D\\u8D56res\\u7ED3\\u679C\\u7684\\u4E1A\\u52A1\\u903B\\u8F91\\u3002\"), mdx(\"h4\", null, \"\\u56DE\\u8C03\\u5730\\u72F1\"), mdx(\"p\", null, \"\\u867D\\u7136\\u89E3\\u51B3\\u4E86\\u7ED3\\u679C\\u83B7\\u53D6\\u7684\\u95EE\\u9898\\uFF0C\\u4F46\\u662F\\u53C8\\u4EA7\\u751F\\u4E86\\u53E6\\u4E00\\u4E2A\\u95EE\\u9898\\uFF0C\\u5F53\\u591A\\u4E2A\\u8BF7\\u6C42\\u4E2D\\u6709\\u660E\\u786E\\u7684\\u5148\\u540E\\u987A\\u5E8F\\u65F6\\uFF0C\\u56DE\\u8C03\\u4F1A\\u5D4C\\u5957\\u7684\\u5F88\\u5389\\u5BB3\\uFF0C\\u9020\\u6210\\u56DE\\u8C03\\u5730\\u72F1\\uFF0C\\u4EE3\\u7801\\u53EF\\u8BFB\\u6027\\u548C\\u53EF\\u7EF4\\u62A4\\u6027\\u90FD\\u4F1A\\u5F88\\u5DEE\\u3002\\n\\u4F8B\\u5982\\u5BF9\\u4E8E\\u4E00\\u4E2A\\u65E5\\u8BB0\\u9875\\u9762\\uFF0C\\u9700\\u8981\\u5148\\u8BF7\\u6C42\\u5230\\u9875\\u9762\\u7684\\u6570\\u636E\\uFF08\\u91CC\\u9762\\u5305\\u542B\\u4E86\\u56FE\\u7247\\u6570\\u636E\\u548C\\u5176\\u4ED6\\u6570\\u636E\\u7684\\u5730\\u5740\\uFF09\\uFF0C\\u518D\\u6839\\u636E\\u9875\\u9762\\u6570\\u636E\\u53BB\\u8BF7\\u6C42\\u56FE\\u7247\\u6570\\u636E\\u540E\\u518D\\u8BF7\\u6C42\\u97F3\\u9891\\u6570\\u636E\\u3002\\u4F8B\\u5982\\u4EE5\\u4E0B\\u4EE3\\u7801\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n   //\\u8BF7\\u6C42\\u9875\\u9762\\u6574\\u4F53\\u6570\\u636E\\n\\n   wx.request({\\n\\n         //...\\u7701\\u7565\\u5176\\u4ED6\\u5C5E\\u6027\\n\\n         success: function (res) {//\\u6210\\u529F\\n\\n               //\\u8BF7\\u6C42\\u56FE\\u7247\\u6570\\u636E\\n\\n               wx.request({\\n\\n                 success: function (res) {//\\u6210\\u529F\\n\\n                     //\\u8BF7\\u6C42\\u97F3\\u9891\\u6570\\u636E\\n\\n                     wx.request({\\n\\n                         success: function (res) {//\\u6210\\u529F\\n\\n                         },\\n\\n                         fail: function (res) {//\\u5931\\u8D25\\n\\n                             console.log(\\\"\\u8BF7\\u6C42\\u5931\\u8D25:\\\"+res);\\n\\n                         }\\n\\n                     })\\n\\n                 },\\n\\n                 fail: function (res) {//\\u5931\\u8D25\\n\\n                     console.log(\\\"\\u8BF7\\u6C42\\u5931\\u8D25:\\\"+res);\\n\\n                 }\\n\\n               })\\n\\n         },\\n\\n         fail: function (res) {//\\u5931\\u8D25\\n\\n             console.log(\\\"\\u8BF7\\u6C42\\u5931\\u8D25:\\\"+res);\\n\\n         }\\n\\n   })\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5982\\u4F55\\u4F18\\u5316\\uFF1F\"), \"\\u5E78\\u8FD0\\u7684\\u662F\\uFF0C\\u5728es6\\u91CC\\u9762\\u6211\\u4EEC\\u53EF\\u4EE5\\u7528promise\\u53BB\\u4F18\\u5316\\u6211\\u4EEC\\u7684\\u56DE\\u8C03\\uFF0C\\u7528then\\u4EE3\\u66FF\\u56DE\\u8C03\\uFF0C\\u9996\\u5148\\u5C06\\u7F51\\u7EDC\\u8BF7\\u6C42\\u5C01\\u88C5\\u6210\\u4E00\\u4E2APromise\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n    // \\u540E\\u53F0post\\u8BF7\\u6C42\\n\\n    function postRequest(posturl, postdata) {\\n\\n      return new Promise((resolve, reject) => {\\n\\n        wx.request({\\n\\n          //\\u7701\\u7565\\u5176\\u4ED6\\u5C5E\\u6027\\n\\n          success: function (res) {\\n\\n            console.log(\\\"at post request: \\u8BF7\\u6C42\\u6210\\u529F\\\")\\n\\n            resolve(res.data)//\\u8BBE\\u7F6Epromise\\u6210\\u529F\\u6807\\u5FD7\\n\\n          },\\n\\n          fail: function (res) {\\n\\n            console.log(\\\"at post request: \\u8BF7\\u6C42\\u5931\\u8D25\\\")\\n\\n            reject(res.data)//\\u8BBE\\u7F6Epromise\\u5931\\u8D25\\u6807\\u5FD7\\n\\n          }\\n\\n        })\\n\\n      });\\n\\n    }\\n\\n\")), mdx(\"p\", null, \"\\u8FD9\\u6837\\u5C01\\u88C5\\u4EE5\\u540E\\uFF0C\\u6211\\u4EEC\\u7684\\u7F51\\u7EDC\\u8BF7\\u6C42\\u4F1A\\u5728success\\u548Cfail\\u540E\\u56DE\\u8C03resolve,\\u8FD9\\u6837\\u53EF\\u4EE5\\u544A\\u8BC9promise\\uFF0C\\u201Chey\\uFF0C\\u6211\\u5B8C\\u6210\\u6211\\u7684\\u5DE5\\u4F5C\\u4E86\\uFF0C\\u4F60\\u53EF\\u4EE5\\u8FDB\\u884C\\u4F60\\u7684then\\u64CD\\u4F5C\\u4E86\\u201D\\uFF0C\\u8FD9\\u6837\\u5C31\\u53EF\\u4EE5\\u7528then\\u6765\\u7B80\\u5316\\u5D4C\\u5957\\u903B\\u8F91\\u3002\\u4F7F\\u7528promise\\u6765\\u5B8C\\u6210\\u4E0A\\u9762\\u90A3\\u4E2A\\u95EE\\u9898\\u7684\\u8BF7\\u6C42\\u5C06\\u4F1A\\u662F\\u8FD9\\u6837\\u7684\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n    postRequest(posturl,postdata)\\n\\n    .then(function(res){\\n\\n      //\\u4E1A\\u52A1\\u903B\\u8F91\\n\\n      //\\u8C03\\u7528\\u4E0B\\u4E00\\u4E2A\\u8BF7\\u6C42\\n\\n      return postRequest(next_posturl,next_postdata);\\n\\n    })\\n\\n    .then(function(res){\\n\\n      //\\u4E1A\\u52A1\\u903B\\u8F91\\n\\n      //\\u8C03\\u7528\\u4E0B\\u4E00\\u4E2A\\u8BF7\\u6C42\\n\\n      return postRequest(next_next_posturl,next_next_postdata);\\n\\n    })\\n\\n    .then(function(res){\\n\\n      //\\u4E1A\\u52A1\\u903B\\u8F91\\n\\n    });\\n\\n\")), mdx(\"p\", null, \"\\u662F\\u4E0D\\u662F\\u7B80\\u6D01\\u7684\\u591A~\"), mdx(\"h3\", null, \"\\u4E00\\u4E2A\\u770B\\u4F3C\\u7B80\\u5355\\u7684\\u9700\\u6C42\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u7684\\u6709\\u4E00\\u4E2A\\u5F88\\u7B80\\u5355\\u7684\\u9700\\u6C42\\u662F\\u9700\\u8981\\u5BF9\\u4E00\\u7EC4\\u6570\\u91CF\\u4E0D\\u5B9A\\u7684\\u56FE\\u7247\\u505A\\u5206\\u522B\\u4E0A\\u4F20\\uFF08\\u56E0\\u4E3A\\u5FAE\\u4FE1\\u9650\\u5236\\u6240\\u4EE5\\u65E0\\u6CD5\\u505A\\u591A\\u4E0A\\u4F20\\uFF09\\uFF0C\\u5E76\\u4E14\\u5728\\u4E0A\\u4F20\\u5B8C\\u6210\\u4EE5\\u540E\\u9700\\u8981\\u83B7\\u53D6\\u5230\\u6240\\u6709\\u7684\\u8FD4\\u56DE\\u7ED3\\u679C\\u3002\"), mdx(\"p\", null, \"\\u90A3\\u4E48\\u7528\\u6211\\u4EEC\\u524D\\u9762\\u7684\\u56DE\\u8C03\\u51FD\\u6570+then\\u7684\\u8BDD\\uFF0C\\u5F88\\u81EA\\u7136\\u7684\\u60F3\\u5230\\u8FD9\\u6837\\u7684\\u5199\\u6CD5\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\npostRequest(posturl,postdata)\\n\\n.then(function(res){\\n\\n    //\\u83B7\\u53D6\\u8FD4\\u56DEres\\n\\n    //\\u4E0A\\u4F20\\u4E0B\\u4E00\\u4E2A\\u56FE\\u7247\\n\\n    return postRequest(next_posturl,next_postdata);\\n\\n})\\n\\n.then(function(res){\\n\\n    //\\u83B7\\u53D6\\u8FD4\\u56DEres\\n\\n    //\\u4E0A\\u4F20\\u4E0B\\u4E00\\u4E2A\\u56FE\\u7247\\n\\n    return postRequest(next_next_posturl,next_next_postdata);\\n\\n})\\n\\n.then(function(res){\\n\\n    //\\u83B7\\u53D6\\u8FD4\\u56DEres\\n\\n});\\n\\n\")), mdx(\"p\", null, \"\\u8FD9\\u6837\\u770B\\u8D77\\u6765\\u5F88\\u7B80\\u5355\\u660E\\u4E86\\uFF0C\\u4F46\\u662F\\u6211\\u7684\\u56FE\\u7247\\u6570\\u91CF\\u662F\\u4E0D\\u5B9A\\u7684\\uFF0C\\u600E\\u4E48\\u52A8\\u6001\\u7684\\u6784\\u5EFA.then.then.then\\u8FD9\\u6837\\u7684\\u94FE\\u5F0F\\u8C03\\u7528\\u5462\\uFF1F\\u7ECF\\u8FC7\\u6211\\u7684\\u7814\\u7A76\\u540E\\u53D1\\u73B0\\u53EF\\u4EE5\\u901A\\u8FC7\\u4E00\\u4E2A\\u8F85\\u52A9\\u7684promise\\u94FE\\u53BB\\u5B8C\\u6210\\u4E3B\\u94FE\\u7684\\u94FE\\u5F0F\\u6784\\u5EFA\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"\\n//\\u591A\\u6587\\u4EF6\\u4E0A\\u4F20\\n\\nfunction jabingp_upLoad(uploadurl, files) {\\n\\n  return new Promise((resolve, reject) => {\\n\\n    //\\u521D\\u59CB\\u5316promise\\u94FE\\n\\n    var mergedAjax = Promise.resolve();\\n\\n    var response = [];\\n\\n    // \\u5FAA\\u73AF\\u4E0A\\u4F20\\n\\n   \\n    // \\u8FD9\\u91CC\\u4E00\\u5B9A\\u8981\\u4F7F\\u7528let\\u6765\\u4E3A\\u6CA1\\u4E00\\u6B21\\u5FAA\\u73AF\\u6784\\u5EFA\\u4E00\\u4E2A\\u5757\\u7EA7\\u4F5C\\u7528\\u57DF\\n    // \\u4F7F\\u7528var\\u5219\\u9700\\u8981\\u914D\\u5408\\u7ACB\\u5373\\u6267\\u884C\\u51FD\\u6570\\n    for (let i = 0; i < files.length; i++) {\\n\\n      mergedAjax = mergedAjax.then(() => {\\n\\n        return jabingp_upLoadSingle(uploadurl, files[i]).then((res) => {\\n\\n          response.push(res);\\n\\n        });\\n\\n      });\\n\\n    }\\n\\n    //\\u5F53\\u524D\\u9762\\u5FAA\\u73AF\\u4E2D\\u6240\\u6709\\u7684then\\u6267\\u884C\\u5B8C\\u6BD5\\u65F6\\u4F1A\\u6267\\u884C\\u8FD9\\u4E2Athen\\n\\n    mergedAjax.then(() => {\\n\\n      resolve(response);            //\\u8BBE\\u7F6E\\u8FD9\\u4E2A\\u51FD\\u6570\\u7684promise\\u5BF9\\u8C61\\u4E3A\\u5B8C\\u6210\\u72B6\\u6001\\u5E76\\u653E\\u5165\\u6570\\u636E\\n\\n    });\\n\\n  });\\n\\n}\\n\\n\")), mdx(\"p\", null, \"\\u901A\\u8FC7\\u8FD9\\u4E2A\\u51FD\\u6570\\uFF0C\\u5C31\\u5B8C\\u6210\\u4E86\\u591A\\u4E2A\\u8BF7\\u6C42\\u4F9D\\u6B21\\u6267\\u884C\\u5E76\\u6536\\u96C6\\u7ED3\\u679C\\u7684\\u6548\\u679C\\u3002\\u8FD9\\u4E2A\\u51FD\\u6570\\u7684\\u91CD\\u70B9\\u5728\\u4E8E\\u5229\\u7528\\u53E6\\u5916\\u4E00\\u4E2A\\u5DF2\\u7ECF\\u5904\\u4E8E\\u5B8C\\u6210\\u72B6\\u6001\\u7684promise\\uFF0C\\u4E0D\\u65AD\\u7684\\u8FED\\u4EE3\\u81EA\\u8EAB\\uFF0C\\u5728\\u6BCF\\u6B21\\u8FED\\u4EE3\\u7684then\\u5185\\u90E8\\u901A\\u8FC7return\\u6765\\u5B8C\\u6210\\u8F85\\u52A9\\u94FE\\u5230\\u4E1A\\u52A1\\u94FE\\u7684\\u5207\\u6362\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"2019-04-27 \\u66F4\\u65B0\")), mdx(\"h3\", null, \"\\u4F7F\\u7528await/async\\u66F4\\u52A0\\u4F18\\u96C5\\u5730\\u5904\\u7406\\u5F02\\u6B65\\u5427\"), mdx(\"p\", null, \"\\u5728es7\\u6807\\u51C6\\u4E2D\\uFF0C\\u5F15\\u5165\\u4E86await\\u548Casync\\u8FD9\\u5BF9\\u5144\\u5F1F\\uFF0C\\u5B83\\u4EEC\\u53EF\\u4EE5\\u8BA9\\u6211\\u4EEC\\u7684\\u5F02\\u6B65\\u4EE3\\u7801\\u770B\\u8D77\\u6765\\u548C\\u540C\\u6B65\\u4EE3\\u7801\\u4E00\\u6837\\u3002\\u8BA9\\u6211\\u4EEC\\u6765\\u770B\\u770Bawait\\u548Casync\\u90FD\\u80FD\\u505A\\u4EC0\\u4E48\\u5427\\u3002\"), mdx(\"p\", null, \"await\\u53EF\\u4EE5\\u7B49\\u5F85\\u4E00\\u4E2Apromise\\u8FD0\\u884C\\u5230\\u5B8C\\u6210\\u72B6\\u6001\\u5E76\\u4E14\\u83B7\\u53D6\\u7ED3\\u679C\\uFF0C\\u6216\\u8005\\u7B49\\u5F85\\u4E00\\u4E2Aasync\\u4FEE\\u9970\\u7684\\u51FD\\u6570\\u8FD0\\u884C\\u5B8C\\u6210\\u5E76\\u83B7\\u53D6\\u7ED3\\u679C\\uFF0C\\u4F46\\u662F\\u4F7F\\u7528await\\u7684\\u65F6\\u5019\\uFF0C\\u5FC5\\u987B\\u5728async\\u51FD\\u6570\\u4F53\\u5185\\u90E8\\u3002\\u6BD4\\u5982\\u6211\\u6709\\u8FD9\\u6837\\u4E00\\u4E2A\\u7F51\\u7EDC\\u8BF7\\u6C42:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \" function postRequest(posturl, postdata) {\\n\\n     return new Promise((resolve, reject) => {\\n\\n       wx.request({\\n\\n         //\\u7701\\u7565\\u5176\\u4ED6\\u5C5E\\u6027\\n\\n         success: function (res) {\\n\\n           console.log(\\\"at post request: \\u8BF7\\u6C42\\u6210\\u529F\\\")\\n\\n           resolve(res.data)//\\u8BBE\\u7F6Epromise\\u6210\\u529F\\u6807\\u5FD7\\n\\n         },\\n\\n         fail: function (res) {\\n\\n           console.log(\\\"at post request: \\u8BF7\\u6C42\\u5931\\u8D25\\\")\\n\\n           reject(res.data)//\\u8BBE\\u7F6Epromise\\u5931\\u8D25\\u6807\\u5FD7\\n\\n         }\\n\\n       })\\n\\n     });\\n\\n   }\\n\")), mdx(\"p\", null, \"\\u90A3\\u4E48\\u5982\\u679C\\u4E0D\\u4F7F\\u7528await\\uFF0C\\u6211\\u5C31\\u9700\\u8981\\u8FD9\\u6837\\u53D6\\u5F97\\u8BF7\\u6C42\\u7ED3\\u679C\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"function test(){\\n  postRequest(xxx,xxx).then(function(res){\\n      // \\u8FD9\\u91CC\\u9762\\u53EF\\u4EE5\\u8BFB\\u53D6\\u8BF7\\u6C42\\u7ED3\\u679Cres\\u4E86\\n      console.log(res);\\n  });\\n}\\ntest();\\n\")), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\uFF0C\\u8FD9\\u6837\\u7684\\u4EE3\\u7801\\u4E0D\\u592A\\u7B26\\u5408\\u5E38\\u89C4\\u903B\\u8F91\\uFF0C\\u6211\\u4EEC\\u5E0C\\u671B\\u51FD\\u6570\\u4F5C\\u7528\\u662F\\u8FD4\\u56DE\\u6570\\u636E\\uFF0C\\u8FD9\\u6837\\u66F4\\u6E05\\u6670\\u660E\\u4E86\\uFF0C\\u6709\\u4E86await\\uFF0C\\u6211\\u4EEC\\u7684\\u613F\\u671B\\u5C31\\u53EF\\u4EE5\\u5B9E\\u73B0\\u4E86\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"async function test(){\\n let res = await  postRequest(xxx,xxx);\\n // \\u4E0B\\u9762\\u5C31\\u53EF\\u4EE5\\u6B63\\u5E38\\u5199\\u5BF9res\\u7684\\u8BFB\\u53D6\\u4E86\\n console.log(res);\\n}\\ntest();\\n\")), mdx(\"p\", null, \"\\u6CE8\\u610F\\u6211\\u7ED9\\u51FD\\u6570\\u52A0\\u4E0A\\u4E86async\\uFF0C\\u6709\\u4E86async\\u548Cawait\\uFF0C\\u6211\\u4EEC\\u5C31\\u53EF\\u4EE5\\u50CF\\u540C\\u6B65\\u4EE3\\u7801\\u4E00\\u6837\\u4F7F\\u7528\\u5F02\\u6B65\\u8BF7\\u6C42\\u4E86~\\n\\u90A3\\u4E48\\u4E0A\\u9762\\u90A3\\u4E2A\\u901A\\u8FC7\\u590D\\u6742\\u7684\\u6784\\u5EFA\\u94FE\\u5B8C\\u6210\\u7684\\u9700\\u6C42\\uFF0C\\u901A\\u8FC7await\\u5B9E\\u73B0\\u5C06\\u4F1A\\u53D8\\u5F97\\u975E\\u5E38\\u7B80\\u5355\\u6613\\u61C2\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"async function jabingp_upLoad(uploadurl, files) {\\n    let response = [];\\n  \\n    // \\u5FAA\\u73AF\\u4F9D\\u6B21\\u7B49\\u5F85\\u4E0A\\u4F20\\u7ED3\\u679C\\n    for (let i = 0; i < files.length; i++) {\\n        let  res = await jabingp_upLoadSingle(uploadurl, files[i]);\\n        // \\u7ED3\\u679C\\u653E\\u5165\\u6570\\u7EC4\\n        response.push(res);\\n    }\\n    // \\u8FD4\\u56DE\\u7ED3\\u679C\\n    return  response ;\\n}\\n\\n\")), mdx(\"p\", null, \"\\u4EE3\\u7801\\u4E00\\u4E0B\\u5B50\\u53D8\\u5F97\\u7B80\\u6D01\\u6613\\u61C2\\u4E86\\uFF0C\\u6CE8\\u610F\\u8C03\\u7528\\u7684\\u65F6\\u5019\\u4E5F\\u540C\\u6837\\u9700\\u8981\\u5728\\u4E00\\u4E2Aasync\\u51FD\\u6570\\u5185\\u90E8\\u6267\\u884Cawait\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"async function test(){\\n let response = await  jabingp_upLoad(xxx,xxx);\\n console.log(response );\\n}\\ntest();\\n\")), mdx(\"p\", null, \"\\u662F\\u4E0D\\u662F\\u975E\\u5E38\\u7B80\\u5355\\u5462\\uFF0C\\u8D76\\u7D27\\u5728\\u4F60\\u7684\\u5F02\\u6B65\\u8BF7\\u6C42\\u4E2D\\u4F7F\\u7528async\\u548Cawait\\u5427\\uFF01\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"业务逻辑 最近开发一个便签小程序的时候，有这样一个需求：用户可以在写便签的时候添加一个或多个图片。 对于这个需求，我们用户按下保存键时，内部具体的实现上是这样的逻辑： 首先检测用户是否传入了图片，如果存储本地图片地址的数组长度>=…","frontmatter":{"date":"2020-12-08 07:38","title":"小程序异步网络请求问题的解决方案","draft":false}},{"id":"b2849cbf-27a5-5685-9ec9-caa499db3f9c","slug":"posts/code/my-confusion","rawBody":"---\ntitle: \"那些让我困惑的事情\"\ndate: 2020-12-29T13:42:13+08:00\ncategories: [\"code\"]\ntags: [\"confusion\"]\ndraft: false\n---\n\n## 1.《Linux设计与实现》中的task_struct\n\n- [ ] 是否解决\n\n\n在阅读 *《Linux设计与实现》* 3.2.2 时，留意到这样一段话：\n\n> 内核通过一个唯一的进程标识值（process identification value）或 *PID* 来标识每个进程。 *PID* 是一个数，标识 *pid_t* *隐含类型*（ *隐含类型* 指数据类型的表示是未知的或不相关的），实际上就是一个 *int* 类型。为了与老版本的 *Unix* 和 *Linux* 兼容， *PID* 的最大值默认设置为 **32768（short int短整型的最大值）** ，尽管这个值也可以增加到高达400万（这受<linux/threads.h>中所定义PID最大值的限制）。内核把每个进程的 *PID* 存放在它们各自的 *进程描述符* 中。\n\n\n> 这个最大值很重要，因为它实际上就是系统中允许同时存在的进程的最大数目。尽管 **32768** 对于一般的桌面系统足够用了，但是大型服务器可能需要更多进程。这个值越小，转一圈就越快，本来数值大的进程比数值小的进程迟运行，但这样一来就破坏了这一原则。\n\n疑惑的点在于这句：\n\n> 这个值越小，转一圈就越快，本来数值大的进程比数值小的进程迟运行，但这样一来就破坏了这一原则。\n\n我可以理解 *“数值大的进程比数值小的进程迟运行”* ，但无法理解为什么 *pid* 设置的越小就会破坏这一原则。\n\n起初我觉得可能是中文翻译问题，于是我找到了英文原版，里面同一段话的英文原文是：\n\n> the lower\nthe value, the sooner the values will wrap around, destroying the useful notion that higher values indicate later-run processes than lower values.\n\n中文版虽然拗口了一点点，但是意思是没什么问题的，证明不是翻译导致的语义不明确。\n\n## 2. Openwrt 或者 Lede 无法在通过内网的域名访问\n\n1. 直接通过 ip 访问可以成功访问到luci\n2. 修改电脑的 hosts文件\n\n```bash\n192.168.123.73 openwrt.lan\n```\n\n3. 访问 openwrt.lan 出现\n\n```bash\n500 Internal Privoxy Error\nPrivoxy encountered an error while processing your request:\n\nCould not load template file no-server-data or one of its included components.\n\nPlease contact your proxy administrator.\n\nIf you are the proxy administrator, please put the required file(s)in the (confdir)/templates directory. The location of the (confdir) directory is specified in the main Privoxy config file. (It's typically the Privoxy install directory, or /etc/privoxy/).\n```\n\n## 提示根据法律规定，koolshare软件中心不会安装此插件\n\nsed -i 's/\\tdetect_package/\\t# detect_package/g' /koolshare/scripts/ks_tar_install.sh","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"那些让我困惑的事情\",\n  \"date\": \"2020-12-29T05:42:13.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"confusion\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"1.\\u300ALinux\\u8BBE\\u8BA1\\u4E0E\\u5B9E\\u73B0\\u300B\\u4E2D\\u7684task_struct\"), mdx(\"ul\", {\n    \"className\": \"contains-task-list\"\n  }, mdx(\"li\", {\n    parentName: \"ul\",\n    \"className\": \"task-list-item\"\n  }, mdx(\"input\", {\n    parentName: \"li\",\n    \"type\": \"checkbox\",\n    \"checked\": false,\n    \"disabled\": true\n  }), \" \", \"\\u662F\\u5426\\u89E3\\u51B3\")), mdx(\"p\", null, \"\\u5728\\u9605\\u8BFB \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u300ALinux\\u8BBE\\u8BA1\\u4E0E\\u5B9E\\u73B0\\u300B\"), \" 3.2.2 \\u65F6\\uFF0C\\u7559\\u610F\\u5230\\u8FD9\\u6837\\u4E00\\u6BB5\\u8BDD\\uFF1A\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u5185\\u6838\\u901A\\u8FC7\\u4E00\\u4E2A\\u552F\\u4E00\\u7684\\u8FDB\\u7A0B\\u6807\\u8BC6\\u503C\\uFF08process identification value\\uFF09\\u6216 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"PID\"), \" \\u6765\\u6807\\u8BC6\\u6BCF\\u4E2A\\u8FDB\\u7A0B\\u3002 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"PID\"), \" \\u662F\\u4E00\\u4E2A\\u6570\\uFF0C\\u6807\\u8BC6 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"pid_t\"), \" \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u9690\\u542B\\u7C7B\\u578B\"), \"\\uFF08 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u9690\\u542B\\u7C7B\\u578B\"), \" \\u6307\\u6570\\u636E\\u7C7B\\u578B\\u7684\\u8868\\u793A\\u662F\\u672A\\u77E5\\u7684\\u6216\\u4E0D\\u76F8\\u5173\\u7684\\uFF09\\uFF0C\\u5B9E\\u9645\\u4E0A\\u5C31\\u662F\\u4E00\\u4E2A \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"int\"), \" \\u7C7B\\u578B\\u3002\\u4E3A\\u4E86\\u4E0E\\u8001\\u7248\\u672C\\u7684 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Unix\"), \" \\u548C \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Linux\"), \" \\u517C\\u5BB9\\uFF0C \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"PID\"), \" \\u7684\\u6700\\u5927\\u503C\\u9ED8\\u8BA4\\u8BBE\\u7F6E\\u4E3A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"32768\\uFF08short int\\u77ED\\u6574\\u578B\\u7684\\u6700\\u5927\\u503C\\uFF09\"), \" \\uFF0C\\u5C3D\\u7BA1\\u8FD9\\u4E2A\\u503C\\u4E5F\\u53EF\\u4EE5\\u589E\\u52A0\\u5230\\u9AD8\\u8FBE400\\u4E07\\uFF08\\u8FD9\\u53D7<linux/threads.h>\\u4E2D\\u6240\\u5B9A\\u4E49PID\\u6700\\u5927\\u503C\\u7684\\u9650\\u5236\\uFF09\\u3002\\u5185\\u6838\\u628A\\u6BCF\\u4E2A\\u8FDB\\u7A0B\\u7684 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"PID\"), \" \\u5B58\\u653E\\u5728\\u5B83\\u4EEC\\u5404\\u81EA\\u7684 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u8FDB\\u7A0B\\u63CF\\u8FF0\\u7B26\"), \" \\u4E2D\\u3002\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8FD9\\u4E2A\\u6700\\u5927\\u503C\\u5F88\\u91CD\\u8981\\uFF0C\\u56E0\\u4E3A\\u5B83\\u5B9E\\u9645\\u4E0A\\u5C31\\u662F\\u7CFB\\u7EDF\\u4E2D\\u5141\\u8BB8\\u540C\\u65F6\\u5B58\\u5728\\u7684\\u8FDB\\u7A0B\\u7684\\u6700\\u5927\\u6570\\u76EE\\u3002\\u5C3D\\u7BA1 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"32768\"), \" \\u5BF9\\u4E8E\\u4E00\\u822C\\u7684\\u684C\\u9762\\u7CFB\\u7EDF\\u8DB3\\u591F\\u7528\\u4E86\\uFF0C\\u4F46\\u662F\\u5927\\u578B\\u670D\\u52A1\\u5668\\u53EF\\u80FD\\u9700\\u8981\\u66F4\\u591A\\u8FDB\\u7A0B\\u3002\\u8FD9\\u4E2A\\u503C\\u8D8A\\u5C0F\\uFF0C\\u8F6C\\u4E00\\u5708\\u5C31\\u8D8A\\u5FEB\\uFF0C\\u672C\\u6765\\u6570\\u503C\\u5927\\u7684\\u8FDB\\u7A0B\\u6BD4\\u6570\\u503C\\u5C0F\\u7684\\u8FDB\\u7A0B\\u8FDF\\u8FD0\\u884C\\uFF0C\\u4F46\\u8FD9\\u6837\\u4E00\\u6765\\u5C31\\u7834\\u574F\\u4E86\\u8FD9\\u4E00\\u539F\\u5219\\u3002\")), mdx(\"p\", null, \"\\u7591\\u60D1\\u7684\\u70B9\\u5728\\u4E8E\\u8FD9\\u53E5\\uFF1A\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8FD9\\u4E2A\\u503C\\u8D8A\\u5C0F\\uFF0C\\u8F6C\\u4E00\\u5708\\u5C31\\u8D8A\\u5FEB\\uFF0C\\u672C\\u6765\\u6570\\u503C\\u5927\\u7684\\u8FDB\\u7A0B\\u6BD4\\u6570\\u503C\\u5C0F\\u7684\\u8FDB\\u7A0B\\u8FDF\\u8FD0\\u884C\\uFF0C\\u4F46\\u8FD9\\u6837\\u4E00\\u6765\\u5C31\\u7834\\u574F\\u4E86\\u8FD9\\u4E00\\u539F\\u5219\\u3002\")), mdx(\"p\", null, \"\\u6211\\u53EF\\u4EE5\\u7406\\u89E3 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201C\\u6570\\u503C\\u5927\\u7684\\u8FDB\\u7A0B\\u6BD4\\u6570\\u503C\\u5C0F\\u7684\\u8FDB\\u7A0B\\u8FDF\\u8FD0\\u884C\\u201D\"), \" \\uFF0C\\u4F46\\u65E0\\u6CD5\\u7406\\u89E3\\u4E3A\\u4EC0\\u4E48 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"pid\"), \" \\u8BBE\\u7F6E\\u7684\\u8D8A\\u5C0F\\u5C31\\u4F1A\\u7834\\u574F\\u8FD9\\u4E00\\u539F\\u5219\\u3002\"), mdx(\"p\", null, \"\\u8D77\\u521D\\u6211\\u89C9\\u5F97\\u53EF\\u80FD\\u662F\\u4E2D\\u6587\\u7FFB\\u8BD1\\u95EE\\u9898\\uFF0C\\u4E8E\\u662F\\u6211\\u627E\\u5230\\u4E86\\u82F1\\u6587\\u539F\\u7248\\uFF0C\\u91CC\\u9762\\u540C\\u4E00\\u6BB5\\u8BDD\\u7684\\u82F1\\u6587\\u539F\\u6587\\u662F\\uFF1A\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"the lower\\nthe value, the sooner the values will wrap around, destroying the useful notion that higher values indicate later-run processes than lower values.\")), mdx(\"p\", null, \"\\u4E2D\\u6587\\u7248\\u867D\\u7136\\u62D7\\u53E3\\u4E86\\u4E00\\u70B9\\u70B9\\uFF0C\\u4F46\\u662F\\u610F\\u601D\\u662F\\u6CA1\\u4EC0\\u4E48\\u95EE\\u9898\\u7684\\uFF0C\\u8BC1\\u660E\\u4E0D\\u662F\\u7FFB\\u8BD1\\u5BFC\\u81F4\\u7684\\u8BED\\u4E49\\u4E0D\\u660E\\u786E\\u3002\"), mdx(\"h2\", null, \"2. Openwrt \\u6216\\u8005 Lede \\u65E0\\u6CD5\\u5728\\u901A\\u8FC7\\u5185\\u7F51\\u7684\\u57DF\\u540D\\u8BBF\\u95EE\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u76F4\\u63A5\\u901A\\u8FC7 ip \\u8BBF\\u95EE\\u53EF\\u4EE5\\u6210\\u529F\\u8BBF\\u95EE\\u5230luci\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u4FEE\\u6539\\u7535\\u8111\\u7684 hosts\\u6587\\u4EF6\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"192.168.123.73 openwrt.lan\\n\")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u8BBF\\u95EE openwrt.lan \\u51FA\\u73B0\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"500 Internal Privoxy Error\\nPrivoxy encountered an error while processing your request:\\n\\nCould not load template file no-server-data or one of its included components.\\n\\nPlease contact your proxy administrator.\\n\\nIf you are the proxy administrator, please put the required file(s)in the (confdir)/templates directory. The location of the (confdir) directory is specified in the main Privoxy config file. (It's typically the Privoxy install directory, or /etc/privoxy/).\\n\")), mdx(\"h2\", null, \"\\u63D0\\u793A\\u6839\\u636E\\u6CD5\\u5F8B\\u89C4\\u5B9A\\uFF0Ckoolshare\\u8F6F\\u4EF6\\u4E2D\\u5FC3\\u4E0D\\u4F1A\\u5B89\\u88C5\\u6B64\\u63D2\\u4EF6\"), mdx(\"p\", null, \"sed -i 's/\\\\tdetect_package/\\\\t# detect_package/g' /koolshare/scripts/ks_tar_install.sh\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"1.《Linux设计与实现》中的task_struct 是否解决 在阅读  《Linux设计与实现》  3.2.2 时，留意到这样一段话： 内核通过一个唯一的进程标识值（process identification value）或  PID  来标识每个进程。  PID  是一个数，标识  pid_t…","frontmatter":{"date":"2020-12-29 05:42","title":"那些让我困惑的事情","draft":false}},{"id":"5db09af9-31b3-528d-abb7-0d5121227a8e","slug":"posts/code/node-koa2-session-login","rawBody":"---\ntitle: \"Node.js的Koa2中如何使用Session完成登录功能？\"\ndate: 2020-12-08T21:08:05+08:00\ncategories: [\"code\"]\ntags: [\"login\",\"session\",\"koa\",\"koa2\",\"JavaScript\",\"cookie\"]\ndraft: false\n---\n\n> 项目要用到登录注册，就需要使用到Cookie和Session来保持登录状态，于是就简单研究了一下\n\n### Cookie和Session的工作原理\n\n前面已经专门发过一篇帖子记录Cookie和Session的工作原理了，不明白的小伙伴可以看看[Cookie、Session是如何保持登录状态的？](https://segmentfault.com/a/1190000019065025)。\n\n### 使用Koa的Session中间件\n\nKoa是一个简洁的框架，把许多小功能都拆分成了中间件，用一个洋葱模型保证了中间件丰富的可拓展性，我们要使用Session来保持登录状态，就需要引用Session中间件。\n\n### 安装Koa-Session中间件\n\n```cmd\nnpm install koa-session --save\n```\n\n如果需要使用TypeScript进行开发，则需要引入对应的TS类型声明\n\n```cmd\nnpm install @types/koa-session --save\n```\n\n### 配置Session\n\nKoa-Session需要做一些配置：\n\n```JavaScript\nconst session_signed_key = [\"some secret hurr\"];  // 这个是配合signed属性的签名key\nconst session_config = {\n    key: 'koa:sess', /**  cookie的key。 (默认是 koa:sess) */\n    maxAge: 4000,   /**  session 过期时间，以毫秒ms为单位计算 。*/\n    autoCommit: true, /** 自动提交到响应头。(默认是 true) */\n    overwrite: true, /** 是否允许重写 。(默认是 true) */\n    httpOnly: true, /** 是否设置HttpOnly，如果在Cookie中设置了\"HttpOnly\"属性，那么通过程序(JS脚本、Applet等)将无法读取到Cookie信息，这样能有效的防止XSS攻击。  (默认 true) */\n    signed: true, /** 是否签名。(默认是 true) */\n    rolling: true, /** 是否每次响应时刷新Session的有效期。(默认是 false) */\n    renew: false, /** 是否在Session快过期时刷新Session的有效期。(默认是 false) */\n};\n```\n\n我们需要关注这几个配置：\n\n- renew rolling\n这两个都可以在用户访问的过程中刷新有效期，不至于让用户访问过程中Session过期成为未登录状态\n- signed\n这个是对客户端Cookie的签名，也就是用一个特点的字符加密，保证客户端Cookie不会被伪造出来\n- httpOnly\n打开这个使得通过程序(JS脚本、Applet等)无法读取Cookie，大大提高了安全性\n- maxAge\n以ms为单位的过期时间\n\n### 简单的使用\n\n首先理一下思路\n\n1. 判断访问者的Session有没有过登录记录属性\n2. 如果有且值为true，则为已登录，否则为未登录\n3. 如果为已登录，则不执行判断，直接返回已登录，如果为未登录，则执行下一步登录验证\n4. 如果验证成功，则返回的登录成功，并且在它的session中记下登录属性为true，如果验证失败，则返回登录失败。\n\n> 为了测试方便，以下用Get请求和一个固定的账号密码代替数据库查询，实际开发应该使用POST和数据库比对。同时为了测试方便，将过期时间设置为4000ms，便于快速看到Cookies过期，实际开发应该设置长一些，比如几小时甚至几天，取决于业务需求。\n\n```JavaScript\nconst Koa = require('koa');                               // 导入Koa\nconst Koa_Session = require('koa-session');   // 导入koa-session     \n// 配置\nconst session_signed_key = [\"some secret hurr\"];  // 这个是配合signed属性的签名key\nconst session_config = {\n    key: 'koa:sess', /**  cookie的key。 (默认是 koa:sess) */\n    maxAge: 4000,   /**  session 过期时间，以毫秒ms为单位计算 。*/\n    autoCommit: true, /** 自动提交到响应头。(默认是 true) */\n    overwrite: true, /** 是否允许重写 。(默认是 true) */\n    httpOnly: true, /** 是否设置HttpOnly，如果在Cookie中设置了\"HttpOnly\"属性，那么通过程序(JS脚本、Applet等)将无法读取到Cookie信息，这样能有效的防止XSS攻击。  (默认 true) */\n    signed: true, /** 是否签名。(默认是 true) */\n    rolling: true, /** 是否每次响应时刷新Session的有效期。(默认是 false) */\n    renew: false, /** 是否在Session快过期时刷新Session的有效期。(默认是 false) */\n};\n\n// 实例化\nconst app = new Koa();\nconst session = Koa_Session(session_config, app)\napp.keys = session_signed_key;\n\n// 使用中间件，注意有先后顺序\napp.use(session);\n\napp.use(ctx => {\n    const databaseUserName = \"testSession\";\n    const databaseUserPasswd = \"noDatabaseTest\";\n    // 对/favicon.ico网站图标请求忽略\n    if (ctx.path === '/favicon.ico') return;\n\n    if (!ctx.session.logged) {  // 如果登录属性为undefined或者false，对应未登录和登录失败\n        // 设置登录属性为false\n        ctx.session.logged = false;\n\n        // 取请求url解析后的参数对象，方便比对\n        // 如?nickname=post修改&passwd=123解析为{nickname:\"post修改\",passwd:\"123\"}\n        let query = ctx.request.query;\n\n        // 判断用户名密码是否为空\n        if (query.nickname && query.passwd) {\n\n            // 比对并分情况返回结果  \n            if (databaseUserName == query.nickname) {  // 如果存在该用户名\n\n                // 进行密码比对并返回结果 \n                ctx.body = (databaseUserPasswd == query.passwd) ? \"登录成功\" : \"用户名或密码错误\";\n                ctx.session.logged = true;\n            } else {                    // 如果不存在该用户名                                           //  如果用户名不存在\n                ctx.body = \"用户名不存在\";\n            }\n        } else {\n            ctx.body = \"用户名密码不能为空\";\n        }\n    } else {\n        ctx.body = \"已登录\";\n    }\n\n}\n);\n\napp.listen(3000);\nconsole.log(\"Koa运行在：http://127.0.0.1:3000\");   \n```\n\n运行一下，控制台输出：\n\n```cmd\nKoa运行在：http://127.0.0.1:3000\n```\n\n访问[http://127.0.0.1:3000](http://127.0.0.1:3000)，可以看到我们没有填写登录参数，然后返回了用户名密码不能空，并且按下F12，点击Cookies再点击[http://127.0.0.1:3000](http://127.0.0.1:3000)，看到了我们的SessionId被记录到了Cookies中，说明Session生效了。\n![1](https://upload-images.jianshu.io/upload_images/14225973-8ae8fb28dcfe78a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n我们静置一会但不刷新页面，再点击Cookies后重新点击，[http://127.0.0.1:3000](http://127.0.0.1:3000)（刷新Cookies显示），发现我们的SessionId不见了，说明我们的过期时间也生效了\n![2](https://upload-images.jianshu.io/upload_images/14225973-ecbf3753b37436c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n我将Cookies的数据截详细一点就是这样的，可以看到有个过期时间：\n![3](https://upload-images.jianshu.io/upload_images/14225973-422c47b819d5c7cf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n我们再访问[http://127.0.0.1:3000/?nickname=123](http://127.0.0.1:3000/?nickname=123)和[http://127.0.0.1:3000/?passwd=123](http://127.0.0.1:3000/?passwd=123)，都输出了\n![4](https://upload-images.jianshu.io/upload_images/14225973-618d9f63eaf7d2cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n访问[http://127.0.0.1:3000/?nickname=123&&passwd=123](http://127.0.0.1:3000/?nickname=123&&passwd=123)，输出\n![5](https://upload-images.jianshu.io/upload_images/14225973-04fc4fc688e30868.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n访问[http://127.0.0.1:3000/?nickname=testSession&&passwd=123](http://127.0.0.1:3000/?nickname=testSession&&passwd=123)，输出\n![6](https://upload-images.jianshu.io/upload_images/14225973-236ee36413c040fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n最后尝试正确的用户名密码[http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest](http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest)\n，输出![登录成功](https://upload-images.jianshu.io/upload_images/14225973-a67d3a9bdbc9b3ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n尝试再次访问[http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest](http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest)\n，输出\n\n![重复登录](https://upload-images.jianshu.io/upload_images/14225973-3fbd253861481a36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n在有效期限内访问别的页面[http://127.0.0.1:3000/](http://127.0.0.1:3000/)，输出\n![有效期内](https://upload-images.jianshu.io/upload_images/14225973-8783aac616ff79aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n有效期内不断刷新就能保持登录状态\n![不断刷新](https://upload-images.jianshu.io/upload_images/14225973-5152a1573021dfe8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n有效期内没有重新操作页面刷新状态就会自然过期\n![过期](https://upload-images.jianshu.io/upload_images/14225973-9853d8e5e14bf4df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Node.js的Koa2中如何使用Session完成登录功能？\",\n  \"date\": \"2020-12-08T13:08:05.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"login\", \"session\", \"koa\", \"koa2\", \"JavaScript\", \"cookie\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u9879\\u76EE\\u8981\\u7528\\u5230\\u767B\\u5F55\\u6CE8\\u518C\\uFF0C\\u5C31\\u9700\\u8981\\u4F7F\\u7528\\u5230Cookie\\u548CSession\\u6765\\u4FDD\\u6301\\u767B\\u5F55\\u72B6\\u6001\\uFF0C\\u4E8E\\u662F\\u5C31\\u7B80\\u5355\\u7814\\u7A76\\u4E86\\u4E00\\u4E0B\")), mdx(\"h3\", null, \"Cookie\\u548CSession\\u7684\\u5DE5\\u4F5C\\u539F\\u7406\"), mdx(\"p\", null, \"\\u524D\\u9762\\u5DF2\\u7ECF\\u4E13\\u95E8\\u53D1\\u8FC7\\u4E00\\u7BC7\\u5E16\\u5B50\\u8BB0\\u5F55Cookie\\u548CSession\\u7684\\u5DE5\\u4F5C\\u539F\\u7406\\u4E86\\uFF0C\\u4E0D\\u660E\\u767D\\u7684\\u5C0F\\u4F19\\u4F34\\u53EF\\u4EE5\\u770B\\u770B\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://segmentfault.com/a/1190000019065025\"\n  }, \"Cookie\\u3001Session\\u662F\\u5982\\u4F55\\u4FDD\\u6301\\u767B\\u5F55\\u72B6\\u6001\\u7684\\uFF1F\"), \"\\u3002\"), mdx(\"h3\", null, \"\\u4F7F\\u7528Koa\\u7684Session\\u4E2D\\u95F4\\u4EF6\"), mdx(\"p\", null, \"Koa\\u662F\\u4E00\\u4E2A\\u7B80\\u6D01\\u7684\\u6846\\u67B6\\uFF0C\\u628A\\u8BB8\\u591A\\u5C0F\\u529F\\u80FD\\u90FD\\u62C6\\u5206\\u6210\\u4E86\\u4E2D\\u95F4\\u4EF6\\uFF0C\\u7528\\u4E00\\u4E2A\\u6D0B\\u8471\\u6A21\\u578B\\u4FDD\\u8BC1\\u4E86\\u4E2D\\u95F4\\u4EF6\\u4E30\\u5BCC\\u7684\\u53EF\\u62D3\\u5C55\\u6027\\uFF0C\\u6211\\u4EEC\\u8981\\u4F7F\\u7528Session\\u6765\\u4FDD\\u6301\\u767B\\u5F55\\u72B6\\u6001\\uFF0C\\u5C31\\u9700\\u8981\\u5F15\\u7528Session\\u4E2D\\u95F4\\u4EF6\\u3002\"), mdx(\"h3\", null, \"\\u5B89\\u88C5Koa-Session\\u4E2D\\u95F4\\u4EF6\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"npm install koa-session --save\\n\")), mdx(\"p\", null, \"\\u5982\\u679C\\u9700\\u8981\\u4F7F\\u7528TypeScript\\u8FDB\\u884C\\u5F00\\u53D1\\uFF0C\\u5219\\u9700\\u8981\\u5F15\\u5165\\u5BF9\\u5E94\\u7684TS\\u7C7B\\u578B\\u58F0\\u660E\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"npm install @types/koa-session --save\\n\")), mdx(\"h3\", null, \"\\u914D\\u7F6ESession\"), mdx(\"p\", null, \"Koa-Session\\u9700\\u8981\\u505A\\u4E00\\u4E9B\\u914D\\u7F6E\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-JavaScript\"\n  }, \"const session_signed_key = [\\\"some secret hurr\\\"];  // \\u8FD9\\u4E2A\\u662F\\u914D\\u5408signed\\u5C5E\\u6027\\u7684\\u7B7E\\u540Dkey\\nconst session_config = {\\n    key: 'koa:sess', /**  cookie\\u7684key\\u3002 (\\u9ED8\\u8BA4\\u662F koa:sess) */\\n    maxAge: 4000,   /**  session \\u8FC7\\u671F\\u65F6\\u95F4\\uFF0C\\u4EE5\\u6BEB\\u79D2ms\\u4E3A\\u5355\\u4F4D\\u8BA1\\u7B97 \\u3002*/\\n    autoCommit: true, /** \\u81EA\\u52A8\\u63D0\\u4EA4\\u5230\\u54CD\\u5E94\\u5934\\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    overwrite: true, /** \\u662F\\u5426\\u5141\\u8BB8\\u91CD\\u5199 \\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    httpOnly: true, /** \\u662F\\u5426\\u8BBE\\u7F6EHttpOnly\\uFF0C\\u5982\\u679C\\u5728Cookie\\u4E2D\\u8BBE\\u7F6E\\u4E86\\\"HttpOnly\\\"\\u5C5E\\u6027\\uFF0C\\u90A3\\u4E48\\u901A\\u8FC7\\u7A0B\\u5E8F(JS\\u811A\\u672C\\u3001Applet\\u7B49)\\u5C06\\u65E0\\u6CD5\\u8BFB\\u53D6\\u5230Cookie\\u4FE1\\u606F\\uFF0C\\u8FD9\\u6837\\u80FD\\u6709\\u6548\\u7684\\u9632\\u6B62XSS\\u653B\\u51FB\\u3002  (\\u9ED8\\u8BA4 true) */\\n    signed: true, /** \\u662F\\u5426\\u7B7E\\u540D\\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    rolling: true, /** \\u662F\\u5426\\u6BCF\\u6B21\\u54CD\\u5E94\\u65F6\\u5237\\u65B0Session\\u7684\\u6709\\u6548\\u671F\\u3002(\\u9ED8\\u8BA4\\u662F false) */\\n    renew: false, /** \\u662F\\u5426\\u5728Session\\u5FEB\\u8FC7\\u671F\\u65F6\\u5237\\u65B0Session\\u7684\\u6709\\u6548\\u671F\\u3002(\\u9ED8\\u8BA4\\u662F false) */\\n};\\n\")), mdx(\"p\", null, \"\\u6211\\u4EEC\\u9700\\u8981\\u5173\\u6CE8\\u8FD9\\u51E0\\u4E2A\\u914D\\u7F6E\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"renew rolling\\n\\u8FD9\\u4E24\\u4E2A\\u90FD\\u53EF\\u4EE5\\u5728\\u7528\\u6237\\u8BBF\\u95EE\\u7684\\u8FC7\\u7A0B\\u4E2D\\u5237\\u65B0\\u6709\\u6548\\u671F\\uFF0C\\u4E0D\\u81F3\\u4E8E\\u8BA9\\u7528\\u6237\\u8BBF\\u95EE\\u8FC7\\u7A0B\\u4E2DSession\\u8FC7\\u671F\\u6210\\u4E3A\\u672A\\u767B\\u5F55\\u72B6\\u6001\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"signed\\n\\u8FD9\\u4E2A\\u662F\\u5BF9\\u5BA2\\u6237\\u7AEFCookie\\u7684\\u7B7E\\u540D\\uFF0C\\u4E5F\\u5C31\\u662F\\u7528\\u4E00\\u4E2A\\u7279\\u70B9\\u7684\\u5B57\\u7B26\\u52A0\\u5BC6\\uFF0C\\u4FDD\\u8BC1\\u5BA2\\u6237\\u7AEFCookie\\u4E0D\\u4F1A\\u88AB\\u4F2A\\u9020\\u51FA\\u6765\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"httpOnly\\n\\u6253\\u5F00\\u8FD9\\u4E2A\\u4F7F\\u5F97\\u901A\\u8FC7\\u7A0B\\u5E8F(JS\\u811A\\u672C\\u3001Applet\\u7B49)\\u65E0\\u6CD5\\u8BFB\\u53D6Cookie\\uFF0C\\u5927\\u5927\\u63D0\\u9AD8\\u4E86\\u5B89\\u5168\\u6027\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"maxAge\\n\\u4EE5ms\\u4E3A\\u5355\\u4F4D\\u7684\\u8FC7\\u671F\\u65F6\\u95F4\")), mdx(\"h3\", null, \"\\u7B80\\u5355\\u7684\\u4F7F\\u7528\"), mdx(\"p\", null, \"\\u9996\\u5148\\u7406\\u4E00\\u4E0B\\u601D\\u8DEF\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5224\\u65AD\\u8BBF\\u95EE\\u8005\\u7684Session\\u6709\\u6CA1\\u6709\\u8FC7\\u767B\\u5F55\\u8BB0\\u5F55\\u5C5E\\u6027\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5982\\u679C\\u6709\\u4E14\\u503C\\u4E3Atrue\\uFF0C\\u5219\\u4E3A\\u5DF2\\u767B\\u5F55\\uFF0C\\u5426\\u5219\\u4E3A\\u672A\\u767B\\u5F55\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5982\\u679C\\u4E3A\\u5DF2\\u767B\\u5F55\\uFF0C\\u5219\\u4E0D\\u6267\\u884C\\u5224\\u65AD\\uFF0C\\u76F4\\u63A5\\u8FD4\\u56DE\\u5DF2\\u767B\\u5F55\\uFF0C\\u5982\\u679C\\u4E3A\\u672A\\u767B\\u5F55\\uFF0C\\u5219\\u6267\\u884C\\u4E0B\\u4E00\\u6B65\\u767B\\u5F55\\u9A8C\\u8BC1\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5982\\u679C\\u9A8C\\u8BC1\\u6210\\u529F\\uFF0C\\u5219\\u8FD4\\u56DE\\u7684\\u767B\\u5F55\\u6210\\u529F\\uFF0C\\u5E76\\u4E14\\u5728\\u5B83\\u7684session\\u4E2D\\u8BB0\\u4E0B\\u767B\\u5F55\\u5C5E\\u6027\\u4E3Atrue\\uFF0C\\u5982\\u679C\\u9A8C\\u8BC1\\u5931\\u8D25\\uFF0C\\u5219\\u8FD4\\u56DE\\u767B\\u5F55\\u5931\\u8D25\\u3002\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u4E3A\\u4E86\\u6D4B\\u8BD5\\u65B9\\u4FBF\\uFF0C\\u4EE5\\u4E0B\\u7528Get\\u8BF7\\u6C42\\u548C\\u4E00\\u4E2A\\u56FA\\u5B9A\\u7684\\u8D26\\u53F7\\u5BC6\\u7801\\u4EE3\\u66FF\\u6570\\u636E\\u5E93\\u67E5\\u8BE2\\uFF0C\\u5B9E\\u9645\\u5F00\\u53D1\\u5E94\\u8BE5\\u4F7F\\u7528POST\\u548C\\u6570\\u636E\\u5E93\\u6BD4\\u5BF9\\u3002\\u540C\\u65F6\\u4E3A\\u4E86\\u6D4B\\u8BD5\\u65B9\\u4FBF\\uFF0C\\u5C06\\u8FC7\\u671F\\u65F6\\u95F4\\u8BBE\\u7F6E\\u4E3A4000ms\\uFF0C\\u4FBF\\u4E8E\\u5FEB\\u901F\\u770B\\u5230Cookies\\u8FC7\\u671F\\uFF0C\\u5B9E\\u9645\\u5F00\\u53D1\\u5E94\\u8BE5\\u8BBE\\u7F6E\\u957F\\u4E00\\u4E9B\\uFF0C\\u6BD4\\u5982\\u51E0\\u5C0F\\u65F6\\u751A\\u81F3\\u51E0\\u5929\\uFF0C\\u53D6\\u51B3\\u4E8E\\u4E1A\\u52A1\\u9700\\u6C42\\u3002\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-JavaScript\"\n  }, \"const Koa = require('koa');                               // \\u5BFC\\u5165Koa\\nconst Koa_Session = require('koa-session');   // \\u5BFC\\u5165koa-session     \\n// \\u914D\\u7F6E\\nconst session_signed_key = [\\\"some secret hurr\\\"];  // \\u8FD9\\u4E2A\\u662F\\u914D\\u5408signed\\u5C5E\\u6027\\u7684\\u7B7E\\u540Dkey\\nconst session_config = {\\n    key: 'koa:sess', /**  cookie\\u7684key\\u3002 (\\u9ED8\\u8BA4\\u662F koa:sess) */\\n    maxAge: 4000,   /**  session \\u8FC7\\u671F\\u65F6\\u95F4\\uFF0C\\u4EE5\\u6BEB\\u79D2ms\\u4E3A\\u5355\\u4F4D\\u8BA1\\u7B97 \\u3002*/\\n    autoCommit: true, /** \\u81EA\\u52A8\\u63D0\\u4EA4\\u5230\\u54CD\\u5E94\\u5934\\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    overwrite: true, /** \\u662F\\u5426\\u5141\\u8BB8\\u91CD\\u5199 \\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    httpOnly: true, /** \\u662F\\u5426\\u8BBE\\u7F6EHttpOnly\\uFF0C\\u5982\\u679C\\u5728Cookie\\u4E2D\\u8BBE\\u7F6E\\u4E86\\\"HttpOnly\\\"\\u5C5E\\u6027\\uFF0C\\u90A3\\u4E48\\u901A\\u8FC7\\u7A0B\\u5E8F(JS\\u811A\\u672C\\u3001Applet\\u7B49)\\u5C06\\u65E0\\u6CD5\\u8BFB\\u53D6\\u5230Cookie\\u4FE1\\u606F\\uFF0C\\u8FD9\\u6837\\u80FD\\u6709\\u6548\\u7684\\u9632\\u6B62XSS\\u653B\\u51FB\\u3002  (\\u9ED8\\u8BA4 true) */\\n    signed: true, /** \\u662F\\u5426\\u7B7E\\u540D\\u3002(\\u9ED8\\u8BA4\\u662F true) */\\n    rolling: true, /** \\u662F\\u5426\\u6BCF\\u6B21\\u54CD\\u5E94\\u65F6\\u5237\\u65B0Session\\u7684\\u6709\\u6548\\u671F\\u3002(\\u9ED8\\u8BA4\\u662F false) */\\n    renew: false, /** \\u662F\\u5426\\u5728Session\\u5FEB\\u8FC7\\u671F\\u65F6\\u5237\\u65B0Session\\u7684\\u6709\\u6548\\u671F\\u3002(\\u9ED8\\u8BA4\\u662F false) */\\n};\\n\\n// \\u5B9E\\u4F8B\\u5316\\nconst app = new Koa();\\nconst session = Koa_Session(session_config, app)\\napp.keys = session_signed_key;\\n\\n// \\u4F7F\\u7528\\u4E2D\\u95F4\\u4EF6\\uFF0C\\u6CE8\\u610F\\u6709\\u5148\\u540E\\u987A\\u5E8F\\napp.use(session);\\n\\napp.use(ctx => {\\n    const databaseUserName = \\\"testSession\\\";\\n    const databaseUserPasswd = \\\"noDatabaseTest\\\";\\n    // \\u5BF9/favicon.ico\\u7F51\\u7AD9\\u56FE\\u6807\\u8BF7\\u6C42\\u5FFD\\u7565\\n    if (ctx.path === '/favicon.ico') return;\\n\\n    if (!ctx.session.logged) {  // \\u5982\\u679C\\u767B\\u5F55\\u5C5E\\u6027\\u4E3Aundefined\\u6216\\u8005false\\uFF0C\\u5BF9\\u5E94\\u672A\\u767B\\u5F55\\u548C\\u767B\\u5F55\\u5931\\u8D25\\n        // \\u8BBE\\u7F6E\\u767B\\u5F55\\u5C5E\\u6027\\u4E3Afalse\\n        ctx.session.logged = false;\\n\\n        // \\u53D6\\u8BF7\\u6C42url\\u89E3\\u6790\\u540E\\u7684\\u53C2\\u6570\\u5BF9\\u8C61\\uFF0C\\u65B9\\u4FBF\\u6BD4\\u5BF9\\n        // \\u5982?nickname=post\\u4FEE\\u6539&passwd=123\\u89E3\\u6790\\u4E3A{nickname:\\\"post\\u4FEE\\u6539\\\",passwd:\\\"123\\\"}\\n        let query = ctx.request.query;\\n\\n        // \\u5224\\u65AD\\u7528\\u6237\\u540D\\u5BC6\\u7801\\u662F\\u5426\\u4E3A\\u7A7A\\n        if (query.nickname && query.passwd) {\\n\\n            // \\u6BD4\\u5BF9\\u5E76\\u5206\\u60C5\\u51B5\\u8FD4\\u56DE\\u7ED3\\u679C  \\n            if (databaseUserName == query.nickname) {  // \\u5982\\u679C\\u5B58\\u5728\\u8BE5\\u7528\\u6237\\u540D\\n\\n                // \\u8FDB\\u884C\\u5BC6\\u7801\\u6BD4\\u5BF9\\u5E76\\u8FD4\\u56DE\\u7ED3\\u679C \\n                ctx.body = (databaseUserPasswd == query.passwd) ? \\\"\\u767B\\u5F55\\u6210\\u529F\\\" : \\\"\\u7528\\u6237\\u540D\\u6216\\u5BC6\\u7801\\u9519\\u8BEF\\\";\\n                ctx.session.logged = true;\\n            } else {                    // \\u5982\\u679C\\u4E0D\\u5B58\\u5728\\u8BE5\\u7528\\u6237\\u540D                                           //  \\u5982\\u679C\\u7528\\u6237\\u540D\\u4E0D\\u5B58\\u5728\\n                ctx.body = \\\"\\u7528\\u6237\\u540D\\u4E0D\\u5B58\\u5728\\\";\\n            }\\n        } else {\\n            ctx.body = \\\"\\u7528\\u6237\\u540D\\u5BC6\\u7801\\u4E0D\\u80FD\\u4E3A\\u7A7A\\\";\\n        }\\n    } else {\\n        ctx.body = \\\"\\u5DF2\\u767B\\u5F55\\\";\\n    }\\n\\n}\\n);\\n\\napp.listen(3000);\\nconsole.log(\\\"Koa\\u8FD0\\u884C\\u5728\\uFF1Ahttp://127.0.0.1:3000\\\");   \\n\")), mdx(\"p\", null, \"\\u8FD0\\u884C\\u4E00\\u4E0B\\uFF0C\\u63A7\\u5236\\u53F0\\u8F93\\u51FA\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"Koa\\u8FD0\\u884C\\u5728\\uFF1Ahttp://127.0.0.1:3000\\n\")), mdx(\"p\", null, \"\\u8BBF\\u95EE\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000\"\n  }, \"http://127.0.0.1:3000\"), \"\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\\u6211\\u4EEC\\u6CA1\\u6709\\u586B\\u5199\\u767B\\u5F55\\u53C2\\u6570\\uFF0C\\u7136\\u540E\\u8FD4\\u56DE\\u4E86\\u7528\\u6237\\u540D\\u5BC6\\u7801\\u4E0D\\u80FD\\u7A7A\\uFF0C\\u5E76\\u4E14\\u6309\\u4E0BF12\\uFF0C\\u70B9\\u51FBCookies\\u518D\\u70B9\\u51FB\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000\"\n  }, \"http://127.0.0.1:3000\"), \"\\uFF0C\\u770B\\u5230\\u4E86\\u6211\\u4EEC\\u7684SessionId\\u88AB\\u8BB0\\u5F55\\u5230\\u4E86Cookies\\u4E2D\\uFF0C\\u8BF4\\u660ESession\\u751F\\u6548\\u4E86\\u3002\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-8ae8fb28dcfe78a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"1\"\n  })), mdx(\"p\", null, \"\\u6211\\u4EEC\\u9759\\u7F6E\\u4E00\\u4F1A\\u4F46\\u4E0D\\u5237\\u65B0\\u9875\\u9762\\uFF0C\\u518D\\u70B9\\u51FBCookies\\u540E\\u91CD\\u65B0\\u70B9\\u51FB\\uFF0C\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000\"\n  }, \"http://127.0.0.1:3000\"), \"\\uFF08\\u5237\\u65B0Cookies\\u663E\\u793A\\uFF09\\uFF0C\\u53D1\\u73B0\\u6211\\u4EEC\\u7684SessionId\\u4E0D\\u89C1\\u4E86\\uFF0C\\u8BF4\\u660E\\u6211\\u4EEC\\u7684\\u8FC7\\u671F\\u65F6\\u95F4\\u4E5F\\u751F\\u6548\\u4E86\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-ecbf3753b37436c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"2\"\n  })), mdx(\"p\", null, \"\\u6211\\u5C06Cookies\\u7684\\u6570\\u636E\\u622A\\u8BE6\\u7EC6\\u4E00\\u70B9\\u5C31\\u662F\\u8FD9\\u6837\\u7684\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\\u6709\\u4E2A\\u8FC7\\u671F\\u65F6\\u95F4\\uFF1A\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-422c47b819d5c7cf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"3\"\n  })), mdx(\"p\", null, \"\\u6211\\u4EEC\\u518D\\u8BBF\\u95EE\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?nickname=123\"\n  }, \"http://127.0.0.1:3000/?nickname=123\"), \"\\u548C\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?passwd=123\"\n  }, \"http://127.0.0.1:3000/?passwd=123\"), \"\\uFF0C\\u90FD\\u8F93\\u51FA\\u4E86\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-618d9f63eaf7d2cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"4\"\n  })), mdx(\"p\", null, \"\\u8BBF\\u95EE\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?nickname=123&&passwd=123\"\n  }, \"http://127.0.0.1:3000/?nickname=123&&passwd=123\"), \"\\uFF0C\\u8F93\\u51FA\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-04fc4fc688e30868.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"5\"\n  })), mdx(\"p\", null, \"\\u8BBF\\u95EE\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?nickname=testSession&&passwd=123\"\n  }, \"http://127.0.0.1:3000/?nickname=testSession&&passwd=123\"), \"\\uFF0C\\u8F93\\u51FA\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-236ee36413c040fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"6\"\n  })), mdx(\"p\", null, \"\\u6700\\u540E\\u5C1D\\u8BD5\\u6B63\\u786E\\u7684\\u7528\\u6237\\u540D\\u5BC6\\u7801\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest\"\n  }, \"http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest\"), \"\\n\\uFF0C\\u8F93\\u51FA\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-a67d3a9bdbc9b3ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"登录成功\"\n  }), \"\\n\\u5C1D\\u8BD5\\u518D\\u6B21\\u8BBF\\u95EE\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest\"\n  }, \"http://127.0.0.1:3000/?nickname=testSession&&passwd=noDatabaseTest\"), \"\\n\\uFF0C\\u8F93\\u51FA\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-3fbd253861481a36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"重复登录\"\n  })), mdx(\"p\", null, \"\\u5728\\u6709\\u6548\\u671F\\u9650\\u5185\\u8BBF\\u95EE\\u522B\\u7684\\u9875\\u9762\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://127.0.0.1:3000/\"\n  }, \"http://127.0.0.1:3000/\"), \"\\uFF0C\\u8F93\\u51FA\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-8783aac616ff79aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"有效期内\"\n  })), mdx(\"p\", null, \"\\u6709\\u6548\\u671F\\u5185\\u4E0D\\u65AD\\u5237\\u65B0\\u5C31\\u80FD\\u4FDD\\u6301\\u767B\\u5F55\\u72B6\\u6001\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-5152a1573021dfe8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"不断刷新\"\n  })), mdx(\"p\", null, \"\\u6709\\u6548\\u671F\\u5185\\u6CA1\\u6709\\u91CD\\u65B0\\u64CD\\u4F5C\\u9875\\u9762\\u5237\\u65B0\\u72B6\\u6001\\u5C31\\u4F1A\\u81EA\\u7136\\u8FC7\\u671F\\n\", mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-9853d8e5e14bf4df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"过期\"\n  })));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"项目要用到登录注册，就需要使用到Cookie和Session来保持登录状态，于是就简单研究了一下 Cookie和Session的工作原理 前面已经专门发过一篇帖子记录Cookie和Session的工作原理了，不明白的小伙伴可以看看 Cookie、Session是如何保持登录状态的？ 。 使用Koa的Session…","frontmatter":{"date":"2020-12-08 13:08","title":"Node.js的Koa2中如何使用Session完成登录功能？","draft":false}},{"id":"cd46902a-5078-5427-b229-10859f111d55","slug":"posts/code/netease-cloud-music-api","rawBody":"---\ntitle: \"为微信小程序开发的网易云音乐api库\"\ndate: 2020-12-08T20:25:36+08:00\ncategories: [\"code\"]\ntags: [\"javascript\", \"小程序\", \"音乐外链\", \"网易云音乐\"]\ndraft: false\n---\n\n> 之前我们已经开发过一款小程序适用的qq音乐api库[https://github.com/FisherWY/QQMusicPlugin](https://github.com/FisherWY/QQMusicPlugin)了，这次开发网易云音乐api库的原因是qq音乐api库在小程序中iOS环境下无法使用小程序提供的背景音频播放器播放的问题\n> 网易云的加密算法真的比其他几家api复杂太多了。。。完爆QQ和酷狗想要直接用的话可以到Github直接取我封装好的api库。Github地址[https://github.com/JabinGP/NetEaseCloudMusicApi](https://github.com/JabinGP/NetEaseCloudMusicApi)\n\n### 依赖\n\n本api库参考了Github上面开源的node库，因为我们只想要查找音乐和播放音乐这两个功能，虽然Github那个库很方便，但是我们不想为了两个接口特意去跑一个node.js服务。\n\n1. big-integer.js  \n  这里注意，不要使用最新版的，最新版的库再模拟器上运行没有问题，但是在真机调试的上传包阶段会报错说无法识别big-integer.js，最后在我的尝试下，选用了一个老版本的库解决了这个问题。\n2. crypto-js\n这个库是用来aes加密的，在node上面有一个原生的crypto，但是在小程序里我们没有，所以我照着Github上的源码一点一点用这个库翻译过来的，还有Buffer在小程序里也没有，我使用这个库的方法代替了。\n\n### 获取api的原理\n\n网上很多帖子讲的很清楚了，这里推荐几篇文章，我只做一个简单的总结，方便大家理解这个库。\n网易云的加密算法大概使用了两个：\n\n1. AES加密+BASE64编码\n2. RSA加密\n\n加密大致流程：\n\n1. api请求信息先被转成json字符串格式，然后再使用一个固定的密钥aes+base64编码加密，得到了第一个`加密结果a`。\n\n2. 客户端从`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/`随机生成一个新的16位密钥，然后用这个密钥去加密`加密结果a`，得到`加密结果b`。\n\n3. 这样我们的数据就被双重加密了，但是我们要发给服务器去查询对应的数据，服务器知道第一个固定的密钥是多少，可以解开第一个加密结果，但是服务器可不知道我们第二次加密用的是什么，所以服务器还需要得到我们的第二个生成的随机加密密钥。\n\n4. 第二个随机加密密钥要是直接发给服务器好像就不太安全了，所以客户端对第二个随机加密密钥也进行了加密，使用的就是RSA加密，加密后得到的数据我们称为`c`\n\n5. 将`b`和`c`发送给服务器，服务器就会返回给我们对应的结果了。\n\n### 加密核心代码\n\n这段代码传入对象后可以直接加密成符合网易云api加密的结果。\n\n```javascript\n// 生成随机数，size默认16\nfunction createSecretKey(size) {\n    const keys = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"\n    let key = \"\"\n    for (let i = 0; i < size; i++) {\n        let pos = Math.random() * keys.length\n        pos = Math.floor(pos)\n        key = key + keys.charAt(pos)\n    }\n    return key\n}\n\n\n// aes加密方法\nfunction aesEncrypt(word, secKey) {\n    let key = CryptoJS.enc.Utf8.parse(secKey);  //十六位十六进制数作为密钥\n    let iv = CryptoJS.enc.Utf8.parse(aes_mv);   //十六位十六进制数作为密钥偏移量\n    let srcs = CryptoJS.enc.Utf8.parse(word);\n    let encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });\n    let res = encrypted.toString();\n    console.log(res);\n    return res;\n}\n\n// 填充方法\nfunction zfill(str, size) {\n    while (str.length < size) str = \"0\" + str\n    return str\n}\n\n// rsa加密方法\nfunction rsaEncrypt(text, pubKey, modulus) {\n    const _text = text.split('').reverse().join('')\n    const biText = bigInt(CryptoJS.enc.Utf8.parse(_text).toString(), 16),\n        biEx = bigInt(pubKey, 16),\n        biMod = bigInt(modulus, 16),\n        biRet = biText.modPow(biEx, biMod)\n    return zfill(biRet.toString(16), 256)\n}\n\n\n// 加密总入口\nfunction Encrypt(obj) {\n    const text = JSON.stringify(obj)\n    const secKey = createSecretKey(16)\n    const encText = aesEncrypt(aesEncrypt(text, nonce), secKey)\n    const encSecKey = rsaEncrypt(secKey, pubKey, modulus)\n    return {\n        params: encText,\n        encSecKey: encSecKey\n    }\n}\n```\n\n### 封装好的Api库\n\n首先到Github下载我的Api库[https://github.com/JabinGP/NetEaseCloudMusicApi\n](https://github.com/JabinGP/NetEaseCloudMusicApi\n)下载完成后，这个库应该是可以直接导入微信小程序开发工具运行的，但是有几个注意事项:\n\n1. 这个库是用TypeScript写的，但是最后编译成了JS运行，但是编译后JS代码可读性很差，所以我保留了TypeScript源文件，就在NetEaseCloudMusicApi/ts_src里面，应用库的时候不需要使用到\n\n2. 关闭小程序开发工具的详情页的`ES6转ES5`，可以使用await处理异步请求（因为库是用`Promise`写的，起码要能用`Promise`，实例代码使用的是`await`/`async`）\n\n3. await关键字只能在async修饰过的函数体内部使用，不懂的可以查一下await和async的用法。\n\n4. `NetEaseCloudMusicApi/Libary`文件夹里面包含了项目依赖的js文件，应用的时候最好整个`NetEaseCloudMusicApi`文件夹复制到项目里面使用。\n\n5. 测试的时候可以勾选不校验合法域名。\n\n![1](https://upload-images.jianshu.io/upload_images/14225973-b53fa739408a3105.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n### 开始使用之前的准备\n\n1. 找到NetEaseCloudMusicApi这个文件夹，里面应该包括Libary、src、ts_src三个文件夹，Libary是我引用的开源库，ts_src中是TypeScript源文件，src是ts_src编译后产生的JavaScript文件夹，也就是说不考虑读ts源文件的话，可以把ts_src删了，但是17.4 KB 的大小对应用包体积应该没有什么影响吧，留着也行。\n\n2. 在要使用到的库中如下引用\n\n```js\nconst {MusicManager} = require(\"../../NetEaseCloudMusicApi/src/MusicManager\");\n```\n\n注意要用花括号吧`MusicManager`括起来，这一句可以需要变化的地方只有\n`../../NetEaseCloudMusicApi/src/MusicManager`中的`../../`，后面的路径都代表了`NetEaseCloudMusicApi`文件夹和`NetEaseCloudMusicApi`里面文件的路径，因为我的库就是这样的结构，所以不需要改变，`../../`就要根据你项目中实际结构来改变了。\n\n### MusicManager\n\n该类有以下方法：该类提供了所有获取其他对象的方法，可以通过该类获取其他需要的对象而不是new\n\n- `getMusicSearchHelper()`\n需要参数：`{keyword:\"搜索歌曲关键词\",limit:数字}`\n返回：`MusicSearchHelper`搜索器\n- `getMusicUrlHelper()`\n 需要参数：`musicId`（数字类型的歌曲id）\n返回：`MusicUrlHelper`Url获取器\n- `getUserSearchHelper()`\n需要参数：`{userName:\"搜索用户的用户名关键词\",limit:数字}`\n返回：`UserSearchHelper`用户查询器\n- `getUserListHelper()`\n需要参数：`userId`（数字类型的用户id值）\n返回：`UserListHelper`用户列表查询器\n- `getUserListDetailHelper()`\n需要参数：`listId`（数字类型的列表id）\n返回：`UserListDetailHelper`用户列表详情信息获取器\n\n### MusicSearchHelper\n\n用于搜索音乐\n可用方法：\n\n- `getSearchResult()`---获取数据（默认第一页）\n- `nextPage()`--- 下一页\n- `previousPage()`---上一页\n- `getCurrentPage()`---查看当前页数的\n\n执行完切换页数后需要再次调用`getSearchResult`方法查看新的查询结果。\n\n### MusicUrlHelper\n\n用于将搜索音乐结果中的id转换为url播放链接\n可用方法：\n\n- `getUrlResult()` ---获取url播放链接\n\n### UserSearchHelper\n\n用于根据用户名关键字搜索用户\n可用方法：\n\n- `getSearchResult()`---获取搜索结果\n\n### UserListHelper\n\n用于获取用户id后根据id获取用户歌单信息\n可用方法：\n\n- `getAllLists()`---获取用户所有歌单\n- `getILikeList()`---获取用户的我喜欢歌单\n\n### UserListDetailHelper\n\n用于获取歌单id后获取歌单内歌曲列表\n可用方法：\n\n- `getDeatil()`---获取歌单内列表\n\n### 搜索歌曲\n\n1. 通过`MusicManager`获取一个`MusicSearchHelper`搜索器\n\n2. `MusicSearchHelper`的方法：\n    - `getSearchResult()`---获取数据（默认第一页）\n    - `nextPage()`--- 下一页\n    - `previousPage()`---上一页\n    - `getCurrentPage()`---查看当前页数的\n\n3. 执行完切换页数后需要再次调用`getSearchResult`方法查看新的查询结果。\n\n代码实例\n\n```javascript\nconst {MusicManager} = require(\"../../NetEaseCloudMusicApi/src/MusicManager\");\nasync function test(){\n     // 搜索歌曲\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \"one more time one more chance\", limit: 10 });\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.nextPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.previousPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    console.log(musicSearchHelper);\n} \ntest();\n```\n\n![2](https://upload-images.jianshu.io/upload_images/14225973-0977450d4401c36b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n### 通过搜索歌曲的结果获取音乐Url\n\n有了搜索结果，我们还需要url才能播放资源\n\n1. 通过`MusicManager`获取一个`MusicUrlHelper`Url获取器\n2. 通过`MusicUrlHelper`的`getUrlResult`方法获取url\n3. ~~需要注意的是，由于网易云接口时常返回空回复，所以这里我通过20以内的重复次请求直到有结果就停止，如果20次以后还是没有结果（据我测试20次以内都请求到结果了），也就是返回一个空的字符串\"\"，需要使用者自己重新调用一次`urlHelper`的`getUrlResult`方法~~(2019.04.27）现在不会返回空值了，返回空值发现问题出在使用微信请求时自作聪明将json转成了a=xxxx&b=xxx的格式，导致微信不能正常转换请求数据，现在每次请求都能获取结果。\n代码实例\n\n```javascript\nconst {MusicManager} = require(\"../../NetEaseCloudMusicApi/src/MusicManager\");\n\nasync function test(){\n    // 搜索歌曲\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \"one more time one more chance\", limit: 10 });\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.nextPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.previousPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    console.log(musicSearchHelper);\n\n    // 获取歌曲url\n    let songs = await musicSearchHelper.getSearchResult();\n    let musicId  = songs[0].id;\n    let musicUrlHelper = MusicManager.getMusicUrlHelper(musicId);\n    console.log(`歌曲的ID是：${musicId}`);\n    let url = await musicUrlHelper.getUrlResult();\n    console.log(`歌曲的url链接是：${url}`);\n} \ntest();\n```\n\n![3](https://upload-images.jianshu.io/upload_images/14225973-ded0cd2b34269afe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n### 4.26更新\n\n新增搜索用户以及用户歌单获取接口\n\n#### 搜索用户\n\n1. 通过`MusicManager`获取一个`UserSearchHelper`用户查询器\n2. 通过`UserSearchHelper`的`getSearchResult()`方法获取搜索结果\n\n```javascript\nasync function test(){\n  // 搜索用户\n  let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \"JabinGP\", limit: 20 });\n  let users = await userSearchHelper.getSearchResult();\n  console.log(users);\n}\n```\n\n#### 获取用户歌单\n\n1. 通过`MusicManager`获取一个`UserListHelper`用户查询器\n2. 通过`UserListHelper`的\n    - `getILikeList()` ---获取我喜欢歌单，返回一个列表对象\n    - `getAllLists()`---获取所有歌单，返回一个列表对象的数组\n\n```javascript\nasync function test(){\n  // 搜索用户\n  let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \"JabinGP\", limit: 20 });\n  let users = await userSearchHelper.getSearchResult();\n  console.log(users);\n  \n  // 获取我喜欢歌单\n  let userListHelper = MusicManager.getUserListHelper(users[0].userId);\n  let iLikeList = await userListHelper.getILikeList()\n  console.log(iLikeList);\n }\n```\n\n#### 通过歌单里的Id获取歌曲url\n\n与前面一致，不再赘述\n\n#### 完整实例\n\n完整实例代码在项目page下的index.js中，运行项目就会自动执行输出结果。\n\n```javascript\nasync function test(){\n    // 搜索歌曲\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \"one more time one more chance\", limit: 10 });\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.nextPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    musicSearchHelper.previousPage();\n    console.log(`现在是第${musicSearchHelper.getCurrentPage()}页`);\n    console.log(await musicSearchHelper.getSearchResult());\n    console.log(musicSearchHelper);\n\n    // 获取歌曲url\n    let songs = await musicSearchHelper.getSearchResult();\n    let musicId  = songs[0].id;\n    let musicUrlHelper = MusicManager.getMusicUrlHelper(musicId);\n    console.log(`歌曲的ID是：${musicId}`);\n    let url = await musicUrlHelper.getUrlResult();\n    console.log(`歌曲的url链接是：${url}`);\n\n    // 搜索用户\n    let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \"JabinGP\", limit: 20 });\n    let users = await userSearchHelper.getSearchResult();\n    console.log(users);\n\n    // 获取用户歌单\n    let userListHelper = MusicManager.getUserListHelper(users[0].userId);\n    let iLikeList = await userListHelper.getILikeList()\n    console.log(iLikeList);\n    \n    // 获取我喜欢歌单\n    let userListDeatilHelper = MusicManager.getUserListDetailHelper(iLikeList.id);\n    let listDetail = await userListDeatilHelper.getDeatil();\n    console.log(listDetail);\n    let timer=0;\n    for(let song of listDetail.tracks){\n      musicUrlHelper.musicId=song.id;\n      console.log(`歌曲的ID是：${musicUrlHelper.musicId}`);\n      let url2 = await musicUrlHelper.getUrlResult();\n      console.log(`歌曲的url链接是：${url2}`);\n      if(timer++>20)break;\n    }\n  }   \ntest();\n```\n\n### 结尾\n\n> 2019 4.25目前就只有这两个接口，因为我们项目就只需要这两个接口，如果有需要更多接口的，可以在下方评论，以上示例代码都在Github项目上的index.js中，也就是你把文件导入微信开发者工具后，取消勾选一下详情的ES6转ES5以及取消勾选合法域名检验，就可以在控制台看到以上示例代码的输出了\n> 2019 4.26更新搜索用户和获取用户歌单以及获取歌单详细三个接口。\n\n如果对你有帮助，点个Star吧~\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"为微信小程序开发的网易云音乐api库\",\n  \"date\": \"2020-12-08T12:25:36.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"javascript\", \"小程序\", \"音乐外链\", \"网易云音乐\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u4E4B\\u524D\\u6211\\u4EEC\\u5DF2\\u7ECF\\u5F00\\u53D1\\u8FC7\\u4E00\\u6B3E\\u5C0F\\u7A0B\\u5E8F\\u9002\\u7528\\u7684qq\\u97F3\\u4E50api\\u5E93\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/FisherWY/QQMusicPlugin\"\n  }, \"https://github.com/FisherWY/QQMusicPlugin\"), \"\\u4E86\\uFF0C\\u8FD9\\u6B21\\u5F00\\u53D1\\u7F51\\u6613\\u4E91\\u97F3\\u4E50api\\u5E93\\u7684\\u539F\\u56E0\\u662Fqq\\u97F3\\u4E50api\\u5E93\\u5728\\u5C0F\\u7A0B\\u5E8F\\u4E2DiOS\\u73AF\\u5883\\u4E0B\\u65E0\\u6CD5\\u4F7F\\u7528\\u5C0F\\u7A0B\\u5E8F\\u63D0\\u4F9B\\u7684\\u80CC\\u666F\\u97F3\\u9891\\u64AD\\u653E\\u5668\\u64AD\\u653E\\u7684\\u95EE\\u9898\\n\\u7F51\\u6613\\u4E91\\u7684\\u52A0\\u5BC6\\u7B97\\u6CD5\\u771F\\u7684\\u6BD4\\u5176\\u4ED6\\u51E0\\u5BB6api\\u590D\\u6742\\u592A\\u591A\\u4E86\\u3002\\u3002\\u3002\\u5B8C\\u7206QQ\\u548C\\u9177\\u72D7\\u60F3\\u8981\\u76F4\\u63A5\\u7528\\u7684\\u8BDD\\u53EF\\u4EE5\\u5230Github\\u76F4\\u63A5\\u53D6\\u6211\\u5C01\\u88C5\\u597D\\u7684api\\u5E93\\u3002Github\\u5730\\u5740\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/JabinGP/NetEaseCloudMusicApi\"\n  }, \"https://github.com/JabinGP/NetEaseCloudMusicApi\"))), mdx(\"h3\", null, \"\\u4F9D\\u8D56\"), mdx(\"p\", null, \"\\u672Capi\\u5E93\\u53C2\\u8003\\u4E86Github\\u4E0A\\u9762\\u5F00\\u6E90\\u7684node\\u5E93\\uFF0C\\u56E0\\u4E3A\\u6211\\u4EEC\\u53EA\\u60F3\\u8981\\u67E5\\u627E\\u97F3\\u4E50\\u548C\\u64AD\\u653E\\u97F3\\u4E50\\u8FD9\\u4E24\\u4E2A\\u529F\\u80FD\\uFF0C\\u867D\\u7136Github\\u90A3\\u4E2A\\u5E93\\u5F88\\u65B9\\u4FBF\\uFF0C\\u4F46\\u662F\\u6211\\u4EEC\\u4E0D\\u60F3\\u4E3A\\u4E86\\u4E24\\u4E2A\\u63A5\\u53E3\\u7279\\u610F\\u53BB\\u8DD1\\u4E00\\u4E2Anode.js\\u670D\\u52A1\\u3002\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"big-integer.js\", mdx(\"br\", {\n    parentName: \"li\"\n  }), \"\\u8FD9\\u91CC\\u6CE8\\u610F\\uFF0C\\u4E0D\\u8981\\u4F7F\\u7528\\u6700\\u65B0\\u7248\\u7684\\uFF0C\\u6700\\u65B0\\u7248\\u7684\\u5E93\\u518D\\u6A21\\u62DF\\u5668\\u4E0A\\u8FD0\\u884C\\u6CA1\\u6709\\u95EE\\u9898\\uFF0C\\u4F46\\u662F\\u5728\\u771F\\u673A\\u8C03\\u8BD5\\u7684\\u4E0A\\u4F20\\u5305\\u9636\\u6BB5\\u4F1A\\u62A5\\u9519\\u8BF4\\u65E0\\u6CD5\\u8BC6\\u522Bbig-integer.js\\uFF0C\\u6700\\u540E\\u5728\\u6211\\u7684\\u5C1D\\u8BD5\\u4E0B\\uFF0C\\u9009\\u7528\\u4E86\\u4E00\\u4E2A\\u8001\\u7248\\u672C\\u7684\\u5E93\\u89E3\\u51B3\\u4E86\\u8FD9\\u4E2A\\u95EE\\u9898\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"crypto-js\\n\\u8FD9\\u4E2A\\u5E93\\u662F\\u7528\\u6765aes\\u52A0\\u5BC6\\u7684\\uFF0C\\u5728node\\u4E0A\\u9762\\u6709\\u4E00\\u4E2A\\u539F\\u751F\\u7684crypto\\uFF0C\\u4F46\\u662F\\u5728\\u5C0F\\u7A0B\\u5E8F\\u91CC\\u6211\\u4EEC\\u6CA1\\u6709\\uFF0C\\u6240\\u4EE5\\u6211\\u7167\\u7740Github\\u4E0A\\u7684\\u6E90\\u7801\\u4E00\\u70B9\\u4E00\\u70B9\\u7528\\u8FD9\\u4E2A\\u5E93\\u7FFB\\u8BD1\\u8FC7\\u6765\\u7684\\uFF0C\\u8FD8\\u6709Buffer\\u5728\\u5C0F\\u7A0B\\u5E8F\\u91CC\\u4E5F\\u6CA1\\u6709\\uFF0C\\u6211\\u4F7F\\u7528\\u8FD9\\u4E2A\\u5E93\\u7684\\u65B9\\u6CD5\\u4EE3\\u66FF\\u4E86\\u3002\")), mdx(\"h3\", null, \"\\u83B7\\u53D6api\\u7684\\u539F\\u7406\"), mdx(\"p\", null, \"\\u7F51\\u4E0A\\u5F88\\u591A\\u5E16\\u5B50\\u8BB2\\u7684\\u5F88\\u6E05\\u695A\\u4E86\\uFF0C\\u8FD9\\u91CC\\u63A8\\u8350\\u51E0\\u7BC7\\u6587\\u7AE0\\uFF0C\\u6211\\u53EA\\u505A\\u4E00\\u4E2A\\u7B80\\u5355\\u7684\\u603B\\u7ED3\\uFF0C\\u65B9\\u4FBF\\u5927\\u5BB6\\u7406\\u89E3\\u8FD9\\u4E2A\\u5E93\\u3002\\n\\u7F51\\u6613\\u4E91\\u7684\\u52A0\\u5BC6\\u7B97\\u6CD5\\u5927\\u6982\\u4F7F\\u7528\\u4E86\\u4E24\\u4E2A\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"AES\\u52A0\\u5BC6+BASE64\\u7F16\\u7801\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"RSA\\u52A0\\u5BC6\")), mdx(\"p\", null, \"\\u52A0\\u5BC6\\u5927\\u81F4\\u6D41\\u7A0B\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"api\\u8BF7\\u6C42\\u4FE1\\u606F\\u5148\\u88AB\\u8F6C\\u6210json\\u5B57\\u7B26\\u4E32\\u683C\\u5F0F\\uFF0C\\u7136\\u540E\\u518D\\u4F7F\\u7528\\u4E00\\u4E2A\\u56FA\\u5B9A\\u7684\\u5BC6\\u94A5aes+base64\\u7F16\\u7801\\u52A0\\u5BC6\\uFF0C\\u5F97\\u5230\\u4E86\\u7B2C\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u52A0\\u5BC6\\u7ED3\\u679Ca\"), \"\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5BA2\\u6237\\u7AEF\\u4ECE\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/\"), \"\\u968F\\u673A\\u751F\\u6210\\u4E00\\u4E2A\\u65B0\\u768416\\u4F4D\\u5BC6\\u94A5\\uFF0C\\u7136\\u540E\\u7528\\u8FD9\\u4E2A\\u5BC6\\u94A5\\u53BB\\u52A0\\u5BC6\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u52A0\\u5BC6\\u7ED3\\u679Ca\"), \"\\uFF0C\\u5F97\\u5230\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u52A0\\u5BC6\\u7ED3\\u679Cb\"), \"\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u8FD9\\u6837\\u6211\\u4EEC\\u7684\\u6570\\u636E\\u5C31\\u88AB\\u53CC\\u91CD\\u52A0\\u5BC6\\u4E86\\uFF0C\\u4F46\\u662F\\u6211\\u4EEC\\u8981\\u53D1\\u7ED9\\u670D\\u52A1\\u5668\\u53BB\\u67E5\\u8BE2\\u5BF9\\u5E94\\u7684\\u6570\\u636E\\uFF0C\\u670D\\u52A1\\u5668\\u77E5\\u9053\\u7B2C\\u4E00\\u4E2A\\u56FA\\u5B9A\\u7684\\u5BC6\\u94A5\\u662F\\u591A\\u5C11\\uFF0C\\u53EF\\u4EE5\\u89E3\\u5F00\\u7B2C\\u4E00\\u4E2A\\u52A0\\u5BC6\\u7ED3\\u679C\\uFF0C\\u4F46\\u662F\\u670D\\u52A1\\u5668\\u53EF\\u4E0D\\u77E5\\u9053\\u6211\\u4EEC\\u7B2C\\u4E8C\\u6B21\\u52A0\\u5BC6\\u7528\\u7684\\u662F\\u4EC0\\u4E48\\uFF0C\\u6240\\u4EE5\\u670D\\u52A1\\u5668\\u8FD8\\u9700\\u8981\\u5F97\\u5230\\u6211\\u4EEC\\u7684\\u7B2C\\u4E8C\\u4E2A\\u751F\\u6210\\u7684\\u968F\\u673A\\u52A0\\u5BC6\\u5BC6\\u94A5\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u7B2C\\u4E8C\\u4E2A\\u968F\\u673A\\u52A0\\u5BC6\\u5BC6\\u94A5\\u8981\\u662F\\u76F4\\u63A5\\u53D1\\u7ED9\\u670D\\u52A1\\u5668\\u597D\\u50CF\\u5C31\\u4E0D\\u592A\\u5B89\\u5168\\u4E86\\uFF0C\\u6240\\u4EE5\\u5BA2\\u6237\\u7AEF\\u5BF9\\u7B2C\\u4E8C\\u4E2A\\u968F\\u673A\\u52A0\\u5BC6\\u5BC6\\u94A5\\u4E5F\\u8FDB\\u884C\\u4E86\\u52A0\\u5BC6\\uFF0C\\u4F7F\\u7528\\u7684\\u5C31\\u662FRSA\\u52A0\\u5BC6\\uFF0C\\u52A0\\u5BC6\\u540E\\u5F97\\u5230\\u7684\\u6570\\u636E\\u6211\\u4EEC\\u79F0\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"c\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5C06\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"b\"), \"\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"c\"), \"\\u53D1\\u9001\\u7ED9\\u670D\\u52A1\\u5668\\uFF0C\\u670D\\u52A1\\u5668\\u5C31\\u4F1A\\u8FD4\\u56DE\\u7ED9\\u6211\\u4EEC\\u5BF9\\u5E94\\u7684\\u7ED3\\u679C\\u4E86\\u3002\"))), mdx(\"h3\", null, \"\\u52A0\\u5BC6\\u6838\\u5FC3\\u4EE3\\u7801\"), mdx(\"p\", null, \"\\u8FD9\\u6BB5\\u4EE3\\u7801\\u4F20\\u5165\\u5BF9\\u8C61\\u540E\\u53EF\\u4EE5\\u76F4\\u63A5\\u52A0\\u5BC6\\u6210\\u7B26\\u5408\\u7F51\\u6613\\u4E91api\\u52A0\\u5BC6\\u7684\\u7ED3\\u679C\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// \\u751F\\u6210\\u968F\\u673A\\u6570\\uFF0Csize\\u9ED8\\u8BA416\\nfunction createSecretKey(size) {\\n    const keys = \\\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\\\"\\n    let key = \\\"\\\"\\n    for (let i = 0; i < size; i++) {\\n        let pos = Math.random() * keys.length\\n        pos = Math.floor(pos)\\n        key = key + keys.charAt(pos)\\n    }\\n    return key\\n}\\n\\n\\n// aes\\u52A0\\u5BC6\\u65B9\\u6CD5\\nfunction aesEncrypt(word, secKey) {\\n    let key = CryptoJS.enc.Utf8.parse(secKey);  //\\u5341\\u516D\\u4F4D\\u5341\\u516D\\u8FDB\\u5236\\u6570\\u4F5C\\u4E3A\\u5BC6\\u94A5\\n    let iv = CryptoJS.enc.Utf8.parse(aes_mv);   //\\u5341\\u516D\\u4F4D\\u5341\\u516D\\u8FDB\\u5236\\u6570\\u4F5C\\u4E3A\\u5BC6\\u94A5\\u504F\\u79FB\\u91CF\\n    let srcs = CryptoJS.enc.Utf8.parse(word);\\n    let encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });\\n    let res = encrypted.toString();\\n    console.log(res);\\n    return res;\\n}\\n\\n// \\u586B\\u5145\\u65B9\\u6CD5\\nfunction zfill(str, size) {\\n    while (str.length < size) str = \\\"0\\\" + str\\n    return str\\n}\\n\\n// rsa\\u52A0\\u5BC6\\u65B9\\u6CD5\\nfunction rsaEncrypt(text, pubKey, modulus) {\\n    const _text = text.split('').reverse().join('')\\n    const biText = bigInt(CryptoJS.enc.Utf8.parse(_text).toString(), 16),\\n        biEx = bigInt(pubKey, 16),\\n        biMod = bigInt(modulus, 16),\\n        biRet = biText.modPow(biEx, biMod)\\n    return zfill(biRet.toString(16), 256)\\n}\\n\\n\\n// \\u52A0\\u5BC6\\u603B\\u5165\\u53E3\\nfunction Encrypt(obj) {\\n    const text = JSON.stringify(obj)\\n    const secKey = createSecretKey(16)\\n    const encText = aesEncrypt(aesEncrypt(text, nonce), secKey)\\n    const encSecKey = rsaEncrypt(secKey, pubKey, modulus)\\n    return {\\n        params: encText,\\n        encSecKey: encSecKey\\n    }\\n}\\n\")), mdx(\"h3\", null, \"\\u5C01\\u88C5\\u597D\\u7684Api\\u5E93\"), mdx(\"p\", null, \"\\u9996\\u5148\\u5230Github\\u4E0B\\u8F7D\\u6211\\u7684Api\\u5E93\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/JabinGP/NetEaseCloudMusicApi\"\n  }, \"https://github.com/JabinGP/NetEaseCloudMusicApi\\n\"), \"\\u4E0B\\u8F7D\\u5B8C\\u6210\\u540E\\uFF0C\\u8FD9\\u4E2A\\u5E93\\u5E94\\u8BE5\\u662F\\u53EF\\u4EE5\\u76F4\\u63A5\\u5BFC\\u5165\\u5FAE\\u4FE1\\u5C0F\\u7A0B\\u5E8F\\u5F00\\u53D1\\u5DE5\\u5177\\u8FD0\\u884C\\u7684\\uFF0C\\u4F46\\u662F\\u6709\\u51E0\\u4E2A\\u6CE8\\u610F\\u4E8B\\u9879:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u8FD9\\u4E2A\\u5E93\\u662F\\u7528TypeScript\\u5199\\u7684\\uFF0C\\u4F46\\u662F\\u6700\\u540E\\u7F16\\u8BD1\\u6210\\u4E86JS\\u8FD0\\u884C\\uFF0C\\u4F46\\u662F\\u7F16\\u8BD1\\u540EJS\\u4EE3\\u7801\\u53EF\\u8BFB\\u6027\\u5F88\\u5DEE\\uFF0C\\u6240\\u4EE5\\u6211\\u4FDD\\u7559\\u4E86TypeScript\\u6E90\\u6587\\u4EF6\\uFF0C\\u5C31\\u5728NetEaseCloudMusicApi/ts_src\\u91CC\\u9762\\uFF0C\\u5E94\\u7528\\u5E93\\u7684\\u65F6\\u5019\\u4E0D\\u9700\\u8981\\u4F7F\\u7528\\u5230\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5173\\u95ED\\u5C0F\\u7A0B\\u5E8F\\u5F00\\u53D1\\u5DE5\\u5177\\u7684\\u8BE6\\u60C5\\u9875\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ES6\\u8F6CES5\"), \"\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528await\\u5904\\u7406\\u5F02\\u6B65\\u8BF7\\u6C42\\uFF08\\u56E0\\u4E3A\\u5E93\\u662F\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Promise\"), \"\\u5199\\u7684\\uFF0C\\u8D77\\u7801\\u8981\\u80FD\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Promise\"), \"\\uFF0C\\u5B9E\\u4F8B\\u4EE3\\u7801\\u4F7F\\u7528\\u7684\\u662F\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"await\"), \"/\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"async\"), \"\\uFF09\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"await\\u5173\\u952E\\u5B57\\u53EA\\u80FD\\u5728async\\u4FEE\\u9970\\u8FC7\\u7684\\u51FD\\u6570\\u4F53\\u5185\\u90E8\\u4F7F\\u7528\\uFF0C\\u4E0D\\u61C2\\u7684\\u53EF\\u4EE5\\u67E5\\u4E00\\u4E0Bawait\\u548Casync\\u7684\\u7528\\u6CD5\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetEaseCloudMusicApi/Libary\"), \"\\u6587\\u4EF6\\u5939\\u91CC\\u9762\\u5305\\u542B\\u4E86\\u9879\\u76EE\\u4F9D\\u8D56\\u7684js\\u6587\\u4EF6\\uFF0C\\u5E94\\u7528\\u7684\\u65F6\\u5019\\u6700\\u597D\\u6574\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetEaseCloudMusicApi\"), \"\\u6587\\u4EF6\\u5939\\u590D\\u5236\\u5230\\u9879\\u76EE\\u91CC\\u9762\\u4F7F\\u7528\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u6D4B\\u8BD5\\u7684\\u65F6\\u5019\\u53EF\\u4EE5\\u52FE\\u9009\\u4E0D\\u6821\\u9A8C\\u5408\\u6CD5\\u57DF\\u540D\\u3002\"))), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-b53fa739408a3105.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"1\"\n  })), mdx(\"h3\", null, \"\\u5F00\\u59CB\\u4F7F\\u7528\\u4E4B\\u524D\\u7684\\u51C6\\u5907\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u627E\\u5230NetEaseCloudMusicApi\\u8FD9\\u4E2A\\u6587\\u4EF6\\u5939\\uFF0C\\u91CC\\u9762\\u5E94\\u8BE5\\u5305\\u62ECLibary\\u3001src\\u3001ts_src\\u4E09\\u4E2A\\u6587\\u4EF6\\u5939\\uFF0CLibary\\u662F\\u6211\\u5F15\\u7528\\u7684\\u5F00\\u6E90\\u5E93\\uFF0Cts_src\\u4E2D\\u662FTypeScript\\u6E90\\u6587\\u4EF6\\uFF0Csrc\\u662Fts_src\\u7F16\\u8BD1\\u540E\\u4EA7\\u751F\\u7684JavaScript\\u6587\\u4EF6\\u5939\\uFF0C\\u4E5F\\u5C31\\u662F\\u8BF4\\u4E0D\\u8003\\u8651\\u8BFBts\\u6E90\\u6587\\u4EF6\\u7684\\u8BDD\\uFF0C\\u53EF\\u4EE5\\u628Ats_src\\u5220\\u4E86\\uFF0C\\u4F46\\u662F17.4 KB \\u7684\\u5927\\u5C0F\\u5BF9\\u5E94\\u7528\\u5305\\u4F53\\u79EF\\u5E94\\u8BE5\\u6CA1\\u6709\\u4EC0\\u4E48\\u5F71\\u54CD\\u5427\\uFF0C\\u7559\\u7740\\u4E5F\\u884C\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5728\\u8981\\u4F7F\\u7528\\u5230\\u7684\\u5E93\\u4E2D\\u5982\\u4E0B\\u5F15\\u7528\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const {MusicManager} = require(\\\"../../NetEaseCloudMusicApi/src/MusicManager\\\");\\n\")), mdx(\"p\", null, \"\\u6CE8\\u610F\\u8981\\u7528\\u82B1\\u62EC\\u53F7\\u5427\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MusicManager\"), \"\\u62EC\\u8D77\\u6765\\uFF0C\\u8FD9\\u4E00\\u53E5\\u53EF\\u4EE5\\u9700\\u8981\\u53D8\\u5316\\u7684\\u5730\\u65B9\\u53EA\\u6709\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"../../NetEaseCloudMusicApi/src/MusicManager\"), \"\\u4E2D\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"../../\"), \"\\uFF0C\\u540E\\u9762\\u7684\\u8DEF\\u5F84\\u90FD\\u4EE3\\u8868\\u4E86\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetEaseCloudMusicApi\"), \"\\u6587\\u4EF6\\u5939\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetEaseCloudMusicApi\"), \"\\u91CC\\u9762\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\\uFF0C\\u56E0\\u4E3A\\u6211\\u7684\\u5E93\\u5C31\\u662F\\u8FD9\\u6837\\u7684\\u7ED3\\u6784\\uFF0C\\u6240\\u4EE5\\u4E0D\\u9700\\u8981\\u6539\\u53D8\\uFF0C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"../../\"), \"\\u5C31\\u8981\\u6839\\u636E\\u4F60\\u9879\\u76EE\\u4E2D\\u5B9E\\u9645\\u7ED3\\u6784\\u6765\\u6539\\u53D8\\u4E86\\u3002\"), mdx(\"h3\", null, \"MusicManager\"), mdx(\"p\", null, \"\\u8BE5\\u7C7B\\u6709\\u4EE5\\u4E0B\\u65B9\\u6CD5\\uFF1A\\u8BE5\\u7C7B\\u63D0\\u4F9B\\u4E86\\u6240\\u6709\\u83B7\\u53D6\\u5176\\u4ED6\\u5BF9\\u8C61\\u7684\\u65B9\\u6CD5\\uFF0C\\u53EF\\u4EE5\\u901A\\u8FC7\\u8BE5\\u7C7B\\u83B7\\u53D6\\u5176\\u4ED6\\u9700\\u8981\\u7684\\u5BF9\\u8C61\\u800C\\u4E0D\\u662Fnew\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getMusicSearchHelper()\"), \"\\n\\u9700\\u8981\\u53C2\\u6570\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"{keyword:\\\"\\u641C\\u7D22\\u6B4C\\u66F2\\u5173\\u952E\\u8BCD\\\",limit:\\u6570\\u5B57}\"), \"\\n\\u8FD4\\u56DE\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicSearchHelper\"), \"\\u641C\\u7D22\\u5668\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getMusicUrlHelper()\"), \"\\n\\u9700\\u8981\\u53C2\\u6570\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"musicId\"), \"\\uFF08\\u6570\\u5B57\\u7C7B\\u578B\\u7684\\u6B4C\\u66F2id\\uFF09\\n\\u8FD4\\u56DE\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicUrlHelper\"), \"Url\\u83B7\\u53D6\\u5668\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getUserSearchHelper()\"), \"\\n\\u9700\\u8981\\u53C2\\u6570\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"{userName:\\\"\\u641C\\u7D22\\u7528\\u6237\\u7684\\u7528\\u6237\\u540D\\u5173\\u952E\\u8BCD\\\",limit:\\u6570\\u5B57}\"), \"\\n\\u8FD4\\u56DE\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserSearchHelper\"), \"\\u7528\\u6237\\u67E5\\u8BE2\\u5668\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getUserListHelper()\"), \"\\n\\u9700\\u8981\\u53C2\\u6570\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"userId\"), \"\\uFF08\\u6570\\u5B57\\u7C7B\\u578B\\u7684\\u7528\\u6237id\\u503C\\uFF09\\n\\u8FD4\\u56DE\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserListHelper\"), \"\\u7528\\u6237\\u5217\\u8868\\u67E5\\u8BE2\\u5668\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getUserListDetailHelper()\"), \"\\n\\u9700\\u8981\\u53C2\\u6570\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"listId\"), \"\\uFF08\\u6570\\u5B57\\u7C7B\\u578B\\u7684\\u5217\\u8868id\\uFF09\\n\\u8FD4\\u56DE\\uFF1A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserListDetailHelper\"), \"\\u7528\\u6237\\u5217\\u8868\\u8BE6\\u60C5\\u4FE1\\u606F\\u83B7\\u53D6\\u5668\")), mdx(\"h3\", null, \"MusicSearchHelper\"), mdx(\"p\", null, \"\\u7528\\u4E8E\\u641C\\u7D22\\u97F3\\u4E50\\n\\u53EF\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getSearchResult()\"), \"---\\u83B7\\u53D6\\u6570\\u636E\\uFF08\\u9ED8\\u8BA4\\u7B2C\\u4E00\\u9875\\uFF09\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nextPage()\"), \"--- \\u4E0B\\u4E00\\u9875\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"previousPage()\"), \"---\\u4E0A\\u4E00\\u9875\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getCurrentPage()\"), \"---\\u67E5\\u770B\\u5F53\\u524D\\u9875\\u6570\\u7684\")), mdx(\"p\", null, \"\\u6267\\u884C\\u5B8C\\u5207\\u6362\\u9875\\u6570\\u540E\\u9700\\u8981\\u518D\\u6B21\\u8C03\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getSearchResult\"), \"\\u65B9\\u6CD5\\u67E5\\u770B\\u65B0\\u7684\\u67E5\\u8BE2\\u7ED3\\u679C\\u3002\"), mdx(\"h3\", null, \"MusicUrlHelper\"), mdx(\"p\", null, \"\\u7528\\u4E8E\\u5C06\\u641C\\u7D22\\u97F3\\u4E50\\u7ED3\\u679C\\u4E2D\\u7684id\\u8F6C\\u6362\\u4E3Aurl\\u64AD\\u653E\\u94FE\\u63A5\\n\\u53EF\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getUrlResult()\"), \" ---\\u83B7\\u53D6url\\u64AD\\u653E\\u94FE\\u63A5\")), mdx(\"h3\", null, \"UserSearchHelper\"), mdx(\"p\", null, \"\\u7528\\u4E8E\\u6839\\u636E\\u7528\\u6237\\u540D\\u5173\\u952E\\u5B57\\u641C\\u7D22\\u7528\\u6237\\n\\u53EF\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getSearchResult()\"), \"---\\u83B7\\u53D6\\u641C\\u7D22\\u7ED3\\u679C\")), mdx(\"h3\", null, \"UserListHelper\"), mdx(\"p\", null, \"\\u7528\\u4E8E\\u83B7\\u53D6\\u7528\\u6237id\\u540E\\u6839\\u636Eid\\u83B7\\u53D6\\u7528\\u6237\\u6B4C\\u5355\\u4FE1\\u606F\\n\\u53EF\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getAllLists()\"), \"---\\u83B7\\u53D6\\u7528\\u6237\\u6240\\u6709\\u6B4C\\u5355\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getILikeList()\"), \"---\\u83B7\\u53D6\\u7528\\u6237\\u7684\\u6211\\u559C\\u6B22\\u6B4C\\u5355\")), mdx(\"h3\", null, \"UserListDetailHelper\"), mdx(\"p\", null, \"\\u7528\\u4E8E\\u83B7\\u53D6\\u6B4C\\u5355id\\u540E\\u83B7\\u53D6\\u6B4C\\u5355\\u5185\\u6B4C\\u66F2\\u5217\\u8868\\n\\u53EF\\u7528\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getDeatil()\"), \"---\\u83B7\\u53D6\\u6B4C\\u5355\\u5185\\u5217\\u8868\")), mdx(\"h3\", null, \"\\u641C\\u7D22\\u6B4C\\u66F2\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MusicManager\"), \"\\u83B7\\u53D6\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MusicSearchHelper\"), \"\\u641C\\u7D22\\u5668\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MusicSearchHelper\"), \"\\u7684\\u65B9\\u6CD5\\uFF1A\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getSearchResult()\"), \"---\\u83B7\\u53D6\\u6570\\u636E\\uFF08\\u9ED8\\u8BA4\\u7B2C\\u4E00\\u9875\\uFF09\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nextPage()\"), \"--- \\u4E0B\\u4E00\\u9875\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"previousPage()\"), \"---\\u4E0A\\u4E00\\u9875\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getCurrentPage()\"), \"---\\u67E5\\u770B\\u5F53\\u524D\\u9875\\u6570\\u7684\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u6267\\u884C\\u5B8C\\u5207\\u6362\\u9875\\u6570\\u540E\\u9700\\u8981\\u518D\\u6B21\\u8C03\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getSearchResult\"), \"\\u65B9\\u6CD5\\u67E5\\u770B\\u65B0\\u7684\\u67E5\\u8BE2\\u7ED3\\u679C\\u3002\"))), mdx(\"p\", null, \"\\u4EE3\\u7801\\u5B9E\\u4F8B\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"const {MusicManager} = require(\\\"../../NetEaseCloudMusicApi/src/MusicManager\\\");\\nasync function test(){\\n     // \\u641C\\u7D22\\u6B4C\\u66F2\\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \\\"one more time one more chance\\\", limit: 10 });\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.nextPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.previousPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    console.log(musicSearchHelper);\\n} \\ntest();\\n\")), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-0977450d4401c36b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"2\"\n  })), mdx(\"h3\", null, \"\\u901A\\u8FC7\\u641C\\u7D22\\u6B4C\\u66F2\\u7684\\u7ED3\\u679C\\u83B7\\u53D6\\u97F3\\u4E50Url\"), mdx(\"p\", null, \"\\u6709\\u4E86\\u641C\\u7D22\\u7ED3\\u679C\\uFF0C\\u6211\\u4EEC\\u8FD8\\u9700\\u8981url\\u624D\\u80FD\\u64AD\\u653E\\u8D44\\u6E90\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicManager\"), \"\\u83B7\\u53D6\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicUrlHelper\"), \"Url\\u83B7\\u53D6\\u5668\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicUrlHelper\"), \"\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getUrlResult\"), \"\\u65B9\\u6CD5\\u83B7\\u53D6url\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"del\", {\n    parentName: \"li\"\n  }, \"\\u9700\\u8981\\u6CE8\\u610F\\u7684\\u662F\\uFF0C\\u7531\\u4E8E\\u7F51\\u6613\\u4E91\\u63A5\\u53E3\\u65F6\\u5E38\\u8FD4\\u56DE\\u7A7A\\u56DE\\u590D\\uFF0C\\u6240\\u4EE5\\u8FD9\\u91CC\\u6211\\u901A\\u8FC720\\u4EE5\\u5185\\u7684\\u91CD\\u590D\\u6B21\\u8BF7\\u6C42\\u76F4\\u5230\\u6709\\u7ED3\\u679C\\u5C31\\u505C\\u6B62\\uFF0C\\u5982\\u679C20\\u6B21\\u4EE5\\u540E\\u8FD8\\u662F\\u6CA1\\u6709\\u7ED3\\u679C\\uFF08\\u636E\\u6211\\u6D4B\\u8BD520\\u6B21\\u4EE5\\u5185\\u90FD\\u8BF7\\u6C42\\u5230\\u7ED3\\u679C\\u4E86\\uFF09\\uFF0C\\u4E5F\\u5C31\\u662F\\u8FD4\\u56DE\\u4E00\\u4E2A\\u7A7A\\u7684\\u5B57\\u7B26\\u4E32\\\"\\\"\\uFF0C\\u9700\\u8981\\u4F7F\\u7528\\u8005\\u81EA\\u5DF1\\u91CD\\u65B0\\u8C03\\u7528\\u4E00\\u6B21\", mdx(\"inlineCode\", {\n    parentName: \"del\"\n  }, \"urlHelper\"), \"\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"del\"\n  }, \"getUrlResult\"), \"\\u65B9\\u6CD5\"), \"(2019.04.27\\uFF09\\u73B0\\u5728\\u4E0D\\u4F1A\\u8FD4\\u56DE\\u7A7A\\u503C\\u4E86\\uFF0C\\u8FD4\\u56DE\\u7A7A\\u503C\\u53D1\\u73B0\\u95EE\\u9898\\u51FA\\u5728\\u4F7F\\u7528\\u5FAE\\u4FE1\\u8BF7\\u6C42\\u65F6\\u81EA\\u4F5C\\u806A\\u660E\\u5C06json\\u8F6C\\u6210\\u4E86a=xxxx&b=xxx\\u7684\\u683C\\u5F0F\\uFF0C\\u5BFC\\u81F4\\u5FAE\\u4FE1\\u4E0D\\u80FD\\u6B63\\u5E38\\u8F6C\\u6362\\u8BF7\\u6C42\\u6570\\u636E\\uFF0C\\u73B0\\u5728\\u6BCF\\u6B21\\u8BF7\\u6C42\\u90FD\\u80FD\\u83B7\\u53D6\\u7ED3\\u679C\\u3002\\n\\u4EE3\\u7801\\u5B9E\\u4F8B\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"const {MusicManager} = require(\\\"../../NetEaseCloudMusicApi/src/MusicManager\\\");\\n\\nasync function test(){\\n    // \\u641C\\u7D22\\u6B4C\\u66F2\\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \\\"one more time one more chance\\\", limit: 10 });\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.nextPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.previousPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    console.log(musicSearchHelper);\\n\\n    // \\u83B7\\u53D6\\u6B4C\\u66F2url\\n    let songs = await musicSearchHelper.getSearchResult();\\n    let musicId  = songs[0].id;\\n    let musicUrlHelper = MusicManager.getMusicUrlHelper(musicId);\\n    console.log(`\\u6B4C\\u66F2\\u7684ID\\u662F\\uFF1A${musicId}`);\\n    let url = await musicUrlHelper.getUrlResult();\\n    console.log(`\\u6B4C\\u66F2\\u7684url\\u94FE\\u63A5\\u662F\\uFF1A${url}`);\\n} \\ntest();\\n\")), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://upload-images.jianshu.io/upload_images/14225973-ded0cd2b34269afe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\",\n    \"alt\": \"3\"\n  })), mdx(\"h3\", null, \"4.26\\u66F4\\u65B0\"), mdx(\"p\", null, \"\\u65B0\\u589E\\u641C\\u7D22\\u7528\\u6237\\u4EE5\\u53CA\\u7528\\u6237\\u6B4C\\u5355\\u83B7\\u53D6\\u63A5\\u53E3\"), mdx(\"h4\", null, \"\\u641C\\u7D22\\u7528\\u6237\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicManager\"), \"\\u83B7\\u53D6\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserSearchHelper\"), \"\\u7528\\u6237\\u67E5\\u8BE2\\u5668\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserSearchHelper\"), \"\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getSearchResult()\"), \"\\u65B9\\u6CD5\\u83B7\\u53D6\\u641C\\u7D22\\u7ED3\\u679C\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"async function test(){\\n  // \\u641C\\u7D22\\u7528\\u6237\\n  let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \\\"JabinGP\\\", limit: 20 });\\n  let users = await userSearchHelper.getSearchResult();\\n  console.log(users);\\n}\\n\")), mdx(\"h4\", null, \"\\u83B7\\u53D6\\u7528\\u6237\\u6B4C\\u5355\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MusicManager\"), \"\\u83B7\\u53D6\\u4E00\\u4E2A\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserListHelper\"), \"\\u7528\\u6237\\u67E5\\u8BE2\\u5668\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"UserListHelper\"), \"\\u7684\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getILikeList()\"), \" ---\\u83B7\\u53D6\\u6211\\u559C\\u6B22\\u6B4C\\u5355\\uFF0C\\u8FD4\\u56DE\\u4E00\\u4E2A\\u5217\\u8868\\u5BF9\\u8C61\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getAllLists()\"), \"---\\u83B7\\u53D6\\u6240\\u6709\\u6B4C\\u5355\\uFF0C\\u8FD4\\u56DE\\u4E00\\u4E2A\\u5217\\u8868\\u5BF9\\u8C61\\u7684\\u6570\\u7EC4\")))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"async function test(){\\n  // \\u641C\\u7D22\\u7528\\u6237\\n  let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \\\"JabinGP\\\", limit: 20 });\\n  let users = await userSearchHelper.getSearchResult();\\n  console.log(users);\\n  \\n  // \\u83B7\\u53D6\\u6211\\u559C\\u6B22\\u6B4C\\u5355\\n  let userListHelper = MusicManager.getUserListHelper(users[0].userId);\\n  let iLikeList = await userListHelper.getILikeList()\\n  console.log(iLikeList);\\n }\\n\")), mdx(\"h4\", null, \"\\u901A\\u8FC7\\u6B4C\\u5355\\u91CC\\u7684Id\\u83B7\\u53D6\\u6B4C\\u66F2url\"), mdx(\"p\", null, \"\\u4E0E\\u524D\\u9762\\u4E00\\u81F4\\uFF0C\\u4E0D\\u518D\\u8D58\\u8FF0\"), mdx(\"h4\", null, \"\\u5B8C\\u6574\\u5B9E\\u4F8B\"), mdx(\"p\", null, \"\\u5B8C\\u6574\\u5B9E\\u4F8B\\u4EE3\\u7801\\u5728\\u9879\\u76EEpage\\u4E0B\\u7684index.js\\u4E2D\\uFF0C\\u8FD0\\u884C\\u9879\\u76EE\\u5C31\\u4F1A\\u81EA\\u52A8\\u6267\\u884C\\u8F93\\u51FA\\u7ED3\\u679C\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"async function test(){\\n    // \\u641C\\u7D22\\u6B4C\\u66F2\\n    let musicSearchHelper = MusicManager.getMusicSearchHelper({ keyword: \\\"one more time one more chance\\\", limit: 10 });\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.nextPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    musicSearchHelper.previousPage();\\n    console.log(`\\u73B0\\u5728\\u662F\\u7B2C${musicSearchHelper.getCurrentPage()}\\u9875`);\\n    console.log(await musicSearchHelper.getSearchResult());\\n    console.log(musicSearchHelper);\\n\\n    // \\u83B7\\u53D6\\u6B4C\\u66F2url\\n    let songs = await musicSearchHelper.getSearchResult();\\n    let musicId  = songs[0].id;\\n    let musicUrlHelper = MusicManager.getMusicUrlHelper(musicId);\\n    console.log(`\\u6B4C\\u66F2\\u7684ID\\u662F\\uFF1A${musicId}`);\\n    let url = await musicUrlHelper.getUrlResult();\\n    console.log(`\\u6B4C\\u66F2\\u7684url\\u94FE\\u63A5\\u662F\\uFF1A${url}`);\\n\\n    // \\u641C\\u7D22\\u7528\\u6237\\n    let userSearchHelper = MusicManager.getUserSearchHelper({ userName: \\\"JabinGP\\\", limit: 20 });\\n    let users = await userSearchHelper.getSearchResult();\\n    console.log(users);\\n\\n    // \\u83B7\\u53D6\\u7528\\u6237\\u6B4C\\u5355\\n    let userListHelper = MusicManager.getUserListHelper(users[0].userId);\\n    let iLikeList = await userListHelper.getILikeList()\\n    console.log(iLikeList);\\n    \\n    // \\u83B7\\u53D6\\u6211\\u559C\\u6B22\\u6B4C\\u5355\\n    let userListDeatilHelper = MusicManager.getUserListDetailHelper(iLikeList.id);\\n    let listDetail = await userListDeatilHelper.getDeatil();\\n    console.log(listDetail);\\n    let timer=0;\\n    for(let song of listDetail.tracks){\\n      musicUrlHelper.musicId=song.id;\\n      console.log(`\\u6B4C\\u66F2\\u7684ID\\u662F\\uFF1A${musicUrlHelper.musicId}`);\\n      let url2 = await musicUrlHelper.getUrlResult();\\n      console.log(`\\u6B4C\\u66F2\\u7684url\\u94FE\\u63A5\\u662F\\uFF1A${url2}`);\\n      if(timer++>20)break;\\n    }\\n  }   \\ntest();\\n\")), mdx(\"h3\", null, \"\\u7ED3\\u5C3E\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"2019 4.25\\u76EE\\u524D\\u5C31\\u53EA\\u6709\\u8FD9\\u4E24\\u4E2A\\u63A5\\u53E3\\uFF0C\\u56E0\\u4E3A\\u6211\\u4EEC\\u9879\\u76EE\\u5C31\\u53EA\\u9700\\u8981\\u8FD9\\u4E24\\u4E2A\\u63A5\\u53E3\\uFF0C\\u5982\\u679C\\u6709\\u9700\\u8981\\u66F4\\u591A\\u63A5\\u53E3\\u7684\\uFF0C\\u53EF\\u4EE5\\u5728\\u4E0B\\u65B9\\u8BC4\\u8BBA\\uFF0C\\u4EE5\\u4E0A\\u793A\\u4F8B\\u4EE3\\u7801\\u90FD\\u5728Github\\u9879\\u76EE\\u4E0A\\u7684index.js\\u4E2D\\uFF0C\\u4E5F\\u5C31\\u662F\\u4F60\\u628A\\u6587\\u4EF6\\u5BFC\\u5165\\u5FAE\\u4FE1\\u5F00\\u53D1\\u8005\\u5DE5\\u5177\\u540E\\uFF0C\\u53D6\\u6D88\\u52FE\\u9009\\u4E00\\u4E0B\\u8BE6\\u60C5\\u7684ES6\\u8F6CES5\\u4EE5\\u53CA\\u53D6\\u6D88\\u52FE\\u9009\\u5408\\u6CD5\\u57DF\\u540D\\u68C0\\u9A8C\\uFF0C\\u5C31\\u53EF\\u4EE5\\u5728\\u63A7\\u5236\\u53F0\\u770B\\u5230\\u4EE5\\u4E0A\\u793A\\u4F8B\\u4EE3\\u7801\\u7684\\u8F93\\u51FA\\u4E86\\n2019 4.26\\u66F4\\u65B0\\u641C\\u7D22\\u7528\\u6237\\u548C\\u83B7\\u53D6\\u7528\\u6237\\u6B4C\\u5355\\u4EE5\\u53CA\\u83B7\\u53D6\\u6B4C\\u5355\\u8BE6\\u7EC6\\u4E09\\u4E2A\\u63A5\\u53E3\\u3002\")), mdx(\"p\", null, \"\\u5982\\u679C\\u5BF9\\u4F60\\u6709\\u5E2E\\u52A9\\uFF0C\\u70B9\\u4E2AStar\\u5427~\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"之前我们已经开发过一款小程序适用的qq音乐api库 https://github.com/FisherWY/QQMusicPlugin 了，这次开发网易云音乐api库的原因是qq音乐api库在小程序中iOS环境下无法使用小程序提供的背景音频播放器播放的问题\n网易云的加密算法真的比其他几家api复杂太多了。。。完爆QQ…","frontmatter":{"date":"2020-12-08 12:25","title":"为微信小程序开发的网易云音乐api库","draft":false}},{"id":"fbc389e2-6d70-5eea-b189-712d81c37081","slug":"posts/code/os-fd","rawBody":"---\ntitle: \"操作系统系列之——文件描述符\"\ndate: 2021-01-14T21:33:56+08:00\ndraft: false\n---\n\n注：以下的 Unix 泛指 Unix 、 Linux 、 macOS 等系统。\n\n## 一切皆文件\n\n在 Unix 中有一种简单而实用的哲学叫做 *一切皆文件* ：文件是文件、设备是文件......\n\n## 打开是第一步\n\n一个实实在在的普通文件在使用之前必须要经过一个叫做 **打开** 的过程，通常在程序中表现为 `open()` 函数调用的形式，文件必须先被打开的原因是系统需要把文件属性和磁盘地址表装入内存以便于后续的快速访问。\n\n## 返回凭证\n\n文件在成功打开后，系统会返回一个 **非负整数** 作为文件的描述符，文件描述符将作为引用该文件的一个凭证，例如后续对该文件的读或写操作则需要将文件描述符传递给 `read()` 或 `write()` 函数。\n\n## 文件描述符的一些属性\n\n按照惯例，UNIX 系统 shell 使用文件描述 0 关联进程的标准输入、 1 关联标准输出、 2 关联标准错误输出。这是各种 shell 以及很多应用程序使用的管理，并非 UNIX 内核强制要求，但如果不遵照这个惯例，很多 UNIX 系统引用程序就并无法正常工作。\n\n// TODO: POSIX 标准\n\n在遵从 POSIX 标准的应用程序中，与标准输入、标准输出、标准错误输出想关的 0 、 1 、 2 、应该使用被定义在头文件 `<unistd.h>` 的符号常量 `STDIN_FILENO` 、 `STDOUT_FILENO` 、 `STDERR_FILENO` 来替换。\n\n## 文件描述符的服务对象\n\n文件描述符的产生归根结底是因为 **进程需要使用** 某个文件，因此文件描述符的诞生就是为了进程而服务的。\n\n因为文件描述符的针对的对象是进程，因此每个进程的文件描述符都是独立的，相同的数字在不同的进程之间的所代表的文件可以是不同的，例如同一个文件描述符 4 在 `进程1` 中代表 `文件a`，而在 `进程2` 中代表 `文件b` 。\n\n## 文件描述符的取值范围\n\n如上所述，文件描述符本质上就是一个用来标识文件的 **非负整数** ，而文件描述符范围是 [ 0, `OPEN_MAX` ] 。\n\n早期的 UNIX 系统实现采用的上限是 19 （即 [0, 19] 共 20 个取值），这意味着一个进程至多只能同时使用 20 个文件秒描述符，当需要操作的文件过多时，这可能会产生一些麻烦，但现在的操作系统已经增加至上万了，基本不存在文件描述符用完的困扰。\n\n有关 `OPEN_MAX` 的详细，可以参考 [获取进程能打开的最大文件数量【OPEN_MAX】](https://blog.csdn.net/CMbug/article/details/48313107)。\n\n## 参考\n\n- *《现代操作系统（第四版）》*\n- *《Unix环境高级编程（第四版）》*\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"操作系统系列之——文件描述符\",\n  \"date\": \"2021-01-14T13:33:56.000Z\",\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u6CE8\\uFF1A\\u4EE5\\u4E0B\\u7684 Unix \\u6CDB\\u6307 Unix \\u3001 Linux \\u3001 macOS \\u7B49\\u7CFB\\u7EDF\\u3002\"), mdx(\"h2\", null, \"\\u4E00\\u5207\\u7686\\u6587\\u4EF6\"), mdx(\"p\", null, \"\\u5728 Unix \\u4E2D\\u6709\\u4E00\\u79CD\\u7B80\\u5355\\u800C\\u5B9E\\u7528\\u7684\\u54F2\\u5B66\\u53EB\\u505A \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u4E00\\u5207\\u7686\\u6587\\u4EF6\"), \" \\uFF1A\\u6587\\u4EF6\\u662F\\u6587\\u4EF6\\u3001\\u8BBE\\u5907\\u662F\\u6587\\u4EF6......\"), mdx(\"h2\", null, \"\\u6253\\u5F00\\u662F\\u7B2C\\u4E00\\u6B65\"), mdx(\"p\", null, \"\\u4E00\\u4E2A\\u5B9E\\u5B9E\\u5728\\u5728\\u7684\\u666E\\u901A\\u6587\\u4EF6\\u5728\\u4F7F\\u7528\\u4E4B\\u524D\\u5FC5\\u987B\\u8981\\u7ECF\\u8FC7\\u4E00\\u4E2A\\u53EB\\u505A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6253\\u5F00\"), \" \\u7684\\u8FC7\\u7A0B\\uFF0C\\u901A\\u5E38\\u5728\\u7A0B\\u5E8F\\u4E2D\\u8868\\u73B0\\u4E3A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"open()\"), \" \\u51FD\\u6570\\u8C03\\u7528\\u7684\\u5F62\\u5F0F\\uFF0C\\u6587\\u4EF6\\u5FC5\\u987B\\u5148\\u88AB\\u6253\\u5F00\\u7684\\u539F\\u56E0\\u662F\\u7CFB\\u7EDF\\u9700\\u8981\\u628A\\u6587\\u4EF6\\u5C5E\\u6027\\u548C\\u78C1\\u76D8\\u5730\\u5740\\u8868\\u88C5\\u5165\\u5185\\u5B58\\u4EE5\\u4FBF\\u4E8E\\u540E\\u7EED\\u7684\\u5FEB\\u901F\\u8BBF\\u95EE\\u3002\"), mdx(\"h2\", null, \"\\u8FD4\\u56DE\\u51ED\\u8BC1\"), mdx(\"p\", null, \"\\u6587\\u4EF6\\u5728\\u6210\\u529F\\u6253\\u5F00\\u540E\\uFF0C\\u7CFB\\u7EDF\\u4F1A\\u8FD4\\u56DE\\u4E00\\u4E2A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u975E\\u8D1F\\u6574\\u6570\"), \" \\u4F5C\\u4E3A\\u6587\\u4EF6\\u7684\\u63CF\\u8FF0\\u7B26\\uFF0C\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u5C06\\u4F5C\\u4E3A\\u5F15\\u7528\\u8BE5\\u6587\\u4EF6\\u7684\\u4E00\\u4E2A\\u51ED\\u8BC1\\uFF0C\\u4F8B\\u5982\\u540E\\u7EED\\u5BF9\\u8BE5\\u6587\\u4EF6\\u7684\\u8BFB\\u6216\\u5199\\u64CD\\u4F5C\\u5219\\u9700\\u8981\\u5C06\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u4F20\\u9012\\u7ED9 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"read()\"), \" \\u6216 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"write()\"), \" \\u51FD\\u6570\\u3002\"), mdx(\"h2\", null, \"\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u4E00\\u4E9B\\u5C5E\\u6027\"), mdx(\"p\", null, \"\\u6309\\u7167\\u60EF\\u4F8B\\uFF0CUNIX \\u7CFB\\u7EDF shell \\u4F7F\\u7528\\u6587\\u4EF6\\u63CF\\u8FF0 0 \\u5173\\u8054\\u8FDB\\u7A0B\\u7684\\u6807\\u51C6\\u8F93\\u5165\\u3001 1 \\u5173\\u8054\\u6807\\u51C6\\u8F93\\u51FA\\u3001 2 \\u5173\\u8054\\u6807\\u51C6\\u9519\\u8BEF\\u8F93\\u51FA\\u3002\\u8FD9\\u662F\\u5404\\u79CD shell \\u4EE5\\u53CA\\u5F88\\u591A\\u5E94\\u7528\\u7A0B\\u5E8F\\u4F7F\\u7528\\u7684\\u7BA1\\u7406\\uFF0C\\u5E76\\u975E UNIX \\u5185\\u6838\\u5F3A\\u5236\\u8981\\u6C42\\uFF0C\\u4F46\\u5982\\u679C\\u4E0D\\u9075\\u7167\\u8FD9\\u4E2A\\u60EF\\u4F8B\\uFF0C\\u5F88\\u591A UNIX \\u7CFB\\u7EDF\\u5F15\\u7528\\u7A0B\\u5E8F\\u5C31\\u5E76\\u65E0\\u6CD5\\u6B63\\u5E38\\u5DE5\\u4F5C\\u3002\"), mdx(\"p\", null, \"// TODO: POSIX \\u6807\\u51C6\"), mdx(\"p\", null, \"\\u5728\\u9075\\u4ECE POSIX \\u6807\\u51C6\\u7684\\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\uFF0C\\u4E0E\\u6807\\u51C6\\u8F93\\u5165\\u3001\\u6807\\u51C6\\u8F93\\u51FA\\u3001\\u6807\\u51C6\\u9519\\u8BEF\\u8F93\\u51FA\\u60F3\\u5173\\u7684 0 \\u3001 1 \\u3001 2 \\u3001\\u5E94\\u8BE5\\u4F7F\\u7528\\u88AB\\u5B9A\\u4E49\\u5728\\u5934\\u6587\\u4EF6 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<unistd.h>\"), \" \\u7684\\u7B26\\u53F7\\u5E38\\u91CF \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"STDIN_FILENO\"), \" \\u3001 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"STDOUT_FILENO\"), \" \\u3001 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"STDERR_FILENO\"), \" \\u6765\\u66FF\\u6362\\u3002\"), mdx(\"h2\", null, \"\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u670D\\u52A1\\u5BF9\\u8C61\"), mdx(\"p\", null, \"\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u4EA7\\u751F\\u5F52\\u6839\\u7ED3\\u5E95\\u662F\\u56E0\\u4E3A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8FDB\\u7A0B\\u9700\\u8981\\u4F7F\\u7528\"), \" \\u67D0\\u4E2A\\u6587\\u4EF6\\uFF0C\\u56E0\\u6B64\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u8BDE\\u751F\\u5C31\\u662F\\u4E3A\\u4E86\\u8FDB\\u7A0B\\u800C\\u670D\\u52A1\\u7684\\u3002\"), mdx(\"p\", null, \"\\u56E0\\u4E3A\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u9488\\u5BF9\\u7684\\u5BF9\\u8C61\\u662F\\u8FDB\\u7A0B\\uFF0C\\u56E0\\u6B64\\u6BCF\\u4E2A\\u8FDB\\u7A0B\\u7684\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u90FD\\u662F\\u72EC\\u7ACB\\u7684\\uFF0C\\u76F8\\u540C\\u7684\\u6570\\u5B57\\u5728\\u4E0D\\u540C\\u7684\\u8FDB\\u7A0B\\u4E4B\\u95F4\\u7684\\u6240\\u4EE3\\u8868\\u7684\\u6587\\u4EF6\\u53EF\\u4EE5\\u662F\\u4E0D\\u540C\\u7684\\uFF0C\\u4F8B\\u5982\\u540C\\u4E00\\u4E2A\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26 4 \\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u8FDB\\u7A0B1\"), \" \\u4E2D\\u4EE3\\u8868 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u6587\\u4EF6a\"), \"\\uFF0C\\u800C\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u8FDB\\u7A0B2\"), \" \\u4E2D\\u4EE3\\u8868 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u6587\\u4EF6b\"), \" \\u3002\"), mdx(\"h2\", null, \"\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7684\\u53D6\\u503C\\u8303\\u56F4\"), mdx(\"p\", null, \"\\u5982\\u4E0A\\u6240\\u8FF0\\uFF0C\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u672C\\u8D28\\u4E0A\\u5C31\\u662F\\u4E00\\u4E2A\\u7528\\u6765\\u6807\\u8BC6\\u6587\\u4EF6\\u7684 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u975E\\u8D1F\\u6574\\u6570\"), \" \\uFF0C\\u800C\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u8303\\u56F4\\u662F \", \"[ 0, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OPEN_MAX\"), \" ]\", \" \\u3002\"), mdx(\"p\", null, \"\\u65E9\\u671F\\u7684 UNIX \\u7CFB\\u7EDF\\u5B9E\\u73B0\\u91C7\\u7528\\u7684\\u4E0A\\u9650\\u662F 19 \\uFF08\\u5373 \", \"[0, 19]\", \" \\u5171 20 \\u4E2A\\u53D6\\u503C\\uFF09\\uFF0C\\u8FD9\\u610F\\u5473\\u7740\\u4E00\\u4E2A\\u8FDB\\u7A0B\\u81F3\\u591A\\u53EA\\u80FD\\u540C\\u65F6\\u4F7F\\u7528 20 \\u4E2A\\u6587\\u4EF6\\u79D2\\u63CF\\u8FF0\\u7B26\\uFF0C\\u5F53\\u9700\\u8981\\u64CD\\u4F5C\\u7684\\u6587\\u4EF6\\u8FC7\\u591A\\u65F6\\uFF0C\\u8FD9\\u53EF\\u80FD\\u4F1A\\u4EA7\\u751F\\u4E00\\u4E9B\\u9EBB\\u70E6\\uFF0C\\u4F46\\u73B0\\u5728\\u7684\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u5DF2\\u7ECF\\u589E\\u52A0\\u81F3\\u4E0A\\u4E07\\u4E86\\uFF0C\\u57FA\\u672C\\u4E0D\\u5B58\\u5728\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7528\\u5B8C\\u7684\\u56F0\\u6270\\u3002\"), mdx(\"p\", null, \"\\u6709\\u5173 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OPEN_MAX\"), \" \\u7684\\u8BE6\\u7EC6\\uFF0C\\u53EF\\u4EE5\\u53C2\\u8003 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.csdn.net/CMbug/article/details/48313107\"\n  }, \"\\u83B7\\u53D6\\u8FDB\\u7A0B\\u80FD\\u6253\\u5F00\\u7684\\u6700\\u5927\\u6587\\u4EF6\\u6570\\u91CF\\u3010OPEN_MAX\\u3011\"), \"\\u3002\"), mdx(\"h2\", null, \"\\u53C2\\u8003\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"\\u300A\\u73B0\\u4EE3\\u64CD\\u4F5C\\u7CFB\\u7EDF\\uFF08\\u7B2C\\u56DB\\u7248\\uFF09\\u300B\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"\\u300AUnix\\u73AF\\u5883\\u9AD8\\u7EA7\\u7F16\\u7A0B\\uFF08\\u7B2C\\u56DB\\u7248\\uFF09\\u300B\"))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"注：以下的 Unix 泛指 Unix 、 Linux 、 macOS 等系统。 一切皆文件 在 Unix 中有一种简单而实用的哲学叫做  一切皆文件  ：文件是文件、设备是文件...... 打开是第一步 一个实实在在的普通文件在使用之前必须要经过一个叫做  打开  的过程，通常在程序中表现为  open…","frontmatter":{"date":"2021-01-14 13:33","title":"操作系统系列之——文件描述符","draft":false}},{"id":"461be4c7-adf5-5849-8802-ad756a01d00e","slug":"posts/code/os-process","rawBody":"---\ntitle: \"操作系统系列之——进程\"\ndate: 2020-12-22T21:24:06+08:00\ntags: [\"os\", \"process\", \"c\"]\ncategories: [\"code\"]\ndraft: false\n---\n\n## 说明\n\n注意，在阅读这篇文章之前，请确保你已经具备以下文章中的知识：\n\n- [操作系统系列之——程序](/posts/code/os-program/)\n\n本篇文章试图让你感受到进程与程序的区别，较为深入的细节将留在后续的文章中。\n\n<!-- - [操作系统系列之——深入进程](https://blog.jabingp.cn//posts/code/linux-program/) -->\n\n## 什么是进程\n\n> 进程本质上是正在执行的一个程序，是对正在运行程序的一个抽象。——《现代操作系统》\n\n在[操作系统系列之——程序](https://blog.jabingp.cn//posts/code/linux-program/)中，我们通过 C 语言和 gcc 编译器得到了一个被存放在硬盘中的程序 `a.out` ，当它被计算机执行时就会产生一个进程。\n\n## 执行一个程序就会产生进程\n\n直接在`a.out`所在目录通过相对路径执行这个程序，可以看到程序运行并将字符输出到了控制台中：\n\n> 其中`➜  c`是命令提示符，请忽略该部分，关注提示符后面的内容。\n\n```bash\n➜  c ./a.out\nHelloWorld!                                                                                                 \n```\n\n可以看到程序中的 `printf` 被输出到当前的控制台中，说明程序确实被执行了，但这样似乎还无法证明在这个过程中有 **进程** 产生。为了证明进程的存在，我们需要做个小实验。\n\n## 进程的小实验\n\n> 再次强调，以下代码适用于类Unix系统，不同操作系统之间需要使用的库和编译工具会有所不同。\n\n首先改造一下我们的经典 HelloWorld ，引入了`unistd`来实现睡眠一段时间，我们编写程序让屏幕每隔`4s`输出一条 **带有编号的HelloWorld** ，且限制一共输出三条。\n\n```c\n#include <stdio.h>\n#include <unistd.h>\n#define SLEEP_SECONDS 4\nint main(){\n    for(int i=0; i < 3; i++){\n        sleep(SLEEP_SECONDS);\n        printf(\"No.%d: HelloWorld!\\n\",i);\n    }\n    return 0;\n}\n```\n\n编译并运行，结果是符合预期的，同时注意结果中的命令提示符 `➜  c` ，它在程序执行完毕后才出现：\n\n```bash\n➜  c ./a.out\nNo.0: HelloWorld!\nNo.1: HelloWorld!\nNo.2: HelloWorld!\n➜  c\n```\n\n为了达到实验的效果，我们需要用到 `&` 这个符号，在命令的结尾加上 `&` 则可以实现在后台运行该命令，这样我们就无需等待程序运行完毕，命令提示符会马上出现。\n\n尝试一下加上`&`会有什么变化：\n\n```bash\n➜  c ./a.out &\n[1] 63965\n➜  c No.0: HelloWorld!\nNo.1: HelloWorld!\nNo.2: HelloWorld!\n\n[1]  + 63965 done       ./a.out\n➜  c\n```\n\n可以看到加上 & 后没有等待 a.out 的执行结束而直接输出了 `[1] 63965`（其实这就是进程的 pid ），并且 **命令提示符** 马上出现，这意味着我们可以直接进行下一步的操作而不用等待 a.out 运行完毕， a.out 的运行结果也会照旧输出到当前的控制台上。\n\n现在我们可以知道`&`的作用：\n\n- 让程序在后台运行\n- 程序的输出依然不受影响\n\n现在我们可以做实验的最后一步了，首先执行一次的`./a.out &`，回车后马上通过键盘的方向上键`↑`呼出`./a.out &`再次执行一遍（一共执行两遍）。\n\n```bash\n➜  c ./a.out &\n[1] 63691\n➜  c ./a.out &\n[2] 63694\n➜  c No.0: HelloWorld!\nNo.0: HelloWorld!\nNo.1: HelloWorld!\nNo.1: HelloWorld!\nNo.2: HelloWorld!\n\n[1]  - 63691 done       ./a.out\n➜  c No.2: HelloWorld!\n\n[2]  + 63694 done       ./a.out\n➜  c\n```\n\n我们执行了两遍同一个程序，输出的结果并不是依次顺序的`0-1-2-0-1-2`，而是有些乱序的`0-0-1-1-2-2`。\n\n乱序的结果会给人一种有两个同样的程序在 **同时执行** 的感觉，但显然我们有且仅有一个存放在硬盘上的程序。这说明两次执行的的确确产生了两个 **不同的** 进程，尽管他们源于同一个程序，有着一样的运行逻辑。\n\n## 程序和进程的关系、区别\n\n`a.out`是我们的程序，但程序只是一段指令，仅仅存放在硬盘上的话它就是死的（**静态的**），只要你的硬盘不坏，这个程序放一万年都是原来的那个程序。但程序执行产生的进程是活的（**动态的**），会随着时间的推移发生状态的改变，例如当所有指令运行完毕进程就会因为无事可做而终止了。\n\n进程是由程序的执行产生的，而程序又可以被多次执行，自然地一个程序可以产生**多个**进程，但一个进程只能源于某一个程序。\n\n> 进程和程序间的区别是很微妙的，但非常重要。用一个比喻可以更容易理解这一点。想象一位有一手好厨艺的计算机科学家正在为她的女儿烘制生日蛋糕。他有做生日蛋糕的食谱，厨房里有所需的原料：面粉、鸡蛋、糖、香草汁等。在这个比喻中。做蛋糕的食谱就是程序，计算机科学家就是处理器（CPU）。而做蛋糕的各种原料就是输入数据。进程就是厨师阅读食谱、取来各种原料以及烘制蛋糕等一系列动作的总和。——《现代操作系统》\n\n## 为什么需要引入进程的概念\n\n通过`2`和`3`的例子，现在你应该知道对程序和进程有比较明确的认知了。在深入一些，这个看起来和程序没有太大区别的进程到底是出于什么原因被引入的？\n\n在今天的操作系统中，并发已经是一件非常司空见惯的事情了，一边听歌一边看博客，一边看电影一边聊天，这些在电脑上运行着的程序都是在 **操作系统** 的管理下达到同时运行互不影响的效果的。\n\n我们的电脑中能够执行指令的 **CPU** 只有一个（暂时忽略多核CPU），多个进程之间之所以能够呈现出同时运行的效果，是因为每个程序都只能被CPU执行很小一段时间，在时间结束后操作系统就换上别的程序让CPU执行（想象在 *100ms* 的时间内，每个程序只运行 *5ms*）。CPU实际上是在 **很快地切换执行** 不同的程序，而不是真正在 **同时执行** 那么多程序。\n\n而不断切换不同程序运行会导致有些程序还没运行完就失去CPU了，这要求操作系统能够知道每个程序当前的执行状态，以便于重新得到CPU时 **还原现场**，执行信息则是在每次程序失去CPU时被记录在特定的结构中（**保存现场**）。\n\n归根结底，进程是操作系统出于对运行着的程序的管理需求（**保存现场** 是其中之一）而创造出来的，被操作系统附加了信息后的结构就是 **PCB（进程控制块）**，这是真实存在于我们的电脑中的 **数据结构** ，而进程只是这个结构的 **抽象概念** 。\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"操作系统系列之——进程\",\n  \"date\": \"2020-12-22T13:24:06.000Z\",\n  \"tags\": [\"os\", \"process\", \"c\"],\n  \"categories\": [\"code\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"\\u8BF4\\u660E\"), mdx(\"p\", null, \"\\u6CE8\\u610F\\uFF0C\\u5728\\u9605\\u8BFB\\u8FD9\\u7BC7\\u6587\\u7AE0\\u4E4B\\u524D\\uFF0C\\u8BF7\\u786E\\u4FDD\\u4F60\\u5DF2\\u7ECF\\u5177\\u5907\\u4EE5\\u4E0B\\u6587\\u7AE0\\u4E2D\\u7684\\u77E5\\u8BC6\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/posts/code/os-program/\"\n  }, \"\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u7CFB\\u5217\\u4E4B\\u2014\\u2014\\u7A0B\\u5E8F\"))), mdx(\"p\", null, \"\\u672C\\u7BC7\\u6587\\u7AE0\\u8BD5\\u56FE\\u8BA9\\u4F60\\u611F\\u53D7\\u5230\\u8FDB\\u7A0B\\u4E0E\\u7A0B\\u5E8F\\u7684\\u533A\\u522B\\uFF0C\\u8F83\\u4E3A\\u6DF1\\u5165\\u7684\\u7EC6\\u8282\\u5C06\\u7559\\u5728\\u540E\\u7EED\\u7684\\u6587\\u7AE0\\u4E2D\\u3002\"), mdx(\"h2\", null, \"\\u4EC0\\u4E48\\u662F\\u8FDB\\u7A0B\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8FDB\\u7A0B\\u672C\\u8D28\\u4E0A\\u662F\\u6B63\\u5728\\u6267\\u884C\\u7684\\u4E00\\u4E2A\\u7A0B\\u5E8F\\uFF0C\\u662F\\u5BF9\\u6B63\\u5728\\u8FD0\\u884C\\u7A0B\\u5E8F\\u7684\\u4E00\\u4E2A\\u62BD\\u8C61\\u3002\\u2014\\u2014\\u300A\\u73B0\\u4EE3\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u300B\")), mdx(\"p\", null, \"\\u5728\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.jabingp.cn//posts/code/linux-program/\"\n  }, \"\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u7CFB\\u5217\\u4E4B\\u2014\\u2014\\u7A0B\\u5E8F\"), \"\\u4E2D\\uFF0C\\u6211\\u4EEC\\u901A\\u8FC7 C \\u8BED\\u8A00\\u548C gcc \\u7F16\\u8BD1\\u5668\\u5F97\\u5230\\u4E86\\u4E00\\u4E2A\\u88AB\\u5B58\\u653E\\u5728\\u786C\\u76D8\\u4E2D\\u7684\\u7A0B\\u5E8F \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"a.out\"), \" \\uFF0C\\u5F53\\u5B83\\u88AB\\u8BA1\\u7B97\\u673A\\u6267\\u884C\\u65F6\\u5C31\\u4F1A\\u4EA7\\u751F\\u4E00\\u4E2A\\u8FDB\\u7A0B\\u3002\"), mdx(\"h2\", null, \"\\u6267\\u884C\\u4E00\\u4E2A\\u7A0B\\u5E8F\\u5C31\\u4F1A\\u4EA7\\u751F\\u8FDB\\u7A0B\"), mdx(\"p\", null, \"\\u76F4\\u63A5\\u5728\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"a.out\"), \"\\u6240\\u5728\\u76EE\\u5F55\\u901A\\u8FC7\\u76F8\\u5BF9\\u8DEF\\u5F84\\u6267\\u884C\\u8FD9\\u4E2A\\u7A0B\\u5E8F\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\\u7A0B\\u5E8F\\u8FD0\\u884C\\u5E76\\u5C06\\u5B57\\u7B26\\u8F93\\u51FA\\u5230\\u4E86\\u63A7\\u5236\\u53F0\\u4E2D\\uFF1A\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u5176\\u4E2D\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u279C  c\"), \"\\u662F\\u547D\\u4EE4\\u63D0\\u793A\\u7B26\\uFF0C\\u8BF7\\u5FFD\\u7565\\u8BE5\\u90E8\\u5206\\uFF0C\\u5173\\u6CE8\\u63D0\\u793A\\u7B26\\u540E\\u9762\\u7684\\u5185\\u5BB9\\u3002\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"\\u279C  c ./a.out\\nHelloWorld!                                                                                                 \\n\")), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\u7A0B\\u5E8F\\u4E2D\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"printf\"), \" \\u88AB\\u8F93\\u51FA\\u5230\\u5F53\\u524D\\u7684\\u63A7\\u5236\\u53F0\\u4E2D\\uFF0C\\u8BF4\\u660E\\u7A0B\\u5E8F\\u786E\\u5B9E\\u88AB\\u6267\\u884C\\u4E86\\uFF0C\\u4F46\\u8FD9\\u6837\\u4F3C\\u4E4E\\u8FD8\\u65E0\\u6CD5\\u8BC1\\u660E\\u5728\\u8FD9\\u4E2A\\u8FC7\\u7A0B\\u4E2D\\u6709 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8FDB\\u7A0B\"), \" \\u4EA7\\u751F\\u3002\\u4E3A\\u4E86\\u8BC1\\u660E\\u8FDB\\u7A0B\\u7684\\u5B58\\u5728\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u505A\\u4E2A\\u5C0F\\u5B9E\\u9A8C\\u3002\"), mdx(\"h2\", null, \"\\u8FDB\\u7A0B\\u7684\\u5C0F\\u5B9E\\u9A8C\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u518D\\u6B21\\u5F3A\\u8C03\\uFF0C\\u4EE5\\u4E0B\\u4EE3\\u7801\\u9002\\u7528\\u4E8E\\u7C7BUnix\\u7CFB\\u7EDF\\uFF0C\\u4E0D\\u540C\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u4E4B\\u95F4\\u9700\\u8981\\u4F7F\\u7528\\u7684\\u5E93\\u548C\\u7F16\\u8BD1\\u5DE5\\u5177\\u4F1A\\u6709\\u6240\\u4E0D\\u540C\\u3002\")), mdx(\"p\", null, \"\\u9996\\u5148\\u6539\\u9020\\u4E00\\u4E0B\\u6211\\u4EEC\\u7684\\u7ECF\\u5178 HelloWorld \\uFF0C\\u5F15\\u5165\\u4E86\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"unistd\"), \"\\u6765\\u5B9E\\u73B0\\u7761\\u7720\\u4E00\\u6BB5\\u65F6\\u95F4\\uFF0C\\u6211\\u4EEC\\u7F16\\u5199\\u7A0B\\u5E8F\\u8BA9\\u5C4F\\u5E55\\u6BCF\\u9694\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"4s\"), \"\\u8F93\\u51FA\\u4E00\\u6761 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5E26\\u6709\\u7F16\\u53F7\\u7684HelloWorld\"), \" \\uFF0C\\u4E14\\u9650\\u5236\\u4E00\\u5171\\u8F93\\u51FA\\u4E09\\u6761\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"#include <stdio.h>\\n#include <unistd.h>\\n#define SLEEP_SECONDS 4\\nint main(){\\n    for(int i=0; i < 3; i++){\\n        sleep(SLEEP_SECONDS);\\n        printf(\\\"No.%d: HelloWorld!\\\\n\\\",i);\\n    }\\n    return 0;\\n}\\n\")), mdx(\"p\", null, \"\\u7F16\\u8BD1\\u5E76\\u8FD0\\u884C\\uFF0C\\u7ED3\\u679C\\u662F\\u7B26\\u5408\\u9884\\u671F\\u7684\\uFF0C\\u540C\\u65F6\\u6CE8\\u610F\\u7ED3\\u679C\\u4E2D\\u7684\\u547D\\u4EE4\\u63D0\\u793A\\u7B26 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u279C  c\"), \" \\uFF0C\\u5B83\\u5728\\u7A0B\\u5E8F\\u6267\\u884C\\u5B8C\\u6BD5\\u540E\\u624D\\u51FA\\u73B0\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"\\u279C  c ./a.out\\nNo.0: HelloWorld!\\nNo.1: HelloWorld!\\nNo.2: HelloWorld!\\n\\u279C  c\\n\")), mdx(\"p\", null, \"\\u4E3A\\u4E86\\u8FBE\\u5230\\u5B9E\\u9A8C\\u7684\\u6548\\u679C\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u7528\\u5230 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"&\"), \" \\u8FD9\\u4E2A\\u7B26\\u53F7\\uFF0C\\u5728\\u547D\\u4EE4\\u7684\\u7ED3\\u5C3E\\u52A0\\u4E0A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"&\"), \" \\u5219\\u53EF\\u4EE5\\u5B9E\\u73B0\\u5728\\u540E\\u53F0\\u8FD0\\u884C\\u8BE5\\u547D\\u4EE4\\uFF0C\\u8FD9\\u6837\\u6211\\u4EEC\\u5C31\\u65E0\\u9700\\u7B49\\u5F85\\u7A0B\\u5E8F\\u8FD0\\u884C\\u5B8C\\u6BD5\\uFF0C\\u547D\\u4EE4\\u63D0\\u793A\\u7B26\\u4F1A\\u9A6C\\u4E0A\\u51FA\\u73B0\\u3002\"), mdx(\"p\", null, \"\\u5C1D\\u8BD5\\u4E00\\u4E0B\\u52A0\\u4E0A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"&\"), \"\\u4F1A\\u6709\\u4EC0\\u4E48\\u53D8\\u5316\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"\\u279C  c ./a.out &\\n[1] 63965\\n\\u279C  c No.0: HelloWorld!\\nNo.1: HelloWorld!\\nNo.2: HelloWorld!\\n\\n[1]  + 63965 done       ./a.out\\n\\u279C  c\\n\")), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\u52A0\\u4E0A & \\u540E\\u6CA1\\u6709\\u7B49\\u5F85 a.out \\u7684\\u6267\\u884C\\u7ED3\\u675F\\u800C\\u76F4\\u63A5\\u8F93\\u51FA\\u4E86 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[1] 63965\"), \"\\uFF08\\u5176\\u5B9E\\u8FD9\\u5C31\\u662F\\u8FDB\\u7A0B\\u7684 pid \\uFF09\\uFF0C\\u5E76\\u4E14 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u547D\\u4EE4\\u63D0\\u793A\\u7B26\"), \" \\u9A6C\\u4E0A\\u51FA\\u73B0\\uFF0C\\u8FD9\\u610F\\u5473\\u7740\\u6211\\u4EEC\\u53EF\\u4EE5\\u76F4\\u63A5\\u8FDB\\u884C\\u4E0B\\u4E00\\u6B65\\u7684\\u64CD\\u4F5C\\u800C\\u4E0D\\u7528\\u7B49\\u5F85 a.out \\u8FD0\\u884C\\u5B8C\\u6BD5\\uFF0C a.out \\u7684\\u8FD0\\u884C\\u7ED3\\u679C\\u4E5F\\u4F1A\\u7167\\u65E7\\u8F93\\u51FA\\u5230\\u5F53\\u524D\\u7684\\u63A7\\u5236\\u53F0\\u4E0A\\u3002\"), mdx(\"p\", null, \"\\u73B0\\u5728\\u6211\\u4EEC\\u53EF\\u4EE5\\u77E5\\u9053\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"&\"), \"\\u7684\\u4F5C\\u7528\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u8BA9\\u7A0B\\u5E8F\\u5728\\u540E\\u53F0\\u8FD0\\u884C\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u7A0B\\u5E8F\\u7684\\u8F93\\u51FA\\u4F9D\\u7136\\u4E0D\\u53D7\\u5F71\\u54CD\")), mdx(\"p\", null, \"\\u73B0\\u5728\\u6211\\u4EEC\\u53EF\\u4EE5\\u505A\\u5B9E\\u9A8C\\u7684\\u6700\\u540E\\u4E00\\u6B65\\u4E86\\uFF0C\\u9996\\u5148\\u6267\\u884C\\u4E00\\u6B21\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./a.out &\"), \"\\uFF0C\\u56DE\\u8F66\\u540E\\u9A6C\\u4E0A\\u901A\\u8FC7\\u952E\\u76D8\\u7684\\u65B9\\u5411\\u4E0A\\u952E\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\\u2191\"), \"\\u547C\\u51FA\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./a.out &\"), \"\\u518D\\u6B21\\u6267\\u884C\\u4E00\\u904D\\uFF08\\u4E00\\u5171\\u6267\\u884C\\u4E24\\u904D\\uFF09\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"\\u279C  c ./a.out &\\n[1] 63691\\n\\u279C  c ./a.out &\\n[2] 63694\\n\\u279C  c No.0: HelloWorld!\\nNo.0: HelloWorld!\\nNo.1: HelloWorld!\\nNo.1: HelloWorld!\\nNo.2: HelloWorld!\\n\\n[1]  - 63691 done       ./a.out\\n\\u279C  c No.2: HelloWorld!\\n\\n[2]  + 63694 done       ./a.out\\n\\u279C  c\\n\")), mdx(\"p\", null, \"\\u6211\\u4EEC\\u6267\\u884C\\u4E86\\u4E24\\u904D\\u540C\\u4E00\\u4E2A\\u7A0B\\u5E8F\\uFF0C\\u8F93\\u51FA\\u7684\\u7ED3\\u679C\\u5E76\\u4E0D\\u662F\\u4F9D\\u6B21\\u987A\\u5E8F\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0-1-2-0-1-2\"), \"\\uFF0C\\u800C\\u662F\\u6709\\u4E9B\\u4E71\\u5E8F\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0-0-1-1-2-2\"), \"\\u3002\"), mdx(\"p\", null, \"\\u4E71\\u5E8F\\u7684\\u7ED3\\u679C\\u4F1A\\u7ED9\\u4EBA\\u4E00\\u79CD\\u6709\\u4E24\\u4E2A\\u540C\\u6837\\u7684\\u7A0B\\u5E8F\\u5728 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u540C\\u65F6\\u6267\\u884C\"), \" \\u7684\\u611F\\u89C9\\uFF0C\\u4F46\\u663E\\u7136\\u6211\\u4EEC\\u6709\\u4E14\\u4EC5\\u6709\\u4E00\\u4E2A\\u5B58\\u653E\\u5728\\u786C\\u76D8\\u4E0A\\u7684\\u7A0B\\u5E8F\\u3002\\u8FD9\\u8BF4\\u660E\\u4E24\\u6B21\\u6267\\u884C\\u7684\\u7684\\u786E\\u786E\\u4EA7\\u751F\\u4E86\\u4E24\\u4E2A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4E0D\\u540C\\u7684\"), \" \\u8FDB\\u7A0B\\uFF0C\\u5C3D\\u7BA1\\u4ED6\\u4EEC\\u6E90\\u4E8E\\u540C\\u4E00\\u4E2A\\u7A0B\\u5E8F\\uFF0C\\u6709\\u7740\\u4E00\\u6837\\u7684\\u8FD0\\u884C\\u903B\\u8F91\\u3002\"), mdx(\"h2\", null, \"\\u7A0B\\u5E8F\\u548C\\u8FDB\\u7A0B\\u7684\\u5173\\u7CFB\\u3001\\u533A\\u522B\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"a.out\"), \"\\u662F\\u6211\\u4EEC\\u7684\\u7A0B\\u5E8F\\uFF0C\\u4F46\\u7A0B\\u5E8F\\u53EA\\u662F\\u4E00\\u6BB5\\u6307\\u4EE4\\uFF0C\\u4EC5\\u4EC5\\u5B58\\u653E\\u5728\\u786C\\u76D8\\u4E0A\\u7684\\u8BDD\\u5B83\\u5C31\\u662F\\u6B7B\\u7684\\uFF08\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u9759\\u6001\\u7684\"), \"\\uFF09\\uFF0C\\u53EA\\u8981\\u4F60\\u7684\\u786C\\u76D8\\u4E0D\\u574F\\uFF0C\\u8FD9\\u4E2A\\u7A0B\\u5E8F\\u653E\\u4E00\\u4E07\\u5E74\\u90FD\\u662F\\u539F\\u6765\\u7684\\u90A3\\u4E2A\\u7A0B\\u5E8F\\u3002\\u4F46\\u7A0B\\u5E8F\\u6267\\u884C\\u4EA7\\u751F\\u7684\\u8FDB\\u7A0B\\u662F\\u6D3B\\u7684\\uFF08\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u52A8\\u6001\\u7684\"), \"\\uFF09\\uFF0C\\u4F1A\\u968F\\u7740\\u65F6\\u95F4\\u7684\\u63A8\\u79FB\\u53D1\\u751F\\u72B6\\u6001\\u7684\\u6539\\u53D8\\uFF0C\\u4F8B\\u5982\\u5F53\\u6240\\u6709\\u6307\\u4EE4\\u8FD0\\u884C\\u5B8C\\u6BD5\\u8FDB\\u7A0B\\u5C31\\u4F1A\\u56E0\\u4E3A\\u65E0\\u4E8B\\u53EF\\u505A\\u800C\\u7EC8\\u6B62\\u4E86\\u3002\"), mdx(\"p\", null, \"\\u8FDB\\u7A0B\\u662F\\u7531\\u7A0B\\u5E8F\\u7684\\u6267\\u884C\\u4EA7\\u751F\\u7684\\uFF0C\\u800C\\u7A0B\\u5E8F\\u53C8\\u53EF\\u4EE5\\u88AB\\u591A\\u6B21\\u6267\\u884C\\uFF0C\\u81EA\\u7136\\u5730\\u4E00\\u4E2A\\u7A0B\\u5E8F\\u53EF\\u4EE5\\u4EA7\\u751F\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u591A\\u4E2A\"), \"\\u8FDB\\u7A0B\\uFF0C\\u4F46\\u4E00\\u4E2A\\u8FDB\\u7A0B\\u53EA\\u80FD\\u6E90\\u4E8E\\u67D0\\u4E00\\u4E2A\\u7A0B\\u5E8F\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8FDB\\u7A0B\\u548C\\u7A0B\\u5E8F\\u95F4\\u7684\\u533A\\u522B\\u662F\\u5F88\\u5FAE\\u5999\\u7684\\uFF0C\\u4F46\\u975E\\u5E38\\u91CD\\u8981\\u3002\\u7528\\u4E00\\u4E2A\\u6BD4\\u55BB\\u53EF\\u4EE5\\u66F4\\u5BB9\\u6613\\u7406\\u89E3\\u8FD9\\u4E00\\u70B9\\u3002\\u60F3\\u8C61\\u4E00\\u4F4D\\u6709\\u4E00\\u624B\\u597D\\u53A8\\u827A\\u7684\\u8BA1\\u7B97\\u673A\\u79D1\\u5B66\\u5BB6\\u6B63\\u5728\\u4E3A\\u5979\\u7684\\u5973\\u513F\\u70D8\\u5236\\u751F\\u65E5\\u86CB\\u7CD5\\u3002\\u4ED6\\u6709\\u505A\\u751F\\u65E5\\u86CB\\u7CD5\\u7684\\u98DF\\u8C31\\uFF0C\\u53A8\\u623F\\u91CC\\u6709\\u6240\\u9700\\u7684\\u539F\\u6599\\uFF1A\\u9762\\u7C89\\u3001\\u9E21\\u86CB\\u3001\\u7CD6\\u3001\\u9999\\u8349\\u6C41\\u7B49\\u3002\\u5728\\u8FD9\\u4E2A\\u6BD4\\u55BB\\u4E2D\\u3002\\u505A\\u86CB\\u7CD5\\u7684\\u98DF\\u8C31\\u5C31\\u662F\\u7A0B\\u5E8F\\uFF0C\\u8BA1\\u7B97\\u673A\\u79D1\\u5B66\\u5BB6\\u5C31\\u662F\\u5904\\u7406\\u5668\\uFF08CPU\\uFF09\\u3002\\u800C\\u505A\\u86CB\\u7CD5\\u7684\\u5404\\u79CD\\u539F\\u6599\\u5C31\\u662F\\u8F93\\u5165\\u6570\\u636E\\u3002\\u8FDB\\u7A0B\\u5C31\\u662F\\u53A8\\u5E08\\u9605\\u8BFB\\u98DF\\u8C31\\u3001\\u53D6\\u6765\\u5404\\u79CD\\u539F\\u6599\\u4EE5\\u53CA\\u70D8\\u5236\\u86CB\\u7CD5\\u7B49\\u4E00\\u7CFB\\u5217\\u52A8\\u4F5C\\u7684\\u603B\\u548C\\u3002\\u2014\\u2014\\u300A\\u73B0\\u4EE3\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u300B\")), mdx(\"h2\", null, \"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981\\u5F15\\u5165\\u8FDB\\u7A0B\\u7684\\u6982\\u5FF5\"), mdx(\"p\", null, \"\\u901A\\u8FC7\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"2\"), \"\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"3\"), \"\\u7684\\u4F8B\\u5B50\\uFF0C\\u73B0\\u5728\\u4F60\\u5E94\\u8BE5\\u77E5\\u9053\\u5BF9\\u7A0B\\u5E8F\\u548C\\u8FDB\\u7A0B\\u6709\\u6BD4\\u8F83\\u660E\\u786E\\u7684\\u8BA4\\u77E5\\u4E86\\u3002\\u5728\\u6DF1\\u5165\\u4E00\\u4E9B\\uFF0C\\u8FD9\\u4E2A\\u770B\\u8D77\\u6765\\u548C\\u7A0B\\u5E8F\\u6CA1\\u6709\\u592A\\u5927\\u533A\\u522B\\u7684\\u8FDB\\u7A0B\\u5230\\u5E95\\u662F\\u51FA\\u4E8E\\u4EC0\\u4E48\\u539F\\u56E0\\u88AB\\u5F15\\u5165\\u7684\\uFF1F\"), mdx(\"p\", null, \"\\u5728\\u4ECA\\u5929\\u7684\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u4E2D\\uFF0C\\u5E76\\u53D1\\u5DF2\\u7ECF\\u662F\\u4E00\\u4EF6\\u975E\\u5E38\\u53F8\\u7A7A\\u89C1\\u60EF\\u7684\\u4E8B\\u60C5\\u4E86\\uFF0C\\u4E00\\u8FB9\\u542C\\u6B4C\\u4E00\\u8FB9\\u770B\\u535A\\u5BA2\\uFF0C\\u4E00\\u8FB9\\u770B\\u7535\\u5F71\\u4E00\\u8FB9\\u804A\\u5929\\uFF0C\\u8FD9\\u4E9B\\u5728\\u7535\\u8111\\u4E0A\\u8FD0\\u884C\\u7740\\u7684\\u7A0B\\u5E8F\\u90FD\\u662F\\u5728 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u64CD\\u4F5C\\u7CFB\\u7EDF\"), \" \\u7684\\u7BA1\\u7406\\u4E0B\\u8FBE\\u5230\\u540C\\u65F6\\u8FD0\\u884C\\u4E92\\u4E0D\\u5F71\\u54CD\\u7684\\u6548\\u679C\\u7684\\u3002\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u7684\\u7535\\u8111\\u4E2D\\u80FD\\u591F\\u6267\\u884C\\u6307\\u4EE4\\u7684 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"CPU\"), \" \\u53EA\\u6709\\u4E00\\u4E2A\\uFF08\\u6682\\u65F6\\u5FFD\\u7565\\u591A\\u6838CPU\\uFF09\\uFF0C\\u591A\\u4E2A\\u8FDB\\u7A0B\\u4E4B\\u95F4\\u4E4B\\u6240\\u4EE5\\u80FD\\u591F\\u5448\\u73B0\\u51FA\\u540C\\u65F6\\u8FD0\\u884C\\u7684\\u6548\\u679C\\uFF0C\\u662F\\u56E0\\u4E3A\\u6BCF\\u4E2A\\u7A0B\\u5E8F\\u90FD\\u53EA\\u80FD\\u88ABCPU\\u6267\\u884C\\u5F88\\u5C0F\\u4E00\\u6BB5\\u65F6\\u95F4\\uFF0C\\u5728\\u65F6\\u95F4\\u7ED3\\u675F\\u540E\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u5C31\\u6362\\u4E0A\\u522B\\u7684\\u7A0B\\u5E8F\\u8BA9CPU\\u6267\\u884C\\uFF08\\u60F3\\u8C61\\u5728 \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"100ms\"), \" \\u7684\\u65F6\\u95F4\\u5185\\uFF0C\\u6BCF\\u4E2A\\u7A0B\\u5E8F\\u53EA\\u8FD0\\u884C \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"5ms\"), \"\\uFF09\\u3002CPU\\u5B9E\\u9645\\u4E0A\\u662F\\u5728 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F88\\u5FEB\\u5730\\u5207\\u6362\\u6267\\u884C\"), \" \\u4E0D\\u540C\\u7684\\u7A0B\\u5E8F\\uFF0C\\u800C\\u4E0D\\u662F\\u771F\\u6B63\\u5728 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u540C\\u65F6\\u6267\\u884C\"), \" \\u90A3\\u4E48\\u591A\\u7A0B\\u5E8F\\u3002\"), mdx(\"p\", null, \"\\u800C\\u4E0D\\u65AD\\u5207\\u6362\\u4E0D\\u540C\\u7A0B\\u5E8F\\u8FD0\\u884C\\u4F1A\\u5BFC\\u81F4\\u6709\\u4E9B\\u7A0B\\u5E8F\\u8FD8\\u6CA1\\u8FD0\\u884C\\u5B8C\\u5C31\\u5931\\u53BBCPU\\u4E86\\uFF0C\\u8FD9\\u8981\\u6C42\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u80FD\\u591F\\u77E5\\u9053\\u6BCF\\u4E2A\\u7A0B\\u5E8F\\u5F53\\u524D\\u7684\\u6267\\u884C\\u72B6\\u6001\\uFF0C\\u4EE5\\u4FBF\\u4E8E\\u91CD\\u65B0\\u5F97\\u5230CPU\\u65F6 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8FD8\\u539F\\u73B0\\u573A\"), \"\\uFF0C\\u6267\\u884C\\u4FE1\\u606F\\u5219\\u662F\\u5728\\u6BCF\\u6B21\\u7A0B\\u5E8F\\u5931\\u53BBCPU\\u65F6\\u88AB\\u8BB0\\u5F55\\u5728\\u7279\\u5B9A\\u7684\\u7ED3\\u6784\\u4E2D\\uFF08\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4FDD\\u5B58\\u73B0\\u573A\"), \"\\uFF09\\u3002\"), mdx(\"p\", null, \"\\u5F52\\u6839\\u7ED3\\u5E95\\uFF0C\\u8FDB\\u7A0B\\u662F\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u51FA\\u4E8E\\u5BF9\\u8FD0\\u884C\\u7740\\u7684\\u7A0B\\u5E8F\\u7684\\u7BA1\\u7406\\u9700\\u6C42\\uFF08\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4FDD\\u5B58\\u73B0\\u573A\"), \" \\u662F\\u5176\\u4E2D\\u4E4B\\u4E00\\uFF09\\u800C\\u521B\\u9020\\u51FA\\u6765\\u7684\\uFF0C\\u88AB\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u9644\\u52A0\\u4E86\\u4FE1\\u606F\\u540E\\u7684\\u7ED3\\u6784\\u5C31\\u662F \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"PCB\\uFF08\\u8FDB\\u7A0B\\u63A7\\u5236\\u5757\\uFF09\"), \"\\uFF0C\\u8FD9\\u662F\\u771F\\u5B9E\\u5B58\\u5728\\u4E8E\\u6211\\u4EEC\\u7684\\u7535\\u8111\\u4E2D\\u7684 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6570\\u636E\\u7ED3\\u6784\"), \" \\uFF0C\\u800C\\u8FDB\\u7A0B\\u53EA\\u662F\\u8FD9\\u4E2A\\u7ED3\\u6784\\u7684 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u62BD\\u8C61\\u6982\\u5FF5\"), \" \\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"说明 注意，在阅读这篇文章之前，请确保你已经具备以下文章中的知识： 操作系统系列之——程序 本篇文章试图让你感受到进程与程序的区别，较为深入的细节将留在后续的文章中。 什么是进程 进程本质上是正在执行的一个程序，是对正在运行程序的一个抽象。——《现代操作系统》 在 操作系统系列之——程序 中，我们通过 C…","frontmatter":{"date":"2020-12-22 13:24","title":"操作系统系列之——进程","draft":false}},{"id":"6f1807d0-d72b-512c-b014-f090f7f9d672","slug":"posts/code/os-program","rawBody":"---\ntitle: \"操作系统系列之——程序\"\ndate: 2020-12-21T21:24:06+08:00\ntags: [\"os\", \"program\", \"c\"]\ncategories: [\"code\"]\ndraft: false\n---\n\n> 这是这个系列的第一篇文章，如果对后续感兴趣，可以不时检查[os](https://blog.jabingp.cn/tags/os/)是否更新。\n\n## 1. 什么是程序\n\n> 计算机程序是**一组**指示电子计算机或其他具有消息处理能力设备每一步动作的**指令**。————《[维基百科：计算机程序](https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F)》\n\n## 2. 程序有啥用\n\n定义中也提到了**程序**是*指示每一步动作*的**指令**，简单的说，程序就是实现某个目标所需要经历的步骤。\n\n举一个现实中的例子，当我的目标是**得到一杯手冲咖啡**时，那我实现这个目标的**程序**就是：\n\n1. 取出一包咖啡豆、V60滤杯、V60滤纸、自己喜欢的咖啡杯、够用的电子秤、尽量贵的咖啡磨豆机、一个能倒出水的手冲壶。\n2. 用电子秤秤出15g咖啡豆。\n3. 用咖啡磨豆机研磨咖啡豆，得到咖啡粉。\n4. 将手冲壶装满水。\n5. 将手冲壶里的水加热到90°\n6. 将V60滤纸放入V60滤杯中，用热水湿润后，倒干多余的水。\n7. 将咖啡粉倒入V60滤杯，滤杯架放在咖啡杯上。\n8. 将热水倒入滤杯，用电子秤观察自己的倒入的水量到达225g时停止。\n9. 等待所有热水通过滤杯滴入咖啡杯，移开滤杯。\n\n>如果你发现你看不懂这个程序，没有关系这是正常的，你只需要知道这个复杂的一系列流程其实就相当于计算机中的一个**程序**，它给出了实现**得到一杯手冲咖啡**这个目标所需要的步骤。但如果你发现这个**程序**简直跟自己每天在做的一样，请留下评论让我们交个朋友！\n\n## 3. 源代码\n\n前面举了一个比较抽象的例子，也许有的人已经get到了，有的人还是一脸雾水，接下来会继续用更具体的例子，不过这要求你对**C语言**和**命令行**有简单的了解。\n\n你现在有一个很简单的目标：**向屏幕输出三次\"HelloWorld!\"**，你很轻易地想到了你可以利用你曾学的**C语言**去实现：\n\n```c\n#include <stdio.h>\nint main(){\n    for(int i=0; i<3; i++){\n        printf(\"No.%d: HelloWorld!\\n\",i);\n    }\n    return 0;\n}\n```\n\n回顾一下这个段非常简单的源代码，除了必要的`include`、`main`、`return`等结构，核心的代码只有三行，用`for`循环`3`次，在循环内`printf`：\n\n```c\nfor(int i=0; i < 3; i++){\n    printf(\"No.%d: HelloWorld!\\n\",i);\n}\n```\n\n除了必要的结构外，实际上我们就是用这三行代码去**描述了**如何实现我们需要的目标。这是**C语言**（或者**Python**、**Java**、**JS**、**Golang**）提供给我们的一种**描述的能力**。但是到目前为止，我们所编写的这几行代码还停留在**文本**这个阶段，这是一段你能**读懂**、**修改**的**文本**，但它们并不是计算机能够**识别并执行**的**指令**。\n\n## 4. 编译源代码\n\n让**源代码**成为**程序**也很简单，对于C语言而言，只需要用C语言的**编译器**去**编译**源代码即可。\n\n## 4.1. 编译器做了什么\n\n简单地说，编译器将我们写的**源代码**翻译成了机器能执行的**二进制**。\n\n因为计算机是二进制的，在计算机的底层世界里都是`0`和`1`，但是我们直接用`0`和`1`去给计算机写程序、下指令太过**反人类**，为了便于**我们与计算机的对话**，**编程语言**应运而生。\n\n**编程语言**是更接近人能读懂的语言（尽管它依旧有不小的上手难度，但已经比更底层的指令已经好太多了），虽然人能更方便地使用编程语言编写程序了，但计算机很蠢只懂**二进制**，为了让**计算机也能理解**我们所编写的内容，就需要**编译器**来充当这中间的**翻译官**。\n\n## 4.2. 简单的编译尝试\n\n> 以下操作在类Unix系统中进行，不同操作系统的编译工具可能会不同。\n\n将`3`中的源代码保存为`main.c`，**打开命令行进入当前目录**，利用`gcc`编译工具去编译源代码，指令如下：\n\n```bash\ncd $源代码所在文件夹\ngcc main.c\n```\n\n现在main.c所在文件夹包含内容如下：\n\n- main.c\n- a.out\n\n通过gcc编译后得到了一个二进制可执行文件`a.out`。此时它被保存在硬盘的中，并且计算机也能够执行它，这时候我们才终于通过源代码获得了一个**程序**。\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"操作系统系列之——程序\",\n  \"date\": \"2020-12-21T13:24:06.000Z\",\n  \"tags\": [\"os\", \"program\", \"c\"],\n  \"categories\": [\"code\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8FD9\\u662F\\u8FD9\\u4E2A\\u7CFB\\u5217\\u7684\\u7B2C\\u4E00\\u7BC7\\u6587\\u7AE0\\uFF0C\\u5982\\u679C\\u5BF9\\u540E\\u7EED\\u611F\\u5174\\u8DA3\\uFF0C\\u53EF\\u4EE5\\u4E0D\\u65F6\\u68C0\\u67E5\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.jabingp.cn/tags/os/\"\n  }, \"os\"), \"\\u662F\\u5426\\u66F4\\u65B0\\u3002\")), mdx(\"h2\", null, \"1. \\u4EC0\\u4E48\\u662F\\u7A0B\\u5E8F\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8BA1\\u7B97\\u673A\\u7A0B\\u5E8F\\u662F\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4E00\\u7EC4\"), \"\\u6307\\u793A\\u7535\\u5B50\\u8BA1\\u7B97\\u673A\\u6216\\u5176\\u4ED6\\u5177\\u6709\\u6D88\\u606F\\u5904\\u7406\\u80FD\\u529B\\u8BBE\\u5907\\u6BCF\\u4E00\\u6B65\\u52A8\\u4F5C\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6307\\u4EE4\"), \"\\u3002\\u2014\\u2014\\u2014\\u2014\\u300A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F\"\n  }, \"\\u7EF4\\u57FA\\u767E\\u79D1\\uFF1A\\u8BA1\\u7B97\\u673A\\u7A0B\\u5E8F\"), \"\\u300B\")), mdx(\"h2\", null, \"2. \\u7A0B\\u5E8F\\u6709\\u5565\\u7528\"), mdx(\"p\", null, \"\\u5B9A\\u4E49\\u4E2D\\u4E5F\\u63D0\\u5230\\u4E86\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\u662F\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u6307\\u793A\\u6BCF\\u4E00\\u6B65\\u52A8\\u4F5C\"), \"\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6307\\u4EE4\"), \"\\uFF0C\\u7B80\\u5355\\u7684\\u8BF4\\uFF0C\\u7A0B\\u5E8F\\u5C31\\u662F\\u5B9E\\u73B0\\u67D0\\u4E2A\\u76EE\\u6807\\u6240\\u9700\\u8981\\u7ECF\\u5386\\u7684\\u6B65\\u9AA4\\u3002\"), mdx(\"p\", null, \"\\u4E3E\\u4E00\\u4E2A\\u73B0\\u5B9E\\u4E2D\\u7684\\u4F8B\\u5B50\\uFF0C\\u5F53\\u6211\\u7684\\u76EE\\u6807\\u662F\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F97\\u5230\\u4E00\\u676F\\u624B\\u51B2\\u5496\\u5561\"), \"\\u65F6\\uFF0C\\u90A3\\u6211\\u5B9E\\u73B0\\u8FD9\\u4E2A\\u76EE\\u6807\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\u5C31\\u662F\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u53D6\\u51FA\\u4E00\\u5305\\u5496\\u5561\\u8C46\\u3001V60\\u6EE4\\u676F\\u3001V60\\u6EE4\\u7EB8\\u3001\\u81EA\\u5DF1\\u559C\\u6B22\\u7684\\u5496\\u5561\\u676F\\u3001\\u591F\\u7528\\u7684\\u7535\\u5B50\\u79E4\\u3001\\u5C3D\\u91CF\\u8D35\\u7684\\u5496\\u5561\\u78E8\\u8C46\\u673A\\u3001\\u4E00\\u4E2A\\u80FD\\u5012\\u51FA\\u6C34\\u7684\\u624B\\u51B2\\u58F6\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7528\\u7535\\u5B50\\u79E4\\u79E4\\u51FA15g\\u5496\\u5561\\u8C46\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7528\\u5496\\u5561\\u78E8\\u8C46\\u673A\\u7814\\u78E8\\u5496\\u5561\\u8C46\\uFF0C\\u5F97\\u5230\\u5496\\u5561\\u7C89\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5C06\\u624B\\u51B2\\u58F6\\u88C5\\u6EE1\\u6C34\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5C06\\u624B\\u51B2\\u58F6\\u91CC\\u7684\\u6C34\\u52A0\\u70ED\\u523090\\xB0\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5C06V60\\u6EE4\\u7EB8\\u653E\\u5165V60\\u6EE4\\u676F\\u4E2D\\uFF0C\\u7528\\u70ED\\u6C34\\u6E7F\\u6DA6\\u540E\\uFF0C\\u5012\\u5E72\\u591A\\u4F59\\u7684\\u6C34\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5C06\\u5496\\u5561\\u7C89\\u5012\\u5165V60\\u6EE4\\u676F\\uFF0C\\u6EE4\\u676F\\u67B6\\u653E\\u5728\\u5496\\u5561\\u676F\\u4E0A\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5C06\\u70ED\\u6C34\\u5012\\u5165\\u6EE4\\u676F\\uFF0C\\u7528\\u7535\\u5B50\\u79E4\\u89C2\\u5BDF\\u81EA\\u5DF1\\u7684\\u5012\\u5165\\u7684\\u6C34\\u91CF\\u5230\\u8FBE225g\\u65F6\\u505C\\u6B62\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7B49\\u5F85\\u6240\\u6709\\u70ED\\u6C34\\u901A\\u8FC7\\u6EE4\\u676F\\u6EF4\\u5165\\u5496\\u5561\\u676F\\uFF0C\\u79FB\\u5F00\\u6EE4\\u676F\\u3002\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u5982\\u679C\\u4F60\\u53D1\\u73B0\\u4F60\\u770B\\u4E0D\\u61C2\\u8FD9\\u4E2A\\u7A0B\\u5E8F\\uFF0C\\u6CA1\\u6709\\u5173\\u7CFB\\u8FD9\\u662F\\u6B63\\u5E38\\u7684\\uFF0C\\u4F60\\u53EA\\u9700\\u8981\\u77E5\\u9053\\u8FD9\\u4E2A\\u590D\\u6742\\u7684\\u4E00\\u7CFB\\u5217\\u6D41\\u7A0B\\u5176\\u5B9E\\u5C31\\u76F8\\u5F53\\u4E8E\\u8BA1\\u7B97\\u673A\\u4E2D\\u7684\\u4E00\\u4E2A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\uFF0C\\u5B83\\u7ED9\\u51FA\\u4E86\\u5B9E\\u73B0\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F97\\u5230\\u4E00\\u676F\\u624B\\u51B2\\u5496\\u5561\"), \"\\u8FD9\\u4E2A\\u76EE\\u6807\\u6240\\u9700\\u8981\\u7684\\u6B65\\u9AA4\\u3002\\u4F46\\u5982\\u679C\\u4F60\\u53D1\\u73B0\\u8FD9\\u4E2A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\u7B80\\u76F4\\u8DDF\\u81EA\\u5DF1\\u6BCF\\u5929\\u5728\\u505A\\u7684\\u4E00\\u6837\\uFF0C\\u8BF7\\u7559\\u4E0B\\u8BC4\\u8BBA\\u8BA9\\u6211\\u4EEC\\u4EA4\\u4E2A\\u670B\\u53CB\\uFF01\")), mdx(\"h2\", null, \"3. \\u6E90\\u4EE3\\u7801\"), mdx(\"p\", null, \"\\u524D\\u9762\\u4E3E\\u4E86\\u4E00\\u4E2A\\u6BD4\\u8F83\\u62BD\\u8C61\\u7684\\u4F8B\\u5B50\\uFF0C\\u4E5F\\u8BB8\\u6709\\u7684\\u4EBA\\u5DF2\\u7ECFget\\u5230\\u4E86\\uFF0C\\u6709\\u7684\\u4EBA\\u8FD8\\u662F\\u4E00\\u8138\\u96FE\\u6C34\\uFF0C\\u63A5\\u4E0B\\u6765\\u4F1A\\u7EE7\\u7EED\\u7528\\u66F4\\u5177\\u4F53\\u7684\\u4F8B\\u5B50\\uFF0C\\u4E0D\\u8FC7\\u8FD9\\u8981\\u6C42\\u4F60\\u5BF9\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C\\u8BED\\u8A00\"), \"\\u548C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u547D\\u4EE4\\u884C\"), \"\\u6709\\u7B80\\u5355\\u7684\\u4E86\\u89E3\\u3002\"), mdx(\"p\", null, \"\\u4F60\\u73B0\\u5728\\u6709\\u4E00\\u4E2A\\u5F88\\u7B80\\u5355\\u7684\\u76EE\\u6807\\uFF1A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5411\\u5C4F\\u5E55\\u8F93\\u51FA\\u4E09\\u6B21\\\"HelloWorld!\\\"\"), \"\\uFF0C\\u4F60\\u5F88\\u8F7B\\u6613\\u5730\\u60F3\\u5230\\u4E86\\u4F60\\u53EF\\u4EE5\\u5229\\u7528\\u4F60\\u66FE\\u5B66\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C\\u8BED\\u8A00\"), \"\\u53BB\\u5B9E\\u73B0\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"#include <stdio.h>\\nint main(){\\n    for(int i=0; i<3; i++){\\n        printf(\\\"No.%d: HelloWorld!\\\\n\\\",i);\\n    }\\n    return 0;\\n}\\n\")), mdx(\"p\", null, \"\\u56DE\\u987E\\u4E00\\u4E0B\\u8FD9\\u4E2A\\u6BB5\\u975E\\u5E38\\u7B80\\u5355\\u7684\\u6E90\\u4EE3\\u7801\\uFF0C\\u9664\\u4E86\\u5FC5\\u8981\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"include\"), \"\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"main\"), \"\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"return\"), \"\\u7B49\\u7ED3\\u6784\\uFF0C\\u6838\\u5FC3\\u7684\\u4EE3\\u7801\\u53EA\\u6709\\u4E09\\u884C\\uFF0C\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"for\"), \"\\u5FAA\\u73AF\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"3\"), \"\\u6B21\\uFF0C\\u5728\\u5FAA\\u73AF\\u5185\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"printf\"), \"\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c\"\n  }, \"for(int i=0; i < 3; i++){\\n    printf(\\\"No.%d: HelloWorld!\\\\n\\\",i);\\n}\\n\")), mdx(\"p\", null, \"\\u9664\\u4E86\\u5FC5\\u8981\\u7684\\u7ED3\\u6784\\u5916\\uFF0C\\u5B9E\\u9645\\u4E0A\\u6211\\u4EEC\\u5C31\\u662F\\u7528\\u8FD9\\u4E09\\u884C\\u4EE3\\u7801\\u53BB\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u63CF\\u8FF0\\u4E86\"), \"\\u5982\\u4F55\\u5B9E\\u73B0\\u6211\\u4EEC\\u9700\\u8981\\u7684\\u76EE\\u6807\\u3002\\u8FD9\\u662F\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"C\\u8BED\\u8A00\"), \"\\uFF08\\u6216\\u8005\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Python\"), \"\\u3001\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Java\"), \"\\u3001\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"JS\"), \"\\u3001\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Golang\"), \"\\uFF09\\u63D0\\u4F9B\\u7ED9\\u6211\\u4EEC\\u7684\\u4E00\\u79CD\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u63CF\\u8FF0\\u7684\\u80FD\\u529B\"), \"\\u3002\\u4F46\\u662F\\u5230\\u76EE\\u524D\\u4E3A\\u6B62\\uFF0C\\u6211\\u4EEC\\u6240\\u7F16\\u5199\\u7684\\u8FD9\\u51E0\\u884C\\u4EE3\\u7801\\u8FD8\\u505C\\u7559\\u5728\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6587\\u672C\"), \"\\u8FD9\\u4E2A\\u9636\\u6BB5\\uFF0C\\u8FD9\\u662F\\u4E00\\u6BB5\\u4F60\\u80FD\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8BFB\\u61C2\"), \"\\u3001\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4FEE\\u6539\"), \"\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6587\\u672C\"), \"\\uFF0C\\u4F46\\u5B83\\u4EEC\\u5E76\\u4E0D\\u662F\\u8BA1\\u7B97\\u673A\\u80FD\\u591F\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8BC6\\u522B\\u5E76\\u6267\\u884C\"), \"\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6307\\u4EE4\"), \"\\u3002\"), mdx(\"h2\", null, \"4. \\u7F16\\u8BD1\\u6E90\\u4EE3\\u7801\"), mdx(\"p\", null, \"\\u8BA9\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6E90\\u4EE3\\u7801\"), \"\\u6210\\u4E3A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\u4E5F\\u5F88\\u7B80\\u5355\\uFF0C\\u5BF9\\u4E8EC\\u8BED\\u8A00\\u800C\\u8A00\\uFF0C\\u53EA\\u9700\\u8981\\u7528C\\u8BED\\u8A00\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7F16\\u8BD1\\u5668\"), \"\\u53BB\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7F16\\u8BD1\"), \"\\u6E90\\u4EE3\\u7801\\u5373\\u53EF\\u3002\"), mdx(\"h2\", null, \"4.1. \\u7F16\\u8BD1\\u5668\\u505A\\u4E86\\u4EC0\\u4E48\"), mdx(\"p\", null, \"\\u7B80\\u5355\\u5730\\u8BF4\\uFF0C\\u7F16\\u8BD1\\u5668\\u5C06\\u6211\\u4EEC\\u5199\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6E90\\u4EE3\\u7801\"), \"\\u7FFB\\u8BD1\\u6210\\u4E86\\u673A\\u5668\\u80FD\\u6267\\u884C\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4E8C\\u8FDB\\u5236\"), \"\\u3002\"), mdx(\"p\", null, \"\\u56E0\\u4E3A\\u8BA1\\u7B97\\u673A\\u662F\\u4E8C\\u8FDB\\u5236\\u7684\\uFF0C\\u5728\\u8BA1\\u7B97\\u673A\\u7684\\u5E95\\u5C42\\u4E16\\u754C\\u91CC\\u90FD\\u662F\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0\"), \"\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1\"), \"\\uFF0C\\u4F46\\u662F\\u6211\\u4EEC\\u76F4\\u63A5\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0\"), \"\\u548C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1\"), \"\\u53BB\\u7ED9\\u8BA1\\u7B97\\u673A\\u5199\\u7A0B\\u5E8F\\u3001\\u4E0B\\u6307\\u4EE4\\u592A\\u8FC7\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u53CD\\u4EBA\\u7C7B\"), \"\\uFF0C\\u4E3A\\u4E86\\u4FBF\\u4E8E\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6211\\u4EEC\\u4E0E\\u8BA1\\u7B97\\u673A\\u7684\\u5BF9\\u8BDD\"), \"\\uFF0C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7F16\\u7A0B\\u8BED\\u8A00\"), \"\\u5E94\\u8FD0\\u800C\\u751F\\u3002\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7F16\\u7A0B\\u8BED\\u8A00\"), \"\\u662F\\u66F4\\u63A5\\u8FD1\\u4EBA\\u80FD\\u8BFB\\u61C2\\u7684\\u8BED\\u8A00\\uFF08\\u5C3D\\u7BA1\\u5B83\\u4F9D\\u65E7\\u6709\\u4E0D\\u5C0F\\u7684\\u4E0A\\u624B\\u96BE\\u5EA6\\uFF0C\\u4F46\\u5DF2\\u7ECF\\u6BD4\\u66F4\\u5E95\\u5C42\\u7684\\u6307\\u4EE4\\u5DF2\\u7ECF\\u597D\\u592A\\u591A\\u4E86\\uFF09\\uFF0C\\u867D\\u7136\\u4EBA\\u80FD\\u66F4\\u65B9\\u4FBF\\u5730\\u4F7F\\u7528\\u7F16\\u7A0B\\u8BED\\u8A00\\u7F16\\u5199\\u7A0B\\u5E8F\\u4E86\\uFF0C\\u4F46\\u8BA1\\u7B97\\u673A\\u5F88\\u8822\\u53EA\\u61C2\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4E8C\\u8FDB\\u5236\"), \"\\uFF0C\\u4E3A\\u4E86\\u8BA9\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8BA1\\u7B97\\u673A\\u4E5F\\u80FD\\u7406\\u89E3\"), \"\\u6211\\u4EEC\\u6240\\u7F16\\u5199\\u7684\\u5185\\u5BB9\\uFF0C\\u5C31\\u9700\\u8981\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7F16\\u8BD1\\u5668\"), \"\\u6765\\u5145\\u5F53\\u8FD9\\u4E2D\\u95F4\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7FFB\\u8BD1\\u5B98\"), \"\\u3002\"), mdx(\"h2\", null, \"4.2. \\u7B80\\u5355\\u7684\\u7F16\\u8BD1\\u5C1D\\u8BD5\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u4EE5\\u4E0B\\u64CD\\u4F5C\\u5728\\u7C7BUnix\\u7CFB\\u7EDF\\u4E2D\\u8FDB\\u884C\\uFF0C\\u4E0D\\u540C\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u7684\\u7F16\\u8BD1\\u5DE5\\u5177\\u53EF\\u80FD\\u4F1A\\u4E0D\\u540C\\u3002\")), mdx(\"p\", null, \"\\u5C06\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"3\"), \"\\u4E2D\\u7684\\u6E90\\u4EE3\\u7801\\u4FDD\\u5B58\\u4E3A\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"main.c\"), \"\\uFF0C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6253\\u5F00\\u547D\\u4EE4\\u884C\\u8FDB\\u5165\\u5F53\\u524D\\u76EE\\u5F55\"), \"\\uFF0C\\u5229\\u7528\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gcc\"), \"\\u7F16\\u8BD1\\u5DE5\\u5177\\u53BB\\u7F16\\u8BD1\\u6E90\\u4EE3\\u7801\\uFF0C\\u6307\\u4EE4\\u5982\\u4E0B\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"cd $\\u6E90\\u4EE3\\u7801\\u6240\\u5728\\u6587\\u4EF6\\u5939\\ngcc main.c\\n\")), mdx(\"p\", null, \"\\u73B0\\u5728main.c\\u6240\\u5728\\u6587\\u4EF6\\u5939\\u5305\\u542B\\u5185\\u5BB9\\u5982\\u4E0B\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"main.c\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"a.out\")), mdx(\"p\", null, \"\\u901A\\u8FC7gcc\\u7F16\\u8BD1\\u540E\\u5F97\\u5230\\u4E86\\u4E00\\u4E2A\\u4E8C\\u8FDB\\u5236\\u53EF\\u6267\\u884C\\u6587\\u4EF6\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"a.out\"), \"\\u3002\\u6B64\\u65F6\\u5B83\\u88AB\\u4FDD\\u5B58\\u5728\\u786C\\u76D8\\u7684\\u4E2D\\uFF0C\\u5E76\\u4E14\\u8BA1\\u7B97\\u673A\\u4E5F\\u80FD\\u591F\\u6267\\u884C\\u5B83\\uFF0C\\u8FD9\\u65F6\\u5019\\u6211\\u4EEC\\u624D\\u7EC8\\u4E8E\\u901A\\u8FC7\\u6E90\\u4EE3\\u7801\\u83B7\\u5F97\\u4E86\\u4E00\\u4E2A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7A0B\\u5E8F\"), \"\\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"这是这个系列的第一篇文章，如果对后续感兴趣，可以不时检查 os 是否更新。 1. 什么是程序 计算机程序是 一组 指示电子计算机或其他具有消息处理能力设备每一步动作的 指令 。————《 维基百科：计算机程序 》…","frontmatter":{"date":"2020-12-21 13:24","title":"操作系统系列之——程序","draft":false}},{"id":"d85828e7-987e-5508-acfb-c45b45bc0599","slug":"posts/code/ubuntu-apt-install-go","rawBody":"---\ntitle: \"Ubuntu使用apt安装最新版golang\"\ndate: 2020-12-09T21:42:29+08:00\ncategories: [\"code\"]\ntags: [\"apt\", \"ubuntu\", \"golang\"]\ndraft: false\n---\n\n\n### 1. 获取最新的软件包源，并添加至当前的apt库\n\n```cmd\nadd-apt-repository ppa:longsleep/golang-backports\n```\n\n如果没有 `add-apt-repository`\n\n```bash\nsudo apt-get install software-properties-common\n```\n\n### 2. 更新apt库\n\n```cmd\napt-get update\n```\n\n### 3. 安装go\n\n```cmd\nsudo apt-get install golang-go\n```\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Ubuntu使用apt安装最新版golang\",\n  \"date\": \"2020-12-09T13:42:29.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"apt\", \"ubuntu\", \"golang\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"1. \\u83B7\\u53D6\\u6700\\u65B0\\u7684\\u8F6F\\u4EF6\\u5305\\u6E90\\uFF0C\\u5E76\\u6DFB\\u52A0\\u81F3\\u5F53\\u524D\\u7684apt\\u5E93\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"add-apt-repository ppa:longsleep/golang-backports\\n\")), mdx(\"p\", null, \"\\u5982\\u679C\\u6CA1\\u6709 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"add-apt-repository\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"sudo apt-get install software-properties-common\\n\")), mdx(\"h3\", null, \"2. \\u66F4\\u65B0apt\\u5E93\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"apt-get update\\n\")), mdx(\"h3\", null, \"3. \\u5B89\\u88C5go\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cmd\"\n  }, \"sudo apt-get install golang-go\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"1. 获取最新的软件包源，并添加至当前的apt库 如果没有  add-apt-repository 2. 更新apt库 3. 安装go","frontmatter":{"date":"2020-12-09 13:42","title":"Ubuntu使用apt安装最新版golang","draft":false}},{"id":"96feeada-ed77-5b39-bebf-75e3c7913f62","slug":"posts/code/vercel-draft","rawBody":"---\ntitle: \"解决Vercel部署Hugo时draft:true不生效，草稿也出现在博客中的问题。\"\ndate: 2020-12-18T09:56:26+08:00\ncategories: [\"code\"]\ntags: [\"vercel\", \"hugo\", \"draft\"]\ndraft: false\n---\n\n## 现象\n\n文章中设置了`draft: true`，本地`hugo server`不会看到该文章出现在本地调试的博客中，通过Vercel部署后文章出现在线上的站点中。\n\n## 原因\n\n> 有关Vercel对Hugo的处理，可以看看[这篇官方文章](https://vercel.com/guides/deploying-hugo-with-vercel)。\n\n打开Vercel项目的settings，可以看到`Build & Development Settings`下的hugo指令带有`-D`参数，这个参数会忽略draft这个标记，导致为编辑完的草稿也被编译、出现在博客中。\n\n## 解决\n\n|选项|值|\n|-|-|\n|BUILD COMMAND|hugo|\n\n开启`BUILD COMMAND`中的`OVERRIDE`按钮，手动修改编译命令，由于我的hugo没有其他额外的依赖，直接改成`hugo`，问题解决。\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"解决Vercel部署Hugo时draft:true不生效，草稿也出现在博客中的问题。\",\n  \"date\": \"2020-12-18T01:56:26.000Z\",\n  \"categories\": [\"code\"],\n  \"tags\": [\"vercel\", \"hugo\", \"draft\"],\n  \"draft\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"\\u73B0\\u8C61\"), mdx(\"p\", null, \"\\u6587\\u7AE0\\u4E2D\\u8BBE\\u7F6E\\u4E86\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"draft: true\"), \"\\uFF0C\\u672C\\u5730\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hugo server\"), \"\\u4E0D\\u4F1A\\u770B\\u5230\\u8BE5\\u6587\\u7AE0\\u51FA\\u73B0\\u5728\\u672C\\u5730\\u8C03\\u8BD5\\u7684\\u535A\\u5BA2\\u4E2D\\uFF0C\\u901A\\u8FC7Vercel\\u90E8\\u7F72\\u540E\\u6587\\u7AE0\\u51FA\\u73B0\\u5728\\u7EBF\\u4E0A\\u7684\\u7AD9\\u70B9\\u4E2D\\u3002\"), mdx(\"h2\", null, \"\\u539F\\u56E0\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u6709\\u5173Vercel\\u5BF9Hugo\\u7684\\u5904\\u7406\\uFF0C\\u53EF\\u4EE5\\u770B\\u770B\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://vercel.com/guides/deploying-hugo-with-vercel\"\n  }, \"\\u8FD9\\u7BC7\\u5B98\\u65B9\\u6587\\u7AE0\"), \"\\u3002\")), mdx(\"p\", null, \"\\u6253\\u5F00Vercel\\u9879\\u76EE\\u7684settings\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Build & Development Settings\"), \"\\u4E0B\\u7684hugo\\u6307\\u4EE4\\u5E26\\u6709\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-D\"), \"\\u53C2\\u6570\\uFF0C\\u8FD9\\u4E2A\\u53C2\\u6570\\u4F1A\\u5FFD\\u7565draft\\u8FD9\\u4E2A\\u6807\\u8BB0\\uFF0C\\u5BFC\\u81F4\\u4E3A\\u7F16\\u8F91\\u5B8C\\u7684\\u8349\\u7A3F\\u4E5F\\u88AB\\u7F16\\u8BD1\\u3001\\u51FA\\u73B0\\u5728\\u535A\\u5BA2\\u4E2D\\u3002\"), mdx(\"h2\", null, \"\\u89E3\\u51B3\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"\\u9009\\u9879\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"\\u503C\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"BUILD COMMAND\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"hugo\")))), mdx(\"p\", null, \"\\u5F00\\u542F\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"BUILD COMMAND\"), \"\\u4E2D\\u7684\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OVERRIDE\"), \"\\u6309\\u94AE\\uFF0C\\u624B\\u52A8\\u4FEE\\u6539\\u7F16\\u8BD1\\u547D\\u4EE4\\uFF0C\\u7531\\u4E8E\\u6211\\u7684hugo\\u6CA1\\u6709\\u5176\\u4ED6\\u989D\\u5916\\u7684\\u4F9D\\u8D56\\uFF0C\\u76F4\\u63A5\\u6539\\u6210\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hugo\"), \"\\uFF0C\\u95EE\\u9898\\u89E3\\u51B3\\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"现象 文章中设置了 draft: true ，本地 hugo server 不会看到该文章出现在本地调试的博客中，通过Vercel部署后文章出现在线上的站点中。 原因 有关Vercel对Hugo的处理，可以看看 这篇官方文章 。 打开Vercel项目的settings，可以看到 Build & Development…","frontmatter":{"date":"2020-12-18 01:56","title":"解决Vercel部署Hugo时draft:true不生效，草稿也出现在博客中的问题。","draft":false}},{"id":"e2f9d195-9a49-5ab8-961f-39260371985e","slug":"posts/code/vercel-stop","rawBody":"---\ntitle: \"有关vercel部署的项目在一段时间空闲后会自动关闭的问题\"\ndate: 2020-12-19T14:41:49+08:00\ndraft: false\ncategories: [\"code\"]\ntags: [\"serverless functions\",\"serverless\", \"vercel\", \"stateless\"]\n---\n\n## 现象\n\n通过vercel部署了Go的Serverless Functions，其中init函数中包含较长时间的初始化过程，每当一段时间不访问服务后的第一次访问总会很慢，猜测vercel是会将一段时间没人使用的服务关闭，等待该服务再次被请求时重新开启。\n\n## 验证\n\n如下的程序使用vercel部署后可以证明，当短时间连续请求多次时，接口返回的是\n\"11\"->\"111\"->\"1111\"，但一段时间没有请求时再请求，接口返回值会变回\"11\"。\n\n```go\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nvar count = \"1\"\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n    count += \"1\"\n    fmt.Fprintf(w, count)\n}\n```\n\n## 结论\n\n云函数对比传统开发模式而言多了一个\"装载\"的过程，即请求到达时，云函数先被装载到一个临时环境中，并在该环境中运行，为提高资源利用率，该云函数会继续占用该临时环境一段时间，以因对随后可能的连续请求（类似缓存原理），尽管此时云函数因为占有内存而在内部拥有保存运行状态的能力，但随着云函数空闲，云函数被移除该临时环境，对应的内存也会被清除回收，原先程序的运行数据将被不被保存，因此在编写云函数时应该保证该函数是无状态的，即每次请求之间应该不相互依赖，否则云函数将无法保证运行的结果能够符合预期。\n\n> 发现一篇有关这个问题的文章，写的很详尽，推荐：[万物皆可 Serverless 之关于云函数冷热启动那些事儿](https://blog.csdn.net/weixin_42409476/article/details/106789951)\n","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"有关vercel部署的项目在一段时间空闲后会自动关闭的问题\",\n  \"date\": \"2020-12-19T06:41:49.000Z\",\n  \"draft\": false,\n  \"categories\": [\"code\"],\n  \"tags\": [\"serverless functions\", \"serverless\", \"vercel\", \"stateless\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"\\u73B0\\u8C61\"), mdx(\"p\", null, \"\\u901A\\u8FC7vercel\\u90E8\\u7F72\\u4E86Go\\u7684Serverless Functions\\uFF0C\\u5176\\u4E2Dinit\\u51FD\\u6570\\u4E2D\\u5305\\u542B\\u8F83\\u957F\\u65F6\\u95F4\\u7684\\u521D\\u59CB\\u5316\\u8FC7\\u7A0B\\uFF0C\\u6BCF\\u5F53\\u4E00\\u6BB5\\u65F6\\u95F4\\u4E0D\\u8BBF\\u95EE\\u670D\\u52A1\\u540E\\u7684\\u7B2C\\u4E00\\u6B21\\u8BBF\\u95EE\\u603B\\u4F1A\\u5F88\\u6162\\uFF0C\\u731C\\u6D4Bvercel\\u662F\\u4F1A\\u5C06\\u4E00\\u6BB5\\u65F6\\u95F4\\u6CA1\\u4EBA\\u4F7F\\u7528\\u7684\\u670D\\u52A1\\u5173\\u95ED\\uFF0C\\u7B49\\u5F85\\u8BE5\\u670D\\u52A1\\u518D\\u6B21\\u88AB\\u8BF7\\u6C42\\u65F6\\u91CD\\u65B0\\u5F00\\u542F\\u3002\"), mdx(\"h2\", null, \"\\u9A8C\\u8BC1\"), mdx(\"p\", null, \"\\u5982\\u4E0B\\u7684\\u7A0B\\u5E8F\\u4F7F\\u7528vercel\\u90E8\\u7F72\\u540E\\u53EF\\u4EE5\\u8BC1\\u660E\\uFF0C\\u5F53\\u77ED\\u65F6\\u95F4\\u8FDE\\u7EED\\u8BF7\\u6C42\\u591A\\u6B21\\u65F6\\uFF0C\\u63A5\\u53E3\\u8FD4\\u56DE\\u7684\\u662F\\n\\\"11\\\"->\\\"111\\\"->\\\"1111\\\"\\uFF0C\\u4F46\\u4E00\\u6BB5\\u65F6\\u95F4\\u6CA1\\u6709\\u8BF7\\u6C42\\u65F6\\u518D\\u8BF7\\u6C42\\uFF0C\\u63A5\\u53E3\\u8FD4\\u56DE\\u503C\\u4F1A\\u53D8\\u56DE\\\"11\\\"\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-go\"\n  }, \"import (\\n    \\\"fmt\\\"\\n    \\\"net/http\\\"\\n)\\n\\nvar count = \\\"1\\\"\\n\\nfunc Handler(w http.ResponseWriter, r *http.Request) {\\n    count += \\\"1\\\"\\n    fmt.Fprintf(w, count)\\n}\\n\")), mdx(\"h2\", null, \"\\u7ED3\\u8BBA\"), mdx(\"p\", null, \"\\u4E91\\u51FD\\u6570\\u5BF9\\u6BD4\\u4F20\\u7EDF\\u5F00\\u53D1\\u6A21\\u5F0F\\u800C\\u8A00\\u591A\\u4E86\\u4E00\\u4E2A\\\"\\u88C5\\u8F7D\\\"\\u7684\\u8FC7\\u7A0B\\uFF0C\\u5373\\u8BF7\\u6C42\\u5230\\u8FBE\\u65F6\\uFF0C\\u4E91\\u51FD\\u6570\\u5148\\u88AB\\u88C5\\u8F7D\\u5230\\u4E00\\u4E2A\\u4E34\\u65F6\\u73AF\\u5883\\u4E2D\\uFF0C\\u5E76\\u5728\\u8BE5\\u73AF\\u5883\\u4E2D\\u8FD0\\u884C\\uFF0C\\u4E3A\\u63D0\\u9AD8\\u8D44\\u6E90\\u5229\\u7528\\u7387\\uFF0C\\u8BE5\\u4E91\\u51FD\\u6570\\u4F1A\\u7EE7\\u7EED\\u5360\\u7528\\u8BE5\\u4E34\\u65F6\\u73AF\\u5883\\u4E00\\u6BB5\\u65F6\\u95F4\\uFF0C\\u4EE5\\u56E0\\u5BF9\\u968F\\u540E\\u53EF\\u80FD\\u7684\\u8FDE\\u7EED\\u8BF7\\u6C42\\uFF08\\u7C7B\\u4F3C\\u7F13\\u5B58\\u539F\\u7406\\uFF09\\uFF0C\\u5C3D\\u7BA1\\u6B64\\u65F6\\u4E91\\u51FD\\u6570\\u56E0\\u4E3A\\u5360\\u6709\\u5185\\u5B58\\u800C\\u5728\\u5185\\u90E8\\u62E5\\u6709\\u4FDD\\u5B58\\u8FD0\\u884C\\u72B6\\u6001\\u7684\\u80FD\\u529B\\uFF0C\\u4F46\\u968F\\u7740\\u4E91\\u51FD\\u6570\\u7A7A\\u95F2\\uFF0C\\u4E91\\u51FD\\u6570\\u88AB\\u79FB\\u9664\\u8BE5\\u4E34\\u65F6\\u73AF\\u5883\\uFF0C\\u5BF9\\u5E94\\u7684\\u5185\\u5B58\\u4E5F\\u4F1A\\u88AB\\u6E05\\u9664\\u56DE\\u6536\\uFF0C\\u539F\\u5148\\u7A0B\\u5E8F\\u7684\\u8FD0\\u884C\\u6570\\u636E\\u5C06\\u88AB\\u4E0D\\u88AB\\u4FDD\\u5B58\\uFF0C\\u56E0\\u6B64\\u5728\\u7F16\\u5199\\u4E91\\u51FD\\u6570\\u65F6\\u5E94\\u8BE5\\u4FDD\\u8BC1\\u8BE5\\u51FD\\u6570\\u662F\\u65E0\\u72B6\\u6001\\u7684\\uFF0C\\u5373\\u6BCF\\u6B21\\u8BF7\\u6C42\\u4E4B\\u95F4\\u5E94\\u8BE5\\u4E0D\\u76F8\\u4E92\\u4F9D\\u8D56\\uFF0C\\u5426\\u5219\\u4E91\\u51FD\\u6570\\u5C06\\u65E0\\u6CD5\\u4FDD\\u8BC1\\u8FD0\\u884C\\u7684\\u7ED3\\u679C\\u80FD\\u591F\\u7B26\\u5408\\u9884\\u671F\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u53D1\\u73B0\\u4E00\\u7BC7\\u6709\\u5173\\u8FD9\\u4E2A\\u95EE\\u9898\\u7684\\u6587\\u7AE0\\uFF0C\\u5199\\u7684\\u5F88\\u8BE6\\u5C3D\\uFF0C\\u63A8\\u8350\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.csdn.net/weixin_42409476/article/details/106789951\"\n  }, \"\\u4E07\\u7269\\u7686\\u53EF Serverless \\u4E4B\\u5173\\u4E8E\\u4E91\\u51FD\\u6570\\u51B7\\u70ED\\u542F\\u52A8\\u90A3\\u4E9B\\u4E8B\\u513F\"))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"现象 通过vercel部署了Go的Serverless Functions，其中init函数中包含较长时间的初始化过程，每当一段时间不访问服务后的第一次访问总会很慢，猜测vercel是会将一段时间没人使用的服务关闭，等待该服务再次被请求时重新开启。 验证 如下的程序使用vercel…","frontmatter":{"date":"2020-12-19 06:41","title":"有关vercel部署的项目在一段时间空闲后会自动关闭的问题","draft":false}}]},"site":{"siteMetadata":{"siteUrl":"https://www.yourdomain.tld","title":"JabinGP Blog","description":"All about my life."}}},"pageContext":{"currIds":["60dd195e-7b1a-5fb2-86fc-c60f5713725f","b2849cbf-27a5-5685-9ec9-caa499db3f9c","5db09af9-31b3-528d-abb7-0d5121227a8e","cd46902a-5078-5427-b229-10859f111d55","fbc389e2-6d70-5eea-b189-712d81c37081","461be4c7-adf5-5849-8802-ad756a01d00e","6f1807d0-d72b-512c-b014-f090f7f9d672","d85828e7-987e-5508-acfb-c45b45bc0599","96feeada-ed77-5b39-bebf-75e3c7913f62","e2f9d195-9a49-5ab8-961f-39260371985e"]}},
    "staticQueryHashes": []}